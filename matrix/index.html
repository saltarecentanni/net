<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="app-version" content="4.1.007">
    <title>Tiesse Matrix Network - Tiesse S.P.A.</title>
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='15' fill='%231e40af'/><circle cx='25' cy='25' r='8' fill='%2360a5fa'/><circle cx='75' cy='25' r='8' fill='%2360a5fa'/><circle cx='25' cy='75' r='8' fill='%2360a5fa'/><circle cx='75' cy='75' r='8' fill='%2360a5fa'/><circle cx='50' cy='50' r='10' fill='%23fbbf24'/><line x1='25' y1='25' x2='50' y2='50' stroke='%2393c5fd' stroke-width='3'/><line x1='75' y1='25' x2='50' y2='50' stroke='%2393c5fd' stroke-width='3'/><line x1='25' y1='75' x2='50' y2='50' stroke='%2393c5fd' stroke-width='3'/><line x1='75' y1='75' x2='50' y2='50' stroke='%2393c5fd' stroke-width='3'/></svg>">
    <!-- Local libraries for offline/intranet use (NO EXTERNAL CDN) -->
    <script src="assets/vendor/tailwind.min.js"></script>
    <script src="assets/vendor/xlsx.full.min.js"></script>
    <script src="assets/vendor/sweetalert2.min.js"></script>
    <script src="assets/vendor/chart.min.js"></script>
    <!-- Custom CSS with cache-busting -->
    <link rel="stylesheet" href="css/styles.css?v=4.1.007">
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">
    <div id="syncIndicator" class="sync-indicator" style="display:none;"></div>
    
    <div class="w-full px-4 py-4">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-4 mb-4" role="banner">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-4">
                    <!-- Logo Tiesse - Clic√°vel para refresh/home -->
                    <a href="index.html" title="Torna alla pagina principale" class="hover:opacity-80 transition-opacity">
                        <img src="assets/logoTiesse.png" alt="Tiesse S.P.A. Logo" class="h-8 w-auto cursor-pointer">
                    </a>
                    <div>
                        <div class="flex items-baseline gap-2">
                            <h1 class="text-2xl font-bold text-slate-800">Matrix Network</h1>
                            <span class="text-xs text-slate-400 font-medium">by Tiesse S.P.A.</span>
                        </div>
                        <p class="text-slate-600 text-sm">Gestione visuale di dispositivi di rete, porte e connessioni</p>
                    </div>
                </div>
                <div class="flex items-center gap-3" role="navigation" aria-label="User actions">
                    <!-- Auth Controls -->
                    <span id="userInfo" class="text-sm font-semibold text-green-600" style="display:none;" role="status" aria-live="polite"></span>
                    <button id="loginBtn" onclick="Auth.showLoginModal()" class="view-mode-only bg-blue-500 hover:bg-blue-600 text-white font-semibold py-1.5 px-4 rounded-lg text-sm" aria-label="Enter edit mode">
                        üîì Edit Mode
                    </button>
                    <button id="logoutBtn" onclick="Auth.logout()" class="edit-mode-only bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1.5 px-3 rounded-lg text-sm" style="display:none;" aria-label="Logout and exit edit mode">
                        üîí Logout
                    </button>
                    <button onclick="switchTab('logs')" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-1.5 px-3 rounded-lg text-sm" title="Activity Logs" aria-label="View activity logs">
                        üìã
                    </button>
                    <button onclick="openIconPicker()" class="bg-amber-100 hover:bg-amber-200 text-amber-800 font-semibold py-1.5 px-3 rounded-lg text-sm" title="Icon Picker" aria-label="Open icon picker">
                        üé®
                    </button>
                    <div id="onlineUsersIndicator" class="relative flex items-center justify-center bg-emerald-100 text-emerald-700 font-bold py-1.5 px-2.5 rounded-lg text-sm min-w-[36px] cursor-default" title="Utenti online" role="status" aria-live="polite" aria-label="Online users count">
                        <span id="onlineUsersCount">--</span>
                    </div>
                    <div class="text-right text-xs text-slate-500">
                        <div class="font-semibold text-slate-700">Tiesse S.P.A.</div>
                        <div class="text-slate-600">Versione: <span id="appVersion" class="font-semibold">v4.1.007</span></div>
                    </div>
                </div>
            </div>
        </div>

        <script>
            (function(){
                var meta = document.querySelector('meta[name="app-version"]');
                var ver = meta ? meta.getAttribute('content') : '';
                var el = document.getElementById('appVersion');
                if (el) el.textContent = ver ? ('v' + ver) : '';
            })();
        </script>

        <!-- Actions Bar -->
        <div class="bg-white rounded-xl shadow-lg p-4 mb-4">
            <div class="flex flex-wrap gap-2 items-center justify-between">
                <div class="flex items-center gap-4">
                    <h2 class="text-lg font-bold text-slate-800">Actions</h2>
                    <!-- Global Location Filter -->
                    <div class="flex items-center gap-2 bg-slate-100 border border-slate-300 rounded-lg px-2 py-1">
                        <select id="locationFilter" onchange="filterByLocation();" class="px-2 py-1 text-sm border-0 bg-transparent font-semibold text-slate-800 cursor-pointer focus:outline-none" aria-label="Filter by location">
                            <option value="">üåê All Locations</option>
                        </select>
                        <span id="totalLocationsCount" class="bg-slate-600 text-white text-xs font-bold px-2 py-0.5 rounded-full">0</span>
                    </div>
                    <!-- Stats Counters -->
                    <div class="flex items-center gap-2">
                        <button onclick="switchTab('devices')" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-1.5 px-3 rounded-lg text-sm shadow-sm transition-all">
                            üì± <span id="totalDevicesCount">0</span> Dispositivi
                        </button>
                        <button onclick="switchTab('active')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-1.5 px-3 rounded-lg text-sm shadow-sm transition-all">
                            ‚ö° <span id="totalConnectionsCount">0</span> Connections
                        </button>
                    </div>
                </div>
                <div class="flex flex-wrap gap-2">
                    <!-- Edit Mode Only -->
                    <button onclick="saveNow()" class="edit-mode-only bg-green-600 hover:bg-green-700 text-white font-semibold py-1.5 px-3 rounded-lg text-sm" style="display:none;">
                        üíæ Save Now
                    </button>
                    <!-- Last Update Badge -->
                    <button class="bg-red-600 hover:bg-red-700 text-white font-bold py-1.5 px-3 rounded-lg text-sm shadow-sm transition-all" 
                            title="Data dell'ultimo salvataggio del sistema">
                        üìÖ <span id="lastUpdateDate">00/00/0000</span>
                    </button>
                    <!-- Public -->
                    <button onclick="exportExcel()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1.5 px-3 rounded-lg text-sm">
                        üìä Esporta Excel
                    </button>
                    <button onclick="exportJSON()" class="bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1.5 px-3 rounded-lg text-sm">
                        üíæ Esporta JSON
                    </button>
                    <!-- Edit Mode Only -->
                    <input type="file" id="importFile" accept=".json" onchange="importData(event)" class="hidden">
                    <button onclick="document.getElementById('importFile').click()" class="edit-mode-only bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1.5 px-3 rounded-lg text-sm" style="display:none;">
                        üì• Importa JSON
                    </button>
                    <button onclick="clearAll()" class="edit-mode-only bg-red-500 hover:bg-red-600 text-white font-semibold py-1.5 px-3 rounded-lg text-sm" style="display:none;">
                        Cancella Tutto
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs Navigation -->
        <div class="bg-white rounded-t-xl shadow-lg">
            <div class="flex border-b overflow-x-auto">
                <button class="tab-btn active" onclick="switchTab('dashboard')" id="tab-dashboard" title="Dashboard con statistiche e ricerca intelligente">
                    ü™ß Dashboard
                </button>
                <button class="tab-btn" onclick="switchTab('devices')" id="tab-devices" title="Aggiungi, modifica o rimuovi dispositivi di rete Tiesse.">
                    üì± Dispositivi
                </button>
                <button class="tab-btn" onclick="switchTab('active')" id="tab-active" title="Crea e gestisci le connessioni tra dispositivi.">
                    ‚ö° Connessioni
                </button>
                <button class="tab-btn" onclick="switchTab('drawio')" id="tab-drawio" title="Visualizza graficamente la topologia della rete.">
                    üó∫Ô∏è Topology
                </button>
                <button class="tab-btn" onclick="switchTab('matrix')" id="tab-matrix" title="Matrici visiva di tutte le connessioni.">
                    üìä Matrix
                </button>
                <button class="tab-btn" onclick="switchTab('floorplan')" id="tab-floorplan" title="Mappa fisica della posizione degli equipaggiamenti.">
                    üè¢ Floor Plan
                </button>
                <button class="tab-btn" onclick="switchTab('help')" id="tab-help">
                    ‚ùì Help
                </button>
            </div>
        </div>

        <!-- Tab Contents -->
        <div class="bg-white rounded-b-xl shadow-lg p-4 mb-4">
            
            <!-- Tab 0: Dashboard -->
            <div id="content-dashboard" class="tab-content active">
                <!-- Title -->
                <div class="mb-3">
                    <h2 class="text-lg font-bold text-slate-800">ü™ß Dashboard</h2>
                    <p class="text-xs text-slate-500 italic">Panoramica generale della rete e ricerca intelligente.</p>
                </div>
                <!-- Stats Cards (clickable links) -->
                <div class="grid grid-cols-3 gap-3 mb-3">
                    <a href="javascript:switchTab('devices')" class="bg-gradient-to-br from-slate-600 to-slate-700 text-white rounded-lg p-3 shadow hover:shadow-md hover:scale-[1.02] transition-all block" style="cursor: pointer;">
                        <div class="flex items-center justify-between">
                            <div class="text-slate-200 text-xs">üì± Dispositivi Totali</div>
                            <div class="text-2xl font-bold" id="statTotalDevices">0</div>
                        </div>
                    </a>
                    <a href="javascript:switchTab('active')" class="bg-gradient-to-br from-rose-500 to-rose-600 text-white rounded-lg p-3 shadow hover:shadow-md hover:scale-[1.02] transition-all block" style="cursor: pointer;">
                        <div class="flex items-center justify-between">
                            <div class="text-rose-100 text-xs">‚ö° Connessioni</div>
                            <div class="text-2xl font-bold" id="statTotalConnections">0</div>
                        </div>
                    </a>
                    <a href="javascript:switchTab('floorplan')" class="bg-gradient-to-br from-amber-500 to-orange-500 text-white rounded-lg p-3 shadow hover:shadow-md hover:scale-[1.02] transition-all block" style="cursor: pointer;">
                        <div class="flex items-center justify-between">
                            <div class="text-amber-100 text-xs">üè¢ Posizioni</div>
                            <div class="text-2xl font-bold" id="statTotalRooms">0</div>
                        </div>
                    </a>
                </div>
                
                <!-- Search Section -->
                <div class="relative mb-3">
                    <div class="relative">
                        <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-500 text-lg">üîé</span>
                        <input type="text" id="dashboardSearch" 
                            placeholder="Search devices and connections: name, IP, MAC, port, type, location, group..."
                            class="w-full pl-12 pr-10 py-3 border-2 border-slate-300 rounded-xl text-sm focus:border-blue-500 focus:ring-2 focus:ring-blue-200 shadow-sm hover:shadow-md bg-white transition-all"
                            autocomplete="off">
                        <button onclick="Dashboard.clearSearch()" class="absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-red-500 text-lg font-bold" title="Clear">‚úï</button>
                    </div>
                    <!-- Search Results (overlay on charts) -->
                    <div id="searchResults" class="hidden absolute left-0 right-0 top-full mt-1 bg-white border-2 border-blue-400 rounded-xl shadow-2xl max-h-96 overflow-y-auto" style="z-index: 9999;">
                        <div class="text-slate-400 py-3 text-xs text-center">Type at least 2 characters...</div>
                    </div>
                </div>
                
                <!-- Charts Section -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white border border-slate-200 rounded-xl p-4 shadow-lg hover:shadow-xl transition-shadow">
                        <canvas id="chartByType" height="280"></canvas>
                    </div>
                    <div class="bg-white border border-slate-200 rounded-xl p-4 shadow-lg hover:shadow-xl transition-shadow">
                        <canvas id="chartByStatus" height="280"></canvas>
                    </div>
                    <div class="bg-white border border-slate-200 rounded-xl p-4 shadow-lg hover:shadow-xl transition-shadow">
                        <canvas id="chartByRoom" height="280"></canvas>
                    </div>
                </div>
                
                <!-- Footer -->
                <div class="mt-auto pt-3 border-t border-slate-200 text-center">
                    <p class="text-slate-600 text-xs">
                        <span class="font-semibold">Tiesse Matrix Network</span> ¬© 2026 Tiesse S.P.A. ‚Äî All rights reserved ‚Äî <span class="text-red-500 font-medium">‚ö†Ô∏è Confidential ‚Äî For internal use only</span>
                    </p>
                </div>
            </div>
            
            <!-- Tab 1: Devices -->
            <div id="content-devices" class="tab-content">
                <!-- Add Device Form -->
                <div class="edit-mode-only bg-slate-50 rounded-lg p-3 mb-4" style="display:none;">
                    <h2 class="text-lg font-bold text-slate-800 mb-3" id="deviceFormTitle">+ Add Device</h2>
                    <input type="hidden" id="deviceEditId" value="">
                    <!-- Hidden field for backward compatibility: stores the group code as rackId -->
                    <input type="hidden" id="rackId" value="">

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROW 1: GERARCHIA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2 items-end">
                        <!-- Location -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" for="deviceLocation" title="Posizione fisica del dispositivo">üìç Location <span class="text-red-500 text-sm font-bold">*</span></label>
                            <div class="flex gap-1">
                                <select id="deviceLocation" class="flex-1 px-2 py-1.5 border-2 border-slate-400 rounded-lg text-xs bg-slate-50 font-semibold text-slate-800" onchange="onDeviceLocationChange()">
                                    <option value="">üìç Select...</option>
                                </select>
                                <button type="button" onclick="openLocationManager()" title="Location Manager" 
                                    class="px-1.5 py-1 bg-purple-100 hover:bg-purple-200 text-purple-700 rounded-lg text-[10px] font-bold">+ ‚öôÔ∏è</button>
                            </div>
                        </div>
                        <!-- Group -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" for="deviceGroup" title="Gruppo logico o rack fisico">üóÇÔ∏è Group <span class="text-red-500 text-sm font-bold">*</span></label>
                            <div class="flex gap-1">
                                <select id="deviceGroup" class="flex-1 px-2 py-1.5 border-2 border-blue-400 rounded-lg text-xs font-semibold">
                                    <option value="">Select Group...</option>
                                </select>
                                <button type="button" onclick="openGroupManager()" title="Group Manager"
                                    class="px-1.5 py-1 bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg text-[10px] font-bold">+ ‚öôÔ∏è</button>
                            </div>
                        </div>
                        <!-- Type -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" for="deviceType" title="Tipo di dispositivo e sigla identificativa">üè∑Ô∏è Type <span class="text-red-500 text-sm font-bold">*</span></label>
                            <div class="flex gap-1">
                                <select id="deviceType" class="flex-1 px-2 py-1.5 border border-slate-300 rounded-lg text-xs font-semibold" onchange="onDeviceTypeChange()">
                                    <option value="router">üì° Router - RT</option>
                                    <option value="switch">üîÄ Switch - SW</option>
                                    <option value="patch">üìå Patch Panel - PP</option>
                                    <option value="walljack">üîå Wall Jack RJ45 - WJ</option>
                                    <option value="walljack_tel">üîå Wall Jack RJ11 - WJ-TEL</option>
                                    <option value="firewall">üß± Firewall - FW</option>
                                    <option value="server">üñ•Ô∏è Server - SRV</option>
                                    <option value="wifi">üì∂ Access Point - AP</option>
                                    <option value="isp">üåê ISP/Provider - ISP</option>
                                    <option value="router_wifi">üì∂ Router WiFi - RW</option>
                                    <option value="modem">üì† Modem - MDM</option>
                                    <option value="hub">üîò Hub - HUB</option>
                                    <option value="poe">‚ö° PoE Injector - POE</option>
                                    <option value="pc">üíª PC/Desktop - PC</option>
                                    <option value="tablet">üì± Tablet - TAB</option>
                                    <option value="ip_phone">‚òéÔ∏è IP Phone - PH</option>
                                    <option value="printer">üñ®Ô∏è Printer - PRN</option>
                                    <option value="nas">üß∞ NAS - NAS</option>
                                    <option value="camera">üìπ IP Camera - CAM</option>
                                    <option value="dvr">üìº DVR/NVR - DVR</option>
                                    <option value="ups">üîã UPS - UPS</option>
                                    <option value="iot">üå°Ô∏è IoT Device - IOT</option>
                                    <option value="tst">üß™ Test Bench - TST</option>
                                    <option value="tv">üì∫ TV/Display - TV</option>
                                    <option value="others">üì¶ Generic - GEN</option>
                                </select>
                                <button type="button" onclick="openTypeManager()" title="Type Manager"
                                    class="px-1.5 py-1 bg-indigo-100 hover:bg-indigo-200 text-indigo-700 rounded-lg text-[10px] font-bold">+ ‚öôÔ∏è</button>
                            </div>
                            <!-- Hidden prefix field - auto-derived from type -->
                            <input type="hidden" id="devicePrefix" value="">
                        </div>
                        <!-- Order / Rack Position / ID# -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block text-center" title="Ordine nel gruppo/rack (00=non assegnato)">üî¢ Order / Rack Position / ID#</label>
                            <div class="flex gap-1 items-center justify-center">
                                <input type="text" id="deviceOrder" placeholder="00" value="00" maxlength="2"
                                    class="w-12 px-1 py-1.5 border-2 border-blue-400 rounded-lg text-center text-xs font-mono font-bold"
                                    onchange="formatDeviceOrder()" oninput="formatDeviceOrder()"
                                    title="Ordine nel gruppo/rack&#10;00 = non assegnato&#10;01-48 = frontale&#10;99-51 = retro">
                                <div class="flex flex-col">
                                    <button type="button" onclick="adjustDeviceOrder(1)" class="px-1.5 text-[10px] bg-slate-200 hover:bg-slate-300 rounded-t border border-slate-300 leading-tight h-3.5">‚ñ≤</button>
                                    <button type="button" onclick="adjustDeviceOrder(-1)" class="px-1.5 text-[10px] bg-slate-200 hover:bg-slate-300 rounded-b border border-t-0 border-slate-300 leading-tight h-3.5">‚ñº</button>
                                </div>
                                <label class="flex items-center gap-0.5 px-2 py-1.5 bg-amber-50 border border-amber-300 rounded-lg cursor-pointer hover:bg-amber-100" title="Dispositivo sul retro del rack">
                                    <input type="checkbox" id="deviceRear" class="w-3 h-3 rounded border-amber-400 text-amber-600" onchange="toggleRearOrder()">
                                    <span class="text-xs font-bold text-amber-700">R</span><span class="text-[10px] text-amber-600">‚Ü©</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROW 2: IDENTIT√Ä ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <div class="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-8 gap-2 mt-2 items-end">
                        <!-- Hostname -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" for="deviceName" title="Nome identificativo del dispositivo nella rete">üìü Hostname <span class="text-red-500 text-sm font-bold">*</span></label>
                            <div class="flex items-center gap-1">
                                <span id="hostnamePrefixBadge" class="px-2 py-1.5 text-xs font-mono font-bold text-white bg-purple-600 rounded-lg min-w-12 text-center" style="display:none;"></span>
                                <input type="text" id="deviceName" placeholder="Custom name only" 
                                    maxlength="120" required
                                    class="flex-1 px-2 py-1.5 border-2 border-blue-400 rounded-lg text-xs font-mono font-semibold">
                            </div>
                        </div>
                        <!-- Brand / Model -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" for="deviceBrandModel" title="Marca e modello dell'apparecchio">üîß Brand / Model</label>
                            <input type="text" id="deviceBrandModel" placeholder="HPE Aruba 2930F" 
                                maxlength="100"
                                class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                        </div>
                        <!-- Service -->
                        <div class="col-span-2">
                            <label class="text-xs text-slate-600 mb-1 block" title="Servizio o funzione principale del dispositivo">‚öôÔ∏è Service</label>
                            <input type="text" id="deviceService" placeholder="DHCP, DNS, Gateway" 
                                class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                        </div>
                        <!-- Status + Monitoring -->
                        <div class="col-span-2 flex gap-2 items-end">
                            <div class="flex-1">
                                <label class="text-xs text-slate-600 mb-1 block" title="Stato operativo del dispositivo">‚ö° Status</label>
                                <select id="deviceStatus" class="w-full px-1 py-1.5 border border-slate-300 rounded-lg text-xs">
                                    <option value="active">üü¢ Active</option>
                                    <option value="disabled">üî¥ Disabled</option>
                                </select>
                            </div>
                            <div class="flex-1">
                                <label class="text-xs text-slate-600 mb-1 block" title="Monitoraggio attivo del dispositivo">ü©∫ Monitoring</label>
                                <div class="flex gap-1 items-center">
                                    <label class="flex items-center gap-0.5 px-2 py-1.5 bg-sky-50 border border-sky-300 rounded-lg cursor-pointer hover:bg-sky-100" title="Abilita monitoraggio">
                                        <input type="checkbox" id="deviceMonitoringEnabled" class="w-3 h-3 rounded border-sky-400 text-sky-600">
                                        <span class="text-[10px] font-bold text-sky-700">ON</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROW 3: RETE + PORTE + LINK ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-2 mt-2">
                        <!-- Network -->
                        <div class="border border-green-200 rounded-lg p-2 bg-green-50">
                            <div class="flex items-center justify-between mb-1">
                                <div class="flex items-center gap-2">
                                    <h3 class="text-xs font-bold text-green-700" title="Configurazione di rete del dispositivo">üåê Network</h3>
                                    <span class="text-xs text-green-600 italic">Add IP, GW & Mask or enable DHCP</span>
                                </div>
                                <div class="flex items-center gap-2">
                                    <label class="flex items-center gap-1 cursor-pointer" title="Indirizzo IP assegnato via DHCP">
                                        <input type="checkbox" id="deviceDhcp" class="w-3 h-3 rounded border-green-400 text-green-600" onchange="toggleDhcpFields()">
                                        <span class="text-[10px] font-bold text-green-700">DHCP</span>
                                    </label>
                                    <button onclick="addIPField()" type="button"
                                        class="text-[10px] font-semibold text-green-600 hover:text-green-800 bg-green-100 hover:bg-green-200 px-1.5 py-0.5 rounded" title="Aggiungi indirizzo IP">+ IP</button>
                                </div>
                            </div>
                            <div id="deviceIPContainer" class="space-y-1 max-h-24 overflow-y-auto">
                                <div class="flex gap-1 items-center ip-row">
                                    <input type="text" class="ip-field flex-1 px-2 py-1 border border-green-300 rounded text-xs font-mono bg-white" placeholder="192.168.1.1">
                                    <button type="button" onclick="removeIPField(this)" class="text-red-500 hover:text-red-700 font-bold px-1 text-xs">‚úï</button>
                                </div>
                            </div>
                            <div class="flex gap-2 mt-1.5 pt-1.5 border-t border-green-200">
                                <div class="flex-1">
                                    <label class="text-[10px] text-green-600 mb-0.5 block" title="Indirizzo gateway predefinito">Gateway</label>
                                    <input type="text" id="deviceGateway" placeholder="10.10.254.1" 
                                        class="w-full px-2 py-1 border border-green-300 rounded text-xs font-mono bg-white">
                                </div>
                                <div class="flex-1">
                                    <label class="text-[10px] text-green-600 mb-0.5 block" title="Maschera di sottorete">Subnet Mask</label>
                                    <input type="text" id="deviceMask" placeholder="/24 or 255.255.255.0" 
                                        class="w-full px-2 py-1 border border-green-300 rounded text-xs font-mono bg-white">
                                </div>
                            </div>
                        </div>
                        <!-- Ports -->
                        <div class="border border-blue-200 rounded-lg p-2 bg-blue-50">
                            <div class="flex items-center justify-between mb-1">
                                <div class="flex items-center gap-2">
                                    <h3 class="text-xs font-bold text-blue-700" title="Porte fisiche del dispositivo">üîå Ports</h3>
                                    <span class="text-xs text-blue-600 italic">Add various port types of your device</span>
                                </div>
                                <button onclick="addPortTypeField()" type="button"
                                    class="text-[10px] font-semibold text-blue-600 hover:text-blue-800 bg-blue-100 hover:bg-blue-200 px-1.5 py-0.5 rounded" title="Aggiungi tipo di porta">+ Type</button>
                            </div>
                            <div id="portTypeQuantityContainer" class="space-y-1 max-h-24 overflow-y-auto"></div>
                        </div>
                        <!-- Links -->
                        <div class="border border-purple-200 rounded-lg p-2 bg-purple-50">
                            <div class="flex items-center justify-between mb-1">
                                <div class="flex items-center gap-2">
                                    <h3 class="text-xs font-bold text-purple-700" title="Link di accesso remoto (SSH, HTTP, RDP, ecc.)">üîó Links</h3>
                                    <span class="text-xs text-purple-600 italic">Add links for SSH access or services</span>
                                </div>
                                <button onclick="addLinkField()" type="button"
                                    class="text-[10px] font-semibold text-purple-600 hover:text-purple-800 bg-purple-100 hover:bg-purple-200 px-1.5 py-0.5 rounded" title="Aggiungi link di accesso">+ Link</button>
                            </div>
                            <div id="deviceLinksContainer" class="space-y-1 max-h-24 overflow-y-auto"></div>
                        </div>
                    </div>

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROW 4: NOTES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <div class="mt-2">
                        <label class="text-xs text-slate-600 mb-1 block" title="Annotazioni libere sul dispositivo">üìù Notes</label>
                        <input type="text" id="deviceNotes" placeholder="Optional notes..."
                            maxlength="500"
                            class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                    </div>

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ROW 5: EXTENDED INFO (collapsible) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <details class="mt-2 border border-slate-200 rounded-lg">
                        <summary class="text-xs font-semibold text-slate-500 cursor-pointer px-3 py-1.5 bg-slate-100 rounded-lg hover:bg-slate-200 select-none" title="Informazioni estese del dispositivo">
                            ‚ÑπÔ∏è Extended Info ‚Äî MAC, Serial Number, Asset Tag
                        </summary>
                        <div class="grid grid-cols-1 sm:grid-cols-3 gap-2 p-2">
                            <div>
                                <label class="text-xs text-slate-600 mb-1 block" for="deviceMacAddress" title="Indirizzo fisico della scheda di rete">üîó MAC Address</label>
                                <input type="text" id="deviceMacAddress" placeholder="AA:BB:CC:DD:EE:FF" maxlength="17"
                                    class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs font-mono uppercase"
                                    pattern="[0-9A-Fa-f:.\-]{12,17}">
                            </div>
                            <div>
                                <label class="text-xs text-slate-600 mb-1 block" for="deviceSerialNumber" title="Numero di serie del dispositivo">üîñ Serial Number</label>
                                <input type="text" id="deviceSerialNumber" placeholder="FOC1234X5YZ" maxlength="60"
                                    class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs font-mono">
                            </div>
                            <div>
                                <label class="text-xs text-slate-600 mb-1 block" for="deviceAssetTag" title="Etichetta di inventario aziendale">üìã Asset Tag</label>
                                <input type="text" id="deviceAssetTag" placeholder="IT-2026-0042" maxlength="40"
                                    class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs font-mono">
                            </div>
                        </div>
                    </details>

                    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BUTTONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                    <div class="flex gap-2 mt-3 justify-end">
                        <button onclick="saveDevice()" 
                            class="bg-green-500 hover:bg-green-600 text-white font-semibold py-1.5 px-5 rounded-lg text-xs" id="saveDeviceButton">
                            + Add
                        </button>
                        <button onclick="cancelDeviceEdit()" id="cancelDeviceButton"
                            class="hidden bg-orange-400 hover:bg-orange-500 text-white font-semibold py-1.5 px-3 rounded-lg text-xs">
                            Cancel
                        </button>
                        <button onclick="clearDeviceForm()" 
                            class="bg-slate-400 hover:bg-slate-500 text-white font-semibold py-1.5 px-3 rounded-lg text-xs">
                            Clear
                        </button>
                    </div>
                </div>

                <!-- Devices List -->
                <div>
                    <!-- Title -->
                    <div class="mb-3">
                        <h2 class="text-lg font-bold text-slate-800">üì± Device List</h2>
                        <p class="text-xs text-slate-500 italic">Add, edit or remove Tiesse network devices.</p>
                    </div>
                    
                    <!-- View Controls (one line with view buttons on left, toggle expand/collapse, print on right) -->
                    <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                        <!-- Left: View Mode Buttons + Toggle Expand/Collapse -->
                        <div class="flex items-center gap-2">
                            <button onclick="setDeviceView('cards')" id="deviceViewCards" class="px-2 py-1 text-xs font-semibold rounded bg-slate-200 text-slate-700 hover:bg-slate-300">üí≥ Cards</button>
                            <button onclick="setDeviceView('table')" id="deviceViewTable" class="px-2 py-1 text-xs font-semibold rounded bg-blue-500 text-white">üìâ Table</button>
                            <button onclick="setDeviceView('grouped')" id="deviceViewGrouped" class="px-2 py-1 text-xs font-semibold rounded bg-slate-200 text-slate-700 hover:bg-slate-300">üßä Grouped</button>
                            
                            <!-- Toggle Expand/Collapse (only in Grouped mode) -->
                            <button id="deviceExpandToggle" onclick="toggleAllDeviceGroups()" class="px-2 py-1 text-xs font-semibold rounded bg-slate-200 text-slate-700 hover:bg-slate-300" style="display:none;" title="Toggle expand/collapse all groups">‚ñº</button>
                        </div>
                        
                        <!-- Right: Print button -->
                        <button onclick="printDevices()" class="px-2 py-1 text-xs font-semibold rounded bg-slate-500 text-white hover:bg-slate-600">üñ®Ô∏è Print</button>
                    </div>
                    <!-- Filter Bar for Devices -->
                    <div id="deviceFilterBar">
                        <!-- Filters will be populated by JS -->
                    </div>
                    <div class="overflow-x-auto" id="devicesListContainer">
                        <div class="text-center text-slate-500 py-8">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Active Connections (with connection form) -->
            <div id="content-active" class="tab-content">
                <!-- Connection Form -->
                <div class="edit-mode-only bg-slate-50 rounded-lg p-3 mb-4" style="display:none;">
                    <h2 class="text-lg font-bold text-slate-800 mb-3" id="connectionFormTitle">+ Add Connection</h2>
                    <input type="hidden" id="connEditIndex" value="">
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-3 mb-3">
                        <!-- SOURCE Section -->
                        <div class="bg-orange-100 border border-orange-300 rounded-lg p-2">
                            <p class="text-xs font-bold text-orange-700 mb-2">üì§ SORGENTE</p>
                            <div class="grid grid-cols-4 gap-2">
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üìç Posizione</label>
                                    <select id="fromLocation" onchange="updateFromGroups()" 
                                        class="w-full px-2 py-1.5 border-2 border-slate-400 rounded-lg text-xs bg-slate-50 font-semibold text-slate-800">
                                        <option value="">üìç Tutte</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üóÇÔ∏è Group</label>
                                    <select id="fromGroup" onchange="updateFromDevices()" 
                                        class="w-full px-2 py-1.5 border border-orange-300 rounded-lg text-xs bg-white">
                                        <option value="">All</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üìü Device *</label>
                                    <select id="fromDevice" onchange="updateFromPorts()" 
                                        class="w-full px-2 py-1.5 border-2 border-orange-400 rounded-lg text-xs bg-white font-medium">
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üîå Port *</label>
                                    <select id="fromPort" class="w-full px-2 py-1.5 border-2 border-orange-400 rounded-lg text-xs bg-white font-medium">
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <!-- DESTINATION Section -->
                        <div class="bg-amber-50 border border-amber-300 rounded-lg p-2">
                            <p class="text-xs font-bold text-amber-700 mb-2">üì• DESTINATION</p>
                            <div class="grid grid-cols-4 gap-2">
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üìç Location</label>
                                    <select id="toLocation" onchange="updateToGroups()" 
                                        class="w-full px-2 py-1.5 border-2 border-slate-400 rounded-lg text-xs bg-slate-50 font-semibold text-slate-800">
                                        <option value="">üìç All</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üóÇÔ∏è Group</label>
                                    <select id="toGroup" onchange="updateToDevices()" 
                                        class="w-full px-2 py-1.5 border border-amber-300 rounded-lg text-xs bg-white">
                                        <option value="">All</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="text-xs text-slate-600 mb-1 block">üìü Device *</label>
                                    <select id="toDevice" onchange="updateToPorts()" 
                                        class="w-full px-2 py-1.5 border-2 border-amber-400 rounded-lg text-xs bg-white font-medium">
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                                <div id="toPortContainer">
                                    <label class="text-xs text-slate-600 mb-1 block">üîå Port *</label>
                                    <select id="toPort" class="w-full px-2 py-1.5 border-2 border-amber-400 rounded-lg text-xs bg-white font-medium">
                                        <option value="">Select...</option>
                                    </select>
                                </div>
                            </div>
                            <!-- Wall Jack / External fields (hidden by default) -->
                            <div id="externalDestContainer" class="hidden mt-2">
                                <div class="grid grid-cols-3 gap-2">
                                    <div>
                                        <label id="externalDestLabel" class="text-xs text-slate-600 mb-1 block">üîå Wall Jack ID</label>
                                        <input type="text" id="externalDest" placeholder="Z1, Z2, Z3..."
                                            class="w-full px-2 py-1.5 border-2 border-amber-400 rounded-lg text-xs bg-white font-medium">
                                    </div>
                                    <div id="wallJackTypeContainer" class="hidden">
                                        <label class="text-xs text-slate-600 mb-1 block">üîå Tipo Presa</label>
                                        <select id="wallJackType" class="w-full px-2 py-1.5 border border-amber-300 rounded-lg text-xs bg-white">
                                            <option value="rj45">RJ45 (Rete/LAN)</option>
                                            <option value="rj11">RJ11 (Telefono)</option>
                                        </select>
                                    </div>
                                    <div id="wallJackRoomContainer" class="hidden">
                                        <label class="text-xs text-slate-600 mb-1 block">üìç Stanza</label>
                                        <select id="wallJackRoomId" class="w-full px-2 py-1.5 border border-amber-300 rounded-lg text-xs bg-white">
                                            <option value="">üìç Select Location</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Connection Details + Notes + Buttons -->
                    <div class="flex flex-wrap gap-2 items-end">
                        <div class="w-32">
                            <label class="text-xs text-slate-600 mb-1 block">üè∑Ô∏è Type/Zone</label>
                            <select id="connType" class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                                <option value="lan">‚ÜîÔ∏è LAN</option>
                                <option value="wan">üåê WAN/Internet</option>
                                <option value="dmz">üõ°Ô∏è DMZ</option>
                                <option value="vlan">üî∑ VLAN</option>
                                <option value="trunk">‚¨ÜÔ∏è Trunk/Uplink</option>
                                <option value="vpn">üîí VPN</option>
                                <option value="cloud">‚òÅÔ∏è Cloud</option>
                                <option value="management">‚öôÔ∏è Management</option>
                                <option value="servers">üñ•Ô∏è Servers</option>
                                <option value="iot">üì° IoT</option>
                                <option value="guest">üë• Guest</option>
                                <option value="voice">üìû Voice/VoIP</option>
                                <option value="backup">üíæ Backup</option>
                                <option value="fiber">üí° Fiber</option>
                                <option value="test">üß™ Test/Lab</option>
                                <option value="wallport">üîå Wall Jack</option>
                                <option value="external">üì° External/ISP</option>
                                <option value="other">üì¶ Other</option>
                            </select>
                        </div>
                        <div class="w-24">
                            <label class="text-xs text-slate-600 mb-1 block">‚ö° Status</label>
                            <select id="connStatus" class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                                <option value="active">Active</option>
                                <option value="disabled">Disabled</option>
                            </select>
                        </div>
                        <div class="w-20">
                            <label class="text-xs text-slate-600 mb-1 block">üîñ Cable ID</label>
                            <input type="text" id="cableMarker" maxlength="5" placeholder="1, A"
                                class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs text-center">
                        </div>
                        <div class="w-32">
                            <label class="text-xs text-slate-600 mb-1 block">üé® Color</label>
                            <div class="flex gap-1">
                                <select id="cableColor" onchange="syncCableColorInput()" class="flex-1 px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                                    <option value="">None</option>
                                    <option value="#000000" style="background:#000000;color:#fff;">Black</option>
                                    <option value="#ffffff" style="background:#ffffff;color:#000;border:1px solid #ccc;">White</option>
                                    <option value="#ef4444" style="background:#ef4444;color:#fff;">Red</option>
                                    <option value="#f97316" style="background:#f97316;color:#fff;">Orange</option>
                                    <option value="#eab308" style="background:#eab308;color:#000;">Yellow</option>
                                    <option value="#8b4513" style="background:#8b4513;color:#fff;">Brown</option>
                                    <option value="#22c55e" style="background:#22c55e;color:#fff;">Green</option>
                                    <option value="#3b82f6" style="background:#3b82f6;color:#fff;">Blue</option>
                                    <option value="#a855f7" style="background:#a855f7;color:#fff;">Purple</option>
                                    <option value="#ec4899" style="background:#ec4899;color:#fff;">Pink</option>
                                    <option value="#6b7280" style="background:#6b7280;color:#fff;">Gray</option>
                                    <option value="custom">Custom...</option>
                                </select>
                                <input type="color" id="cableColorPicker" onchange="syncCableColorFromPicker()" 
                                    class="w-8 h-8 p-0 border border-slate-300 rounded cursor-pointer" title="Custom color">
                            </div>
                        </div>
                        <div class="flex-1 min-w-[200px]">
                            <label class="text-xs text-slate-600 mb-1 block">üìù Notes</label>
                            <input type="text" id="connNotes" placeholder="Notes (optional)"
                                maxlength="500"
                                class="w-full px-2 py-1.5 border border-slate-300 rounded-lg text-xs">
                        </div>
                        <div class="flex gap-2">
                            <button onclick="saveConnection()" 
                                class="bg-green-500 hover:bg-green-600 text-white font-semibold py-1.5 px-5 rounded-lg text-xs whitespace-nowrap" id="saveConnectionButton">
                                + Add
                            </button>
                            <button onclick="cancelConnectionEdit()" id="cancelConnectionButton"
                                class="hidden bg-orange-400 hover:bg-orange-500 text-white font-semibold py-1.5 px-3 rounded-lg text-xs">
                                Cancel
                            </button>
                            <button onclick="clearConnectionForm()" 
                                class="bg-slate-400 hover:bg-slate-500 text-white font-semibold py-1.5 px-3 rounded-lg text-xs">
                                Clear
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Connections List -->
                <div id="connectionsPrintArea">
                    <!-- Title -->
                    <div class="mb-3">
                        <h2 class="text-lg font-bold text-slate-800">‚ö° Connections</h2>
                        <p class="text-xs text-slate-500 italic">Create and manage connections between devices</p>
                    </div>
                    
                    <!-- View Controls (one line with view buttons on left, toggle expand/collapse, print on right) -->
                    <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                        <!-- Left: View Mode Buttons + Toggle Expand/Collapse -->
                        <div class="flex items-center gap-2">
                            <button onclick="setConnectionsViewMode('table')" id="btn-view-table" class="px-2 py-1 text-xs font-semibold rounded bg-blue-500 text-white">üìâ Table</button>
                            <button onclick="setConnectionsViewMode('grouped')" id="btn-view-grouped" class="px-2 py-1 text-xs font-semibold rounded bg-slate-200 text-slate-700 hover:bg-slate-300">üßä Grouped</button>
                            
                            <!-- Toggle Expand/Collapse (only in Grouped mode) -->
                            <button id="connExpandToggle" onclick="toggleAllConnGroups()" class="px-2 py-1 text-xs font-semibold rounded bg-slate-200 text-slate-700 hover:bg-slate-300" style="display:none;" title="Toggle expand/collapse all groups">‚ñº</button>
                        </div>
                        
                        <!-- Right: Print button -->
                        <button onclick="printConnections()" class="px-2 py-1 text-xs font-semibold rounded bg-slate-500 text-white hover:bg-slate-600">üñ®Ô∏è Print</button>
                    </div>
                    
                    <!-- Filter Bar for Connections -->
                    <div id="connFilterBar">
                        <!-- Filters will be populated by JS -->
                    </div>
                    <div class="overflow-x-auto" id="connectionsListContainer">
                        <div class="text-center text-slate-500 py-8">Loading...</div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Matrix (Refactored - Topology Style) -->
            <div id="content-matrix" class="tab-content">
                <div id="matrixPrintArea">
                    <!-- Title -->
                    <div class="mb-3">
                        <h2 class="text-lg font-bold text-slate-800">üìä Matrice Connessioni</h2>
                        <p class="text-xs text-slate-500 italic">Matrici visiva di tutte le connessioni.</p>
                    </div>
                    <!-- Controls -->
                    <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                        <!-- Left: Stats + Filters -->
                        <div class="flex items-center gap-2 flex-wrap">
                            <div id="matrixStats">
                                <!-- Stats populated by JS -->
                            </div>
                            <!-- Filters -->
                            <select id="matrixLocationFilter" onchange="filterMatrixByLocation()" class="px-2 py-1 border-2 border-slate-400 rounded-lg text-xs bg-slate-50 font-semibold text-slate-800">
                                <option value="">üìç All Locations</option>
                            </select>
                            <select id="matrixGroupFilter" onchange="filterMatrixByGroup()" class="px-2 py-1 border border-slate-300 rounded-lg text-xs">
                                <option value="">üóÇÔ∏è All Groups</option>
                            </select>
                            <label class="flex items-center gap-1.5 cursor-pointer bg-green-50 border border-green-300 rounded-lg px-2 py-1" title="Hide devices without connections">
                                <input type="checkbox" id="matrixOnlyConnected" onchange="toggleMatrixOnlyConnected()" checked class="w-3.5 h-3.5 accent-green-600">
                                <span class="text-xs text-green-700 font-medium">Connected</span>
                            </label>
                            
                            <!-- Zoom Controls -->
                            <div class="flex items-center gap-1 border-l border-slate-300 pl-2">
                                <button onclick="zoomMatrix(-1)" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-1 px-2 rounded-lg text-xs" title="Zoom Out">‚àí</button>
                                <span id="matrixZoomLevel" class="text-xs text-slate-600 font-mono w-10 text-center">100%</span>
                                <button onclick="zoomMatrix(1)" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-1 px-2 rounded-lg text-xs" title="Zoom In">+</button>
                                <button onclick="fitMatrixView()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Fit to View">üìä Fit</button>
                            </div>
                            
                            <!-- Actions -->
                            <div class="flex items-center gap-1 border-l border-slate-300 pl-2">
                                <button onclick="exportMatrixPNG()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Export as PNG">üì∑ PNG</button>
                                <button onclick="printMatrix()" class="bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Print">üñ®Ô∏è Print</button>
                            </div>
                        </div>
                    </div>

                    <!-- Matrix Container - SVG based with native zoom/pan -->
                    <div class="overflow-hidden rounded-xl border border-slate-200 bg-gradient-to-br from-slate-50 to-slate-100 shadow-sm" 
                         id="matrixContainer" 
                         style="height: 600px; width: 100%; position: relative; cursor: grab;">
                        <div class="text-center text-slate-500 py-8">Loading...</div>
                    </div>

                    <!-- Tip - Compact version -->
                    <p class="mt-2 text-xs text-blue-600 no-print">üí° Scroll to zoom ‚Ä¢ Drag to pan ‚Ä¢ Click cell to edit ‚Ä¢ Headers stay fixed</p>

                    <!-- Tooltip container for hover details -->
                    <div id="matrixTooltip" class="fixed hidden z-50 bg-slate-800 text-white text-sm rounded-xl shadow-2xl p-4 pointer-events-none" style="min-width:420px;max-width:500px;">
                        <!-- Tooltip content populated by JS -->
                    </div>
                </div>
            </div>

            <!-- Tab 4: Floor Plan -->
            <div id="content-floorplan" class="tab-content">
                <!-- Title -->
                <div class="mb-3">
                    <h2 class="text-lg font-bold text-slate-800">üè¢ Floor Plan</h2>
                    <p class="text-xs text-slate-500 italic">Mappa fisica della posizione degli equipaggiamenti.</p>
                </div>
                <!-- Controls -->
                <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                    <!-- Left: Stats + Zoom -->
                    <div class="flex items-center gap-2 flex-wrap">
                        <div id="floorplanStats" class="flex items-center gap-2 text-xs">
                            <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-lg font-semibold text-xs">
                                üìç <span id="totalRoomsCount">0</span> Rooms
                            </span>
                        </div>
                        <!-- Zoom Controls -->
                        <div class="flex items-center gap-1">
                            <button onclick="FloorPlan.zoom(-0.2)" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-1 px-2 rounded-lg text-xs">‚àí</button>
                            <span id="floorplanZoomLevel" class="text-xs text-slate-600 font-mono w-10 text-center">100%</span>
                            <button onclick="FloorPlan.zoom(0.2)" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-1 px-2 rounded-lg text-xs">+</button>
                            <button onclick="FloorPlan.resetZoom()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1 px-2 rounded-lg text-xs">Reset</button>
                        </div>
                        
                        <!-- Room Management (Edit Mode Only) -->
                        <div class="edit-mode-only flex items-center gap-1 border-l border-slate-300 pl-2" style="display:none;">
                            <button onclick="FloorPlan.showAddRoomModal()" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-1 px-2 rounded-lg text-xs">+ Room</button>
                            <button onclick="FloorPlan.toggleEditMode()" class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" id="floorplanEditBtn">‚úèÔ∏è Edit</button>
                        </div>
                    </div>
                </div>

                <!-- Floor Plan Container Wrapper -->
                <div style="position: relative;">
                    <!-- Floor Plan Container -->
                    <div id="floorplanContainer" class="border border-slate-200 rounded-xl" style="height: 600px; width: 100%; overflow: hidden; position: relative; cursor: grab; background: #F8FAFC;">
                        <div class="flex items-center justify-center h-full text-slate-400">
                            <p>Loading floor plan...</p>
                        </div>
                    </div>
                    <!-- Floating Custom Locations Legend (Left Side) -->
                    <div id="customLocationsLegend" style="position: absolute; top: 12px; left: 12px; max-height: calc(100% - 24px); overflow-y: auto; background: rgba(255,255,255,0.92); backdrop-filter: blur(4px); border-radius: 10px; padding: 10px 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 100; min-width: 140px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; border-bottom: 1px solid #e2e8f0; padding-bottom: 6px;">
                            <span style="font-size: 11px; font-weight: 700; color: #059669;">ü™ß Custom Locations</span>
                            <button onclick="toggleCustomLocationsLegend()" id="customLocationsToggle" style="font-size: 9px; color: #059669; background: none; border: none; cursor: pointer; opacity: 0.7;">‚ñº</button>
                        </div>
                        <div id="customLocationsContent" style="display: flex; flex-direction: column; gap: 3px;"></div>
                    </div>
                    <!-- Floating Room Legend (Right Side) -->
                    <div id="roomLegend" style="position: absolute; top: 12px; right: 12px; max-height: calc(100% - 24px); overflow-y: auto; background: rgba(255,255,255,0.92); backdrop-filter: blur(4px); border-radius: 10px; padding: 10px 14px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 100; min-width: 140px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; border-bottom: 1px solid #e2e8f0; padding-bottom: 6px;">
                            <span style="font-size: 11px; font-weight: 700; color: #7c3aed;">üìç Mapped Rooms</span>
                            <button onclick="toggleRoomLegend()" id="roomLegendToggle" style="font-size: 9px; color: #7c3aed; background: none; border: none; cursor: pointer; opacity: 0.7;">‚ñº</button>
                        </div>
                        <div id="roomLegendContent" style="display: flex; flex-direction: column; gap: 3px;"></div>
                    </div>
                </div>

                <!-- Room Info Panel (Hidden by default) -->
                <div id="roomInfoPanel" class="mt-4 bg-white border border-slate-300 rounded-lg p-4" style="display:none;">
                    <div class="flex items-start justify-between mb-3">
                        <div>
                            <h3 class="text-lg font-bold text-slate-800" id="roomInfoName">Room Name</h3>
                            <p class="text-sm text-slate-600" id="roomInfoType">Type</p>
                        </div>
                        <button onclick="FloorPlan.closeRoomPanel()" class="text-slate-400 hover:text-slate-600">‚úï</button>
                    </div>
                    <div id="roomInfoContent" class="text-sm text-slate-700">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Tips -->
                <p class="mt-2 text-xs text-blue-600 no-print">üí° Click on rooms to view details ‚Ä¢ Drag to pan ‚Ä¢ Scroll to zoom ‚Ä¢ Edit Mode: manage rooms and place devices</p>
            </div>

            <!-- Tab 5: Help - Documentazione Completa -->
            <div id="content-help" class="tab-content">
                <div class="max-w-6xl mx-auto">
                    
                    <!-- Title -->
                    <div class="mb-3">
                        <h2 class="text-lg font-bold text-slate-800">üìö Guida Utente Completa</h2>
                        <p class="text-xs text-slate-500 italic">Documentazione completa per utenti e amministratori di sistema</p>
                    </div>
                    <!-- ========== HEADER ========== -->
                    <div class="text-center mb-6">
                        <p class="text-slate-600 font-semibold">TIESSE Matrix Network Manager v4.1.007</p>
                        <div class="flex justify-center gap-2 mt-3">
                            <span class="bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full">Guida Operativa</span>
                            <span class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full">Manuale Tecnico</span>
                            <span class="bg-purple-100 text-purple-800 text-xs px-3 py-1 rounded-full">Installazione</span>
                        </div>
                    </div>

                    <!-- ========== INDICE NAVIGABILE ========== -->
                    <div class="bg-gradient-to-r from-slate-800 to-slate-700 text-white rounded-xl p-5 mb-6 shadow-lg" id="help-index">
                        <h2 class="text-lg font-bold mb-4 flex items-center gap-2">üìë Indice della Guida</h2>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-3 text-sm">
                            <a href="#help-intro" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-blue-300">0.</span> Introduzione e Concetti Base
                            </a>
                            <a href="#help-interface" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-sky-300">1.</span> üñ•Ô∏è Interfaccia Utente
                            </a>
                            <a href="#help-auth" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-green-300">2.</span> üîê Autenticazione e Permessi
                            </a>
                            <a href="#help-devices" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-purple-300">3.</span> üì± Scheda Devices
                            </a>
                            <a href="#help-connections" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-orange-300">4.</span> ‚ö° Scheda Connections
                            </a>
                            <a href="#help-topology" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-cyan-300">5.</span> üó∫Ô∏è Scheda Topology
                            </a>
                            <a href="#help-matrix" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-pink-300">6.</span> üìä Scheda Matrix
                            </a>
                            <a href="#help-floorplan" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-emerald-300">7.</span> üè¢ Scheda Floor Plan
                            </a>
                            <a href="#help-logs" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-amber-300">8.</span> üìã Scheda Logs
                            </a>
                            <a href="#help-export" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-red-300">9.</span> üíæ Import/Export e Backup
                            </a>
                            <a href="#help-locations" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-violet-300">10.</span> üìç Location Manager
                            </a>
                            <a href="#help-print" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-rose-300">11.</span> üñ®Ô∏è Stampa e Esportazione PNG
                            </a>
                            <a href="#help-workflow" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-yellow-300">12.</span> üîÑ Flusso di Lavoro
                            </a>
                            <a href="#help-glossary" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-indigo-300">13.</span> üìñ Glossario Termini
                            </a>
                            <a href="#help-faq" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-teal-300">14.</span> ‚ùì FAQ
                            </a>
                            <a href="#help-install" class="block bg-gradient-to-r from-orange-500/30 to-red-500/30 hover:from-orange-500/50 hover:to-red-500/50 rounded-lg p-3 transition-colors border border-orange-400/50">
                                <span class="font-bold text-orange-300">15.</span> üõ†Ô∏è Installazione del Sistema
                            </a>
                            <a href="#help-config" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-slate-300">16.</span> ‚öôÔ∏è Configurazione Sistema
                            </a>
                            <a href="#help-security" class="block bg-gradient-to-r from-red-500/30 to-red-600/30 hover:from-red-500/50 hover:to-red-600/50 rounded-lg p-3 transition-colors border border-red-400/50">
                                <span class="font-bold text-red-300">17.</span> üîí Sicurezza
                            </a>
                            <a href="#help-maintenance" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-amber-300">18.</span> üî® Manutenzione
                            </a>
                            <a href="#help-techref" class="block bg-white/10 hover:bg-white/20 rounded-lg p-3 transition-colors">
                                <span class="font-bold text-gray-300">19.</span> üìö Riferimento Tecnico
                            </a>
                            <a href="#help-guacamole" class="block bg-gradient-to-r from-green-500/30 to-emerald-500/30 hover:from-green-500/50 hover:to-emerald-500/50 rounded-lg p-3 transition-colors border border-green-400/50">
                                <span class="font-bold text-green-300">20.</span> üñ•Ô∏è Guacamole (Accesso Remoto)
                            </a>
                        </div>
                    </div>

                    <!-- ========== 0. INTRODUZIONE ========== -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 rounded-r-xl p-5 mb-6" id="help-intro">
                        <h2 class="text-xl font-bold text-blue-800 mb-3 flex items-center gap-2">
                            <span class="bg-blue-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">0</span>
                            Introduzione e Concetti Base
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-blue-200">
                                <h3 class="font-bold text-blue-900 mb-2">üéØ Cos'√® TIESSE Matrix Network?</h3>
                                <p class="text-blue-800 text-sm mb-3">TIESSE Matrix Network √® un'applicazione web progettata per <strong>documentare e visualizzare</strong> l'infrastruttura di rete aziendale. √à pensata per tecnici di rete, amministratori di sistema e personale IT che hanno bisogno di mantenere una documentazione aggiornata della rete.</p>
                                
                                <div class="bg-blue-50 rounded-lg p-3 mb-3">
                                    <p class="font-semibold text-blue-900 text-sm mb-2">üìå Cosa puoi fare con Matrix Network:</p>
                                    <ul class="text-blue-700 text-sm ml-4 list-disc space-y-1">
                                        <li><strong>Catalogare dispositivi:</strong> Router, switch, server, access point, PC, stampanti, telecamere IP, UPS e qualsiasi apparecchiatura di rete</li>
                                        <li><strong>Documentare connessioni:</strong> Registrare ogni cavo che collega un dispositivo a un altro, con porta di origine e destinazione</li>
                                        <li><strong>Visualizzare la topologia:</strong> Vedere un diagramma grafico interattivo di tutta la rete</li>
                                        <li><strong>Organizzare per sede:</strong> Raggruppare dispositivi per Location (sede/edificio) e Group (rack/stanza)</li>
                                        <li><strong>Mappare planimetrie:</strong> Associare dispositivi a stanze fisiche nel Floor Plan</li>
                                        <li><strong>Esportare documentazione:</strong> Generare report Excel, backup JSON, immagini PNG e file per Draw.io</li>
                                        <li><strong>Stampare inventari:</strong> Stampare elenchi di dispositivi e connessioni filtrati per sede</li>
                                    </ul>
                                </div>

                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-3">
                                    <p class="text-amber-800 text-sm">‚ö†Ô∏è <strong>Importante:</strong> Matrix Network √® un sistema di <u>documentazione</u>, non di monitoraggio. Non rileva automaticamente i dispositivi n√© verifica se sono online. I dati vengono inseriti e aggiornati manualmente dagli operatori.</p>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-blue-200">
                                <h3 class="font-bold text-blue-900 mb-2">üèóÔ∏è Struttura Gerarchica dei Dati</h3>
                                <p class="text-blue-800 text-sm mb-3">I dati sono organizzati in una gerarchia logica che riflette l'organizzazione fisica della rete:</p>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-sm text-green-400 mb-3">
<pre>üìç <span class="text-yellow-300">LOCATION</span> (Sede/Edificio/Reparto)
 ‚îÇ   Esempio: "Sede Centrale", "Filiale Torino", "Magazzino"
 ‚îÇ
 ‚îî‚îÄ‚îÄ üóÇÔ∏è <span class="text-cyan-300">GROUP</span> (Rack/Stanza/Armadio/Zona)
      ‚îÇ   Esempio: "Rack-01", "Sala Server", "Ufficio Direzione"
      ‚îÇ
      ‚îî‚îÄ‚îÄ üì± <span class="text-pink-300">DEVICE</span> (Dispositivo di rete)
           ‚îÇ   Esempio: "SW-Core-01", "Router-Gateway", "Server-DC"
           ‚îÇ
           ‚îú‚îÄ‚îÄ üîå <span class="text-orange-300">PORTS</span> (Porte fisiche del dispositivo)
           ‚îÇ   Esempio: 24 porte Ethernet + 4 porte SFP
           ‚îÇ
           ‚îî‚îÄ‚îÄ ‚ö° <span class="text-blue-300">CONNECTIONS</span> (Cavi collegati)
               Esempio: SW-Core-01 Porta 24 ‚ü∑ SW-Piano2 Porta 1

<span class="text-slate-400">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</span>

üè¢ <span class="text-emerald-300">FLOOR PLAN</span> (Planimetria dell'edificio)
 ‚îÇ
 ‚îî‚îÄ‚îÄ üö™ <span class="text-violet-300">ROOM</span> (Stanza fisica)
      ‚îÇ   Ha: ID, Nickname, Poligono, Colore
      ‚îÇ
      ‚îî‚îÄ‚îÄ üì± <span class="text-pink-300">DEVICES</span> (Dispositivi associati)
          (collegati tramite Location = Nickname)</pre>
                                </div>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-yellow-50 p-3 rounded-lg border border-yellow-200">
                                        <span class="font-bold text-yellow-900">üìç Location</span>
                                        <p class="text-yellow-800 mt-1">Rappresenta una sede fisica, un edificio o un reparto. √à il livello pi√π alto di organizzazione. Tutti i dispositivi devono appartenere a una Location.</p>
                                    </div>
                                    <div class="bg-cyan-50 p-3 rounded-lg border border-cyan-200">
                                        <span class="font-bold text-cyan-900">üóÇÔ∏è Group</span>
                                        <p class="text-cyan-800 mt-1">Rappresenta un raggruppamento all'interno della Location: rack, armadio, stanza, area. Permette di organizzare dispositivi vicini fisicamente.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-blue-200">
                                <h3 class="font-bold text-blue-900 mb-2">üîÑ Come Funziona il Sistema</h3>
                                <div class="grid md:grid-cols-3 gap-3 text-xs">
                                    <div class="bg-slate-50 p-3 rounded-lg text-center">
                                        <div class="text-3xl mb-2">üìù</div>
                                        <span class="font-bold text-slate-800">1. Inserimento</span>
                                        <p class="text-slate-600 mt-1">Aggiungi dispositivi con tutte le informazioni: nome, tipo, IP, porte disponibili</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-center">
                                        <div class="text-3xl mb-2">üîó</div>
                                        <span class="font-bold text-slate-800">2. Collegamento</span>
                                        <p class="text-slate-600 mt-1">Crea connessioni specificando: da quale dispositivo/porta a quale dispositivo/porta</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg text-center">
                                        <div class="text-3xl mb-2">üëÅÔ∏è</div>
                                        <span class="font-bold text-slate-800">3. Visualizzazione</span>
                                        <p class="text-slate-600 mt-1">Consulta topologia, matrice, planimetria. Esporta e stampa documentazione</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-blue-200">
                                <h3 class="font-bold text-blue-900 mb-2">üíæ Salvataggio dei Dati</h3>
                                <div class="grid md:grid-cols-2 gap-3">
                                    <div class="bg-green-50 p-3 rounded-lg border-l-4 border-green-500">
                                        <span class="font-bold text-green-800">‚úÖ Dove vengono salvati?</span>
                                        <p class="text-green-700 text-xs mt-1">I dati sono salvati in un file JSON sul server (<code class="bg-green-200 px-1 rounded">data/network_manager.json</code>). Quando clicchi "Save Now", il browser invia i dati al server che li scrive nel file.</p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border-l-4 border-red-500">
                                        <span class="font-bold text-red-800">‚ö†Ô∏è Attenzione!</span>
                                        <p class="text-red-700 text-xs mt-1">Le modifiche NON vengono salvate automaticamente! Devi sempre cliccare <span class="bg-green-600 text-white px-2 py-0.5 rounded text-xs">üíæ Save Now</span> dopo ogni sessione di modifiche.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-blue-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 1. INTERFACCIA UTENTE ========== -->
                    <div class="bg-sky-50 border-l-4 border-sky-500 rounded-r-xl p-5 mb-6" id="help-interface">
                        <h2 class="text-xl font-bold text-sky-800 mb-3 flex items-center gap-2">
                            <span class="bg-sky-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">1</span>
                            üñ•Ô∏è Interfaccia Utente
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-sky-200">
                                <h3 class="font-bold text-sky-900 mb-3">üñºÔ∏è Layout della Pagina</h3>
                                <p class="text-sky-800 text-sm mb-3">L'interfaccia √® divisa in aree funzionali ben definite:</p>
                                
                                <div class="bg-slate-100 rounded-lg p-4 mb-3">
                                    <div class="border-2 border-slate-400 rounded-lg overflow-hidden">
                                        <!-- Header -->
                                        <div class="bg-white p-2 border-b-2 border-slate-400">
                                            <div class="flex justify-between items-center text-xs">
                                                <div class="flex items-center gap-2">
                                                    <span class="bg-blue-600 text-white px-2 py-1 rounded">LOGO</span>
                                                    <span class="font-bold">Matrix Network</span>
                                                </div>
                                                <div class="flex gap-2">
                                                    <span class="bg-blue-500 text-white px-2 py-0.5 rounded text-xs">üîì Edit Mode</span>
                                                    <span class="bg-slate-200 px-2 py-0.5 rounded text-xs">üìã</span>
                                                    <span class="text-slate-500 text-xs">v4.1.007</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Actions Bar -->
                                        <div class="bg-slate-50 p-2 border-b-2 border-slate-400">
                                            <div class="flex justify-between items-center text-xs">
                                                <div class="flex gap-2">
                                                    <span class="bg-orange-100 px-2 py-0.5 rounded border border-orange-300 text-xs">üìç Location Filter</span>
                                                    <span class="bg-blue-500 text-white px-2 py-0.5 rounded text-xs">üì± Devices</span>
                                                    <span class="bg-green-500 text-white px-2 py-0.5 rounded text-xs">‚ö° Connections</span>
                                                </div>
                                                <div class="flex gap-1">
                                                    <span class="bg-green-600 text-white px-1 py-0.5 rounded text-xs">üíæ</span>
                                                    <span class="bg-indigo-500 text-white px-1 py-0.5 rounded text-xs">üìä</span>
                                                    <span class="bg-slate-500 text-white px-1 py-0.5 rounded text-xs">üíæ</span>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Tabs -->
                                        <div class="bg-white p-1 border-b border-slate-300">
                                            <div class="flex gap-1 text-xs">
                                                <span class="bg-blue-100 px-2 py-1 rounded border-b-2 border-blue-500">üì± Devices</span>
                                                <span class="px-2 py-1">‚ö° Connections</span>
                                                <span class="px-2 py-1">üó∫Ô∏è Topology</span>
                                                <span class="px-2 py-1">üìä Matrix</span>
                                                <span class="px-2 py-1">üè¢ Floor Plan</span>
                                                <span class="px-2 py-1">‚ùì Help</span>
                                            </div>
                                        </div>
                                        <!-- Content -->
                                        <div class="bg-white p-4 text-center text-slate-400 text-xs h-24 flex items-center justify-center">
                                            [Contenuto della scheda attiva]
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-sky-200">
                                <h3 class="font-bold text-sky-900 mb-3">üìç Descrizione delle Aree</h3>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-xs">
                                        <thead class="bg-sky-100">
                                            <tr>
                                                <th class="px-3 py-2 text-left font-bold text-sky-900 w-1/4">Area</th>
                                                <th class="px-3 py-2 text-left font-bold text-sky-900">Descrizione</th>
                                                <th class="px-3 py-2 text-left font-bold text-sky-900">Elementi</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-sky-100">
                                            <tr class="bg-sky-50">
                                                <td class="px-3 py-2 font-semibold text-sky-800">üîù Header (Intestazione)</td>
                                                <td class="px-3 py-2 text-sky-700">Barra superiore sempre visibile con logo e controlli principali</td>
                                                <td class="px-3 py-2 text-sky-700">Logo Tiesse, titolo, pulsante Login/Logout, pulsante Logs, versione</td>
                                            </tr>
                                            <tr>
                                                <td class="px-3 py-2 font-semibold text-sky-800">‚ö° Actions Bar</td>
                                                <td class="px-3 py-2 text-sky-700">Barra delle azioni rapide e filtri globali</td>
                                                <td class="px-3 py-2 text-sky-700">Filtro Location, contatori, pulsanti Export/Import, Save</td>
                                            </tr>
                                            <tr class="bg-sky-50">
                                                <td class="px-3 py-2 font-semibold text-sky-800">üìë Tab Navigation</td>
                                                <td class="px-3 py-2 text-sky-700">Schede per navigare tra le diverse sezioni</td>
                                                <td class="px-3 py-2 text-sky-700">Devices, Connections, Topology, Matrix, Floor Plan, Help</td>
                                            </tr>
                                            <tr>
                                                <td class="px-3 py-2 font-semibold text-sky-800">üìÑ Content Area</td>
                                                <td class="px-3 py-2 text-sky-700">Area principale che mostra il contenuto della scheda selezionata</td>
                                                <td class="px-3 py-2 text-sky-700">Varia in base alla scheda attiva</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-sky-200">
                                <h3 class="font-bold text-sky-900 mb-3">üîò Pulsanti dell'Header</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="bg-blue-500 text-white px-2 py-1 rounded">üîì Edit Mode</span>
                                        </div>
                                        <p class="text-slate-700"><strong>Funzione:</strong> Apre il popup di login per accedere alla modalit√† di modifica.</p>
                                        <p class="text-slate-600 mt-1"><strong>Quando visibile:</strong> Sempre, se non sei autenticato.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="bg-slate-500 text-white px-2 py-1 rounded">üîí Logout</span>
                                        </div>
                                        <p class="text-slate-700"><strong>Funzione:</strong> Esce dalla modalit√† di modifica e torna in sola lettura.</p>
                                        <p class="text-slate-600 mt-1"><strong>Quando visibile:</strong> Solo dopo aver effettuato il login.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="bg-slate-200 text-slate-700 px-2 py-1 rounded">üìã</span>
                                        </div>
                                        <p class="text-slate-700"><strong>Funzione:</strong> Apre la scheda Activity Logs con lo storico delle modifiche.</p>
                                        <p class="text-slate-600 mt-1"><strong>Quando visibile:</strong> Sempre.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-2">
                                            <span class="text-slate-500 px-2 py-1 bg-slate-100 rounded">v4.1.007</span>
                                        </div>
                                        <p class="text-slate-700"><strong>Funzione:</strong> Mostra la versione corrente del sistema.</p>
                                        <p class="text-slate-600 mt-1"><strong>Quando visibile:</strong> Sempre.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-sky-200">
                                <h3 class="font-bold text-sky-900 mb-3">‚ö° Pulsanti della Barra Azioni</h3>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-xs">
                                        <thead class="bg-sky-100">
                                            <tr>
                                                <th class="px-2 py-2 text-left font-bold text-sky-900">Pulsante</th>
                                                <th class="px-2 py-2 text-left font-bold text-sky-900">Funzione</th>
                                                <th class="px-2 py-2 text-left font-bold text-sky-900">Visibilit√†</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-sky-100">
                                            <tr>
                                                <td class="px-2 py-2"><span class="bg-orange-100 border border-orange-300 px-2 py-0.5 rounded text-xs">üåê All Locations ‚ñæ</span></td>
                                                <td class="px-2 py-2 text-sky-700">Filtro globale per Location. Filtra TUTTI i dati visualizzati in ogni scheda.</td>
                                                <td class="px-2 py-2 text-sky-600">Sempre</td>
                                            </tr>
                                            <tr class="bg-sky-50">
                                                <td class="px-2 py-2"><span class="bg-blue-500 text-white px-2 py-0.5 rounded text-xs">üì± N Devices</span></td>
                                                <td class="px-2 py-2 text-sky-700">Mostra il totale dispositivi. Click per andare alla scheda Devices.</td>
                                                <td class="px-2 py-2 text-sky-600">Sempre</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2"><span class="bg-green-500 text-white px-2 py-0.5 rounded text-xs">‚ö° N Connections</span></td>
                                                <td class="px-2 py-2 text-sky-700">Mostra il totale connessioni. Click per andare alla scheda Connections.</td>
                                                <td class="px-2 py-2 text-sky-600">Sempre</td>
                                            </tr>
                                            <tr class="bg-sky-50">
                                                <td class="px-2 py-2"><span class="bg-green-600 text-white px-2 py-0.5 rounded text-xs">üíæ Save Now</span></td>
                                                <td class="px-2 py-2 text-sky-700">Salva tutte le modifiche sul server. <strong class="text-red-600">ESSENZIALE!</strong></td>
                                                <td class="px-2 py-2 text-sky-600">Solo Edit Mode</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2"><span class="bg-indigo-500 text-white px-2 py-0.5 rounded text-xs">üìä Export to Excel</span></td>
                                                <td class="px-2 py-2 text-sky-700">Scarica file Excel con tutti i dati (dispositivi, connessioni, stanze).</td>
                                                <td class="px-2 py-2 text-sky-600">Sempre</td>
                                            </tr>
                                            <tr class="bg-sky-50">
                                                <td class="px-2 py-2"><span class="bg-slate-500 text-white px-2 py-0.5 rounded text-xs">üíæ Export JSON</span></td>
                                                <td class="px-2 py-2 text-sky-700">Scarica backup JSON completo. Usalo per backup e ripristini!</td>
                                                <td class="px-2 py-2 text-sky-600">Sempre</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2"><span class="bg-slate-500 text-white px-2 py-0.5 rounded text-xs">üì• Import JSON</span></td>
                                                <td class="px-2 py-2 text-sky-700">Carica un file JSON di backup. <strong class="text-red-600">SOVRASCRIVE tutto!</strong></td>
                                                <td class="px-2 py-2 text-sky-600">Solo Edit Mode</td>
                                            </tr>
                                            <tr class="bg-sky-50">
                                                <td class="px-2 py-2"><span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">Clear All</span></td>
                                                <td class="px-2 py-2 text-sky-700">Elimina TUTTI i dati. Crea backup automatico prima della cancellazione.</td>
                                                <td class="px-2 py-2 text-sky-600">Solo Edit Mode</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-sky-200">
                                <h3 class="font-bold text-sky-900 mb-3">üìë Le Schede (Tabs)</h3>
                                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-3 text-xs">
                                    <div class="bg-purple-50 p-3 rounded-lg border border-purple-200">
                                        <span class="font-bold text-purple-900">üì± Devices</span>
                                        <p class="text-purple-700 mt-1">Elenco di tutti i dispositivi di rete. Qui aggiungi, modifichi ed elimini dispositivi.</p>
                                    </div>
                                    <div class="bg-orange-50 p-3 rounded-lg border border-orange-200">
                                        <span class="font-bold text-orange-900">‚ö° Connections</span>
                                        <p class="text-orange-700 mt-1">Elenco di tutti i cavi/collegamenti. Qui documenti le connessioni fisiche.</p>
                                    </div>
                                    <div class="bg-cyan-50 p-3 rounded-lg border border-cyan-200">
                                        <span class="font-bold text-cyan-900">üó∫Ô∏è Topology</span>
                                        <p class="text-cyan-700 mt-1">Mappa grafica interattiva della rete con icone stile Cisco.</p>
                                    </div>
                                    <div class="bg-pink-50 p-3 rounded-lg border border-pink-200">
                                        <span class="font-bold text-pink-900">üìä Matrix</span>
                                        <p class="text-pink-700 mt-1">Matrice delle connessioni: griglia visuale che mostra chi √® collegato a chi.</p>
                                    </div>
                                    <div class="bg-emerald-50 p-3 rounded-lg border border-emerald-200">
                                        <span class="font-bold text-emerald-900">üè¢ Floor Plan</span>
                                        <p class="text-emerald-700 mt-1">Planimetria delle stanze con dispositivi associati.</p>
                                    </div>
                                    <div class="bg-blue-50 p-3 rounded-lg border border-blue-200">
                                        <span class="font-bold text-blue-900">‚ùì Help</span>
                                        <p class="text-blue-700 mt-1">Questa guida che stai leggendo!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-sky-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 2. AUTENTICAZIONE ========== -->
                    <div class="bg-green-50 border-l-4 border-green-500 rounded-r-xl p-5 mb-6" id="help-auth">
                        <h2 class="text-xl font-bold text-green-800 mb-3 flex items-center gap-2">
                            <span class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">2</span>
                            üîê Autenticazione e Permessi
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-green-200">
                                <h3 class="font-bold text-green-900 mb-2">üîê Due Modalit√† di Accesso</h3>
                                <div class="grid md:grid-cols-2 gap-3">
                                    <div class="bg-slate-50 p-3 rounded-lg border-l-4 border-slate-400">
                                        <span class="font-bold text-slate-800">üëÅÔ∏è View Mode (Ospite)</span>
                                        <p class="text-slate-600 text-xs mt-1">Accesso senza login. Puoi:</p>
                                        <ul class="text-slate-500 text-xs mt-1 ml-3 list-disc">
                                            <li>Visualizzare tutti i dati</li>
                                            <li>Navigare tra le schede</li>
                                            <li>Esportare Excel/JSON/PNG</li>
                                            <li>Stampare</li>
                                        </ul>
                                    </div>
                                    <div class="bg-green-100 p-3 rounded-lg border-l-4 border-green-500">
                                        <span class="font-bold text-green-800">‚úèÔ∏è Edit Mode (Autenticato)</span>
                                        <p class="text-green-700 text-xs mt-1">Dopo il login. Puoi anche:</p>
                                        <ul class="text-green-600 text-xs mt-1 ml-3 list-disc">
                                            <li>Aggiungere/Modificare/Eliminare dispositivi</li>
                                            <li>Creare/Modificare/Eliminare connessioni</li>
                                            <li>Gestire stanze nel Floor Plan</li>
                                            <li>Importare dati JSON</li>
                                            <li>Svuotare tutti i dati (Clear All)</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-green-200">
                                <h3 class="font-bold text-green-900 mb-2">üîì Come Effettuare il Login</h3>
                                <ol class="text-green-800 text-sm space-y-2 list-decimal ml-4">
                                    <li>Clicca il pulsante <span class="bg-blue-500 text-white px-2 py-0.5 rounded text-xs">üîì Edit Mode</span> in alto a destra</li>
                                    <li>Inserisci <strong>Username</strong> e <strong>Password</strong> forniti dall'amministratore</li>
                                    <li>Clicca <strong>Login</strong></li>
                                    <li>Vedrai il messaggio di benvenuto e i controlli di modifica diventeranno visibili</li>
                                </ol>
                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-2 mt-3">
                                    <p class="text-amber-800 text-xs">‚ö†Ô∏è <strong>Importante:</strong> Dopo aver effettuato modifiche, clicca sempre <span class="bg-green-600 text-white px-2 py-0.5 rounded text-xs">üíæ Save Now</span> per salvare!</p>
                                </div>
                            </div>

                            <!-- Sezione Multi-Utente -->
                            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-300">
                                <h3 class="font-bold text-blue-900 mb-2">üë• Accesso Multi-Utente (Lock di Modifica)</h3>
                                <p class="text-blue-800 text-sm mb-3">Il sistema permette a <strong>un solo utente</strong> di modificare i dati alla volta per evitare conflitti.</p>
                                
                                <div class="bg-white rounded-lg p-3 border border-blue-200 mb-3">
                                    <p class="font-semibold text-blue-900 text-sm mb-2">‚öôÔ∏è Come funziona:</p>
                                    <ul class="text-blue-700 text-xs space-y-1 ml-3 list-disc">
                                        <li>Quando effettui il <strong>login</strong>, il sistema acquisisce un "lock di modifica"</li>
                                        <li>Se un altro utente sta gi√† modificando, vedrai un avviso con il nome dell'editor</li>
                                        <li>Il lock scade automaticamente dopo <strong>5 minuti di inattivit√†</strong></li>
                                        <li>Quando fai <strong>logout</strong>, il lock viene rilasciato per altri utenti</li>
                                    </ul>
                                </div>

                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                                        <span class="font-bold text-green-800">‚úÖ Puoi modificare se:</span>
                                        <ul class="text-green-700 mt-1 ml-3 list-disc">
                                            <li>Nessuno sta modificando</li>
                                            <li>Il lock precedente √® scaduto</li>
                                            <li>Sei tu stesso che hai il lock</li>
                                        </ul>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <span class="font-bold text-red-800">‚ùå Non puoi modificare se:</span>
                                        <ul class="text-red-700 mt-1 ml-3 list-disc">
                                            <li>Un altro utente sta modificando</li>
                                            <li>Devi attendere che finisca o che il lock scada</li>
                                        </ul>
                                    </div>
                                </div>

                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-2 mt-3">
                                    <p class="text-amber-800 text-xs">üí° <strong>Best Practice:</strong> Fai sempre <strong>logout</strong> quando finisci di modificare, cos√¨ altri possono accedere subito!</p>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-green-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 3. SCHEDA DEVICES ========== -->
                    <div class="bg-purple-50 border-l-4 border-purple-500 rounded-r-xl p-5 mb-6" id="help-devices">
                        <h2 class="text-xl font-bold text-purple-800 mb-3 flex items-center gap-2">
                            <span class="bg-purple-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">3</span>
                            üì± Scheda Devices (Dispositivi)
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Descrizione della scheda -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-2">üìã Cos'√® la Scheda Devices?</h3>
                                <p class="text-purple-800 text-sm mb-3">La scheda <strong>Devices</strong> √® il cuore del sistema. Qui gestisci <u>tutti</u> i dispositivi della tua rete: router, switch, server, patch panel, access point, PC, stampanti, telecamere IP, UPS, e qualsiasi altro apparecchio collegato alla rete.</p>
                                
                                <div class="bg-purple-50 border border-purple-200 rounded-lg p-3">
                                    <p class="font-semibold text-purple-900 text-sm mb-2">üìå In questa scheda puoi:</p>
                                    <ul class="text-purple-700 text-xs ml-4 list-disc space-y-1">
                                        <li><strong>Visualizzare</strong> l'elenco completo di tutti i dispositivi registrati</li>
                                        <li><strong>Aggiungere</strong> nuovi dispositivi compilando il form (richiede login)</li>
                                        <li><strong>Modificare</strong> dispositivi esistenti cliccando il pulsante "Edit"</li>
                                        <li><strong>Eliminare</strong> dispositivi cliccando il pulsante "Del" (attenzione: elimina anche le connessioni!)</li>
                                        <li><strong>Filtrare</strong> per Location, Group, Type, Status o cercare per nome/IP</li>
                                        <li><strong>Cambiare vista</strong> tra Cards (schede) e Table (tabella)</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Form Add Device - Tutti i campi DETTAGLIATI -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-3">üìù Formulario "Add Device" - Spiegazione Dettagliata di Ogni Campo</h3>
                                <p class="text-purple-700 text-xs mb-3">Il form per aggiungere un dispositivo appare solo in <strong>Edit Mode</strong> (dopo il login). Ecco cosa significa ogni campo:</p>
                                
                                <!-- Campo Location -->
                                <div class="bg-purple-50 rounded-lg p-3 mb-3 border-l-4 border-purple-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-purple-600 text-white px-2 py-1 rounded text-xs font-bold">üìç Location</span>
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">OBBLIGATORIO</span>
                                    </div>
                                    <p class="text-purple-800 text-sm mb-2"><strong>Cosa significa:</strong> La sede, edificio o reparto dove si trova fisicamente il dispositivo.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-purple-900">‚úÖ Esempi corretti:</p>
                                            <ul class="text-purple-700 ml-3 list-disc">
                                                <li>"Sede Centrale"</li>
                                                <li>"Filiale Torino"</li>
                                                <li>"Magazzino Zona Nord"</li>
                                                <li>"Edificio A - Piano 2"</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-purple-900">üìå Note:</p>
                                            <ul class="text-purple-700 ml-3 list-disc">
                                                <li>Seleziona da elenco o crea nuova</li>
                                                <li>Usa il pulsante ‚öôÔ∏è per gestire le location</li>
                                                <li>Le location delle stanze (Floor Plan) appaiono qui</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo Group -->
                                <div class="bg-blue-50 rounded-lg p-3 mb-3 border-l-4 border-blue-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-blue-600 text-white px-2 py-1 rounded text-xs font-bold">üóÇÔ∏è Group</span>
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">OBBLIGATORIO</span>
                                    </div>
                                    <p class="text-blue-800 text-sm mb-2"><strong>Cosa significa:</strong> Il raggruppamento all'interno della location: rack, armadio, stanza specifica, zona.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-blue-900">‚úÖ Esempi corretti:</p>
                                            <ul class="text-blue-700 ml-3 list-disc">
                                                <li>"Rack-01" (armadio rack numero 1)</li>
                                                <li>"Rack-02" (armadio rack numero 2)</li>
                                                <li>"Ufficio Direzione" (stanza)</li>
                                                <li>"Sala Server" (stanza)</li>
                                                <li>"Standalone" (dispositivi sparsi)</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-blue-900">üìå Note:</p>
                                            <ul class="text-blue-700 ml-3 list-disc">
                                                <li>Puoi digitare liberamente o selezionare</li>
                                                <li>L'elenco mostra i gruppi gi√† usati</li>
                                                <li>Usa nomi coerenti per raggruppare</li>
                                            </ul>
                                        </div>
                                    </div>
                                    
                                    <!-- IMPORTANTE: Gruppi condivisi tra locations -->
                                    <div class="bg-blue-100 rounded-lg p-3 mt-3 border border-blue-300">
                                        <p class="font-bold text-blue-900 text-sm mb-2">üí° Gruppi Condivisi tra Locations</p>
                                        <p class="text-blue-800 text-xs mb-2">Puoi usare lo <strong>stesso nome di gruppo</strong> in pi√π locations diverse! Il sistema differenzia automaticamente i dispositivi in base alla <strong>Location</strong>.</p>
                                        
                                        <div class="bg-white rounded p-2 mb-2">
                                            <p class="font-semibold text-blue-900 text-xs mb-1">üìû Esempio: Telefoni IP in ogni reparto</p>
                                            <div class="grid grid-cols-3 gap-1 text-xs">
                                                <div class="bg-blue-50 p-1 rounded text-center">
                                                    <div class="font-bold">Ufficio 12</div>
                                                    <div class="text-blue-600">Group: IP Phone</div>
                                                </div>
                                                <div class="bg-blue-50 p-1 rounded text-center">
                                                    <div class="font-bold">Magazzino</div>
                                                    <div class="text-blue-600">Group: IP Phone</div>
                                                </div>
                                                <div class="bg-blue-50 p-1 rounded text-center">
                                                    <div class="font-bold">Reception</div>
                                                    <div class="text-blue-600">Group: IP Phone</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="bg-white rounded p-2 mb-2">
                                            <p class="font-semibold text-blue-900 text-xs mb-1">üåê Esempio: Router di area in ogni reparto</p>
                                            <div class="grid grid-cols-3 gap-1 text-xs">
                                                <div class="bg-green-50 p-1 rounded text-center">
                                                    <div class="font-bold">Produzione</div>
                                                    <div class="text-green-600">Group: Area Router</div>
                                                </div>
                                                <div class="bg-green-50 p-1 rounded text-center">
                                                    <div class="font-bold">Amministrazione</div>
                                                    <div class="text-green-600">Group: Area Router</div>
                                                </div>
                                                <div class="bg-green-50 p-1 rounded text-center">
                                                    <div class="font-bold">QA/ICT</div>
                                                    <div class="text-green-600">Group: Area Router</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <p class="text-blue-700 text-xs"><strong>‚ö†Ô∏è Filtraggio:</strong> Quando filtri solo per Group (es. "IP Phone") senza selezionare una Location, vedrai tutti i telefoni di tutte le locations. Il sistema mostrer√† un avviso per ricordarti di filtrare per Location.</p>
                                        
                                        <div class="bg-amber-50 border border-amber-200 rounded p-2 mt-2">
                                            <p class="font-semibold text-amber-800 text-xs">üìã Gruppi suggeriti per dispositivi sparsi:</p>
                                            <ul class="text-amber-700 text-xs ml-3 list-disc">
                                                <li><strong>IP Phone</strong> - Telefoni VoIP</li>
                                                <li><strong>Area Router</strong> - Router di dipartimento</li>
                                                <li><strong>Access Points</strong> - Punti WiFi</li>
                                                <li><strong>Printers</strong> - Stampanti di rete</li>
                                                <li><strong>Endpoints</strong> - Altri dispositivi</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo Order -->
                                <div class="bg-amber-50 rounded-lg p-3 mb-3 border-l-4 border-amber-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-amber-600 text-white px-2 py-1 rounded text-xs font-bold">üî¢ Order</span>
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">OBBLIGATORIO</span>
                                    </div>
                                    <p class="text-amber-800 text-sm mb-2"><strong>Cosa significa:</strong> La posizione fisica del dispositivo all'interno del rack (unit√† U). Serve per ordinare i dispositivi nella visualizzazione.</p>
                                    <div class="grid md:grid-cols-3 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-amber-900">‚úÖ Valori:</p>
                                            <ul class="text-amber-700 ml-3 list-disc">
                                                <li><code class="bg-amber-200 px-1 rounded">01</code> - <code class="bg-amber-200 px-1 rounded">99</code> = Posizione nel rack</li>
                                                <li><code class="bg-amber-200 px-1 rounded">00</code> = Dispositivo "sparso" (non in rack)</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-amber-900">üìå Convezione:</p>
                                            <ul class="text-amber-700 ml-3 list-disc">
                                                <li>01 = In alto nel rack</li>
                                                <li>42 = In basso (rack standard)</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-amber-900">‚ñ≤‚ñº Pulsanti:</p>
                                            <p class="text-amber-700">Usa le frecce per incrementare/decrementare velocemente</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Checkbox Rear -->
                                <div class="bg-orange-50 rounded-lg p-3 mb-3 border-l-4 border-orange-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-orange-600 text-white px-2 py-1 rounded text-xs font-bold">‚Ü©Ô∏è Rear (R)</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-orange-800 text-sm mb-2"><strong>Cosa significa:</strong> Checkbox che indica se il dispositivo √® montato sul <u>retro</u> del rack invece che sul fronte.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-orange-900">‚òëÔ∏è Quando selezionare:</p>
                                            <ul class="text-orange-700 ml-3 list-disc">
                                                <li>Patch panel montato sul retro</li>
                                                <li>PDU (ciabatta elettrica) posteriore</li>
                                                <li>Organizer cavi posteriore</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-orange-900">üìå Effetto:</p>
                                            <ul class="text-orange-700 ml-3 list-disc">
                                                <li>Il numero Order diventa negativo (es. -05)</li>
                                                <li>Visivamente distinto nella lista</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo Device Name -->
                                <div class="bg-green-50 rounded-lg p-3 mb-3 border-l-4 border-green-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-green-600 text-white px-2 py-1 rounded text-xs font-bold">üìü Device Name</span>
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded text-xs">OBBLIGATORIO</span>
                                    </div>
                                    <p class="text-green-800 text-sm mb-2"><strong>Cosa significa:</strong> Il nome identificativo del dispositivo. Deve essere <u>univoco</u> in tutto il sistema.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-green-900">‚úÖ Esempi corretti:</p>
                                            <ul class="text-green-700 ml-3 list-disc">
                                                <li>"SW-Core-01" (Switch Core 1)</li>
                                                <li>"RT-Gateway" (Router Gateway)</li>
                                                <li>"SRV-DC01" (Server Domain Controller)</li>
                                                <li>"AP-Sala-Riunioni" (Access Point)</li>
                                                <li>"PP-01-A" (Patch Panel 1 lato A)</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-green-900">üìå Suggerimenti:</p>
                                            <ul class="text-green-700 ml-3 list-disc">
                                                <li>Usa prefissi: SW=Switch, RT=Router, SRV=Server</li>
                                                <li>Aggiungi numeri progressivi</li>
                                                <li>Evita spazi (usa trattini -)</li>
                                                <li>Max 100 caratteri</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo Brand/Model -->
                                <div class="bg-slate-50 rounded-lg p-3 mb-3 border-l-4 border-slate-500">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-slate-600 text-white px-2 py-1 rounded text-xs font-bold">üîß Brand/Model</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-slate-800 text-sm mb-2"><strong>Cosa significa:</strong> Marca e modello dell'hardware. Utile per inventario e supporto tecnico.</p>
                                    <div class="bg-white p-2 rounded text-xs">
                                        <p class="font-semibold text-slate-900">‚úÖ Esempi:</p>
                                        <span class="text-slate-600">"Imola6 LX5272", "HPE Aruba 2930F-48G", "Dell PowerEdge R740", "Ubiquiti UniFi AP-AC-Pro"</span>
                                    </div>
                                </div>

                                <!-- Campo Type -->
                                <div class="bg-cyan-50 rounded-lg p-3 mb-3 border-l-4 border-cyan-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-cyan-600 text-white px-2 py-1 rounded text-xs font-bold">üè∑Ô∏è Type</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-cyan-800 text-sm mb-2"><strong>Cosa significa:</strong> Categoria del dispositivo. Determina l'icona mostrata nella Topology e aiuta a filtrare.</p>
                                    <p class="text-cyan-700 text-xs mb-1">Vedi sezione "Tipi di Dispositivo" pi√π sotto per l'elenco completo.</p>
                                </div>

                                <!-- Campo Status -->
                                <div class="bg-emerald-50 rounded-lg p-3 mb-3 border-l-4 border-emerald-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-emerald-600 text-white px-2 py-1 rounded text-xs font-bold">‚ö° Status</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-emerald-800 text-sm mb-2"><strong>Cosa significa:</strong> Stato operativo del dispositivo.</p>
                                    <div class="flex gap-4 text-xs">
                                        <div class="bg-green-100 px-3 py-1 rounded border border-green-300">
                                            <span class="font-bold text-green-800">üü¢ Active</span>
                                            <p class="text-green-700">Dispositivo attivo e funzionante</p>
                                        </div>
                                        <div class="bg-red-100 px-3 py-1 rounded border border-red-300">
                                            <span class="font-bold text-red-800">üî¥ Disabled</span>
                                            <p class="text-red-700">Dispositivo disattivato/spento/in manutenzione</p>
                                        </div>
                                    </div>
                                    <p class="text-emerald-600 text-xs mt-2">üí° I dispositivi Disabled appaiono con asterisco (*) prima del nome e sfondo grigio.</p>
                                </div>

                                <!-- Campo Service -->
                                <div class="bg-pink-50 rounded-lg p-3 mb-3 border-l-4 border-pink-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-pink-600 text-white px-2 py-1 rounded text-xs font-bold">‚öôÔ∏è Service</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-pink-800 text-sm mb-2"><strong>Cosa significa:</strong> Servizi o ruoli forniti dal dispositivo. Testo libero.</p>
                                    <div class="bg-white p-2 rounded text-xs">
                                        <p class="font-semibold text-pink-900">‚úÖ Esempi: </p>
                                        <span class="text-pink-600">"DHCP, DNS", "Gateway Internet", "File Server", "Domain Controller", "Backup", "VoIP PBX", "Videosorveglianza"</span>
                                    </div>
                                </div>

                                <!-- Campo Network Zone (NEW v3.5.030) -->
                                <div class="bg-rose-50 rounded-lg p-3 mb-3 border-l-4 border-rose-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-rose-600 text-white px-2 py-1 rounded text-xs font-bold">üî≤ Network Zone</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                        <span class="bg-green-500 text-white px-2 py-0.5 rounded text-xs">NEW!</span>
                                    </div>
                                    <p class="text-rose-800 text-sm mb-2"><strong>Cosa significa:</strong> Zona di rete a cui appartiene il dispositivo. Usato per raggruppare visivamente i dispositivi nella Topologia.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-rose-900 mb-1">üõ°Ô∏è Zone predefinite:</p>
                                            <ul class="text-rose-700 ml-3 list-disc space-y-1">
                                                <li><strong>DMZ</strong> - Zona demilitarizzata (rosso)</li>
                                                <li><strong>Backbone</strong> - Rete principale (arancione)</li>
                                                <li><strong>LAN</strong> - Rete locale (blu)</li>
                                                <li><strong>WAN</strong> - Rete esterna (verde)</li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-rose-900 mb-1">üåê Zone IP:</p>
                                            <p class="text-rose-700 mb-1">Campo opzionale per il range CIDR della zona:</p>
                                            <ul class="text-rose-700 ml-3 list-disc">
                                                <li><code class="bg-rose-200 px-1 rounded">172.24.254.0/24</code></li>
                                                <li><code class="bg-rose-200 px-1 rounded">10.10.0.0/16</code></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <p class="text-rose-600 text-xs mt-2">üí° Nella Topologia, dispositivi della stessa zona vengono raggruppati in un'area colorata con etichetta.</p>
                                </div>

                                <!-- Campo IP Addresses -->
                                <div class="bg-indigo-50 rounded-lg p-3 mb-3 border-l-4 border-indigo-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-indigo-600 text-white px-2 py-1 rounded text-xs font-bold">üåê IP Addresses</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-indigo-800 text-sm mb-2"><strong>Cosa significa:</strong> Indirizzi IP assegnati al dispositivo. Puoi inserire fino a 4 IP.</p>
                                    <div class="grid md:grid-cols-2 gap-2 text-xs">
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-indigo-900">‚úÖ Formato corretto:</p>
                                            <ul class="text-indigo-700 ml-3 list-disc">
                                                <li><code class="bg-indigo-200 px-1 rounded">192.168.1.1/24</code> (con subnet mask)</li>
                                                <li><code class="bg-indigo-200 px-1 rounded">10.0.0.1</code> (senza mask)</li>
                                                <li><code class="bg-indigo-200 px-1 rounded">172.16.0.1/16</code></li>
                                            </ul>
                                        </div>
                                        <div class="bg-white p-2 rounded">
                                            <p class="font-semibold text-indigo-900">üìå Pulsante +:</p>
                                            <p class="text-indigo-700">Clicca "+" per aggiungere altri campi IP (max 4 per dispositivo)</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Campo Port Config -->
                                <div class="bg-red-50 rounded-lg p-3 mb-3 border-l-4 border-red-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-red-600 text-white px-2 py-1 rounded text-xs font-bold">üîå Port Config</span>
                                        <span class="bg-orange-500 text-white px-2 py-0.5 rounded text-xs">IMPORTANTE!</span>
                                    </div>
                                    <p class="text-red-800 text-sm mb-2"><strong>Cosa significa:</strong> Configurazione delle porte fisiche del dispositivo. <u>Fondamentale per poter creare connessioni!</u></p>
                                    <div class="bg-white p-2 rounded text-xs mb-2">
                                        <p class="font-semibold text-red-900 mb-1">Come funziona:</p>
                                        <ol class="text-red-700 ml-4 list-decimal space-y-1">
                                            <li>Seleziona il <strong>tipo di porta</strong> dal menu (es. "Eth", "GbE", "SFP")</li>
                                            <li>Inserisci la <strong>quantit√†</strong> (es. 24, 48)</li>
                                            <li>Clicca <span class="bg-green-500 text-white px-1 rounded">+ Add</span></li>
                                            <li>Ripeti per ogni tipo di porta presente</li>
                                        </ol>
                                    </div>
                                    <div class="bg-amber-100 border border-amber-300 rounded p-2 text-xs">
                                        <p class="font-bold text-amber-900">‚ö†Ô∏è Attenzione:</p>
                                        <p class="text-amber-800">Se non configuri le porte, non potrai creare connessioni da/verso questo dispositivo! Le porte generano automaticamente gli ID (es. Eth-1, Eth-2, ... Eth-24)</p>
                                    </div>
                                </div>

                                <!-- Campo Links -->
                                <div class="bg-violet-50 rounded-lg p-3 mb-3 border-l-4 border-violet-600">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-violet-600 text-white px-2 py-1 rounded text-xs font-bold">üîó Links</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-violet-800 text-sm mb-2"><strong>Cosa significa:</strong> Link di accesso rapido al dispositivo. Supporta vari protocolli per connessione diretta.</p>
                                    
                                    <div class="bg-white p-3 rounded mb-2">
                                        <p class="font-semibold text-violet-900 text-sm mb-2">üîå Protocolli Supportati:</p>
                                        <div class="grid grid-cols-2 gap-2 text-xs">
                                            <div class="bg-blue-50 p-2 rounded border-l-2 border-blue-500">
                                                <span class="font-bold text-blue-800">SSH</span>
                                                <p class="text-blue-700">Clicca ‚Üí apre client SSH + copia indirizzo</p>
                                                <code class="text-blue-600 text-[10px]">ssh://192.168.1.1</code>
                                            </div>
                                            <div class="bg-orange-50 p-2 rounded border-l-2 border-orange-500">
                                                <span class="font-bold text-orange-800">RDP</span>
                                                <p class="text-orange-700">Clicca ‚Üí scarica file .rdp</p>
                                                <code class="text-orange-600 text-[10px]">rdp://192.168.1.1</code>
                                            </div>
                                            <div class="bg-purple-50 p-2 rounded border-l-2 border-purple-500">
                                                <span class="font-bold text-purple-800">VNC</span>
                                                <p class="text-purple-700">Clicca ‚Üí apre viewer + copia indirizzo</p>
                                                <code class="text-purple-600 text-[10px]">vnc://192.168.1.1</code>
                                            </div>
                                            <div class="bg-teal-50 p-2 rounded border-l-2 border-teal-500">
                                                <span class="font-bold text-teal-800">Telnet</span>
                                                <p class="text-teal-700">Clicca ‚Üí apre client + copia indirizzo</p>
                                                <code class="text-teal-600 text-[10px]">telnet://192.168.1.1</code>
                                            </div>
                                            <div class="bg-green-50 p-2 rounded border-l-2 border-green-500">
                                                <span class="font-bold text-green-800">HTTP/HTTPS</span>
                                                <p class="text-green-700">Clicca ‚Üí apre in nuova scheda</p>
                                                <code class="text-green-600 text-[10px]">https://192.168.1.1</code>
                                            </div>
                                            <div class="bg-amber-50 p-2 rounded border-l-2 border-amber-500">
                                                <span class="font-bold text-amber-800">SMB/NFS</span>
                                                <p class="text-amber-700">Clicca ‚Üí copia percorso</p>
                                                <code class="text-amber-600 text-[10px]">smb://server/share</code>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-amber-100 border border-amber-300 rounded p-2 text-xs">
                                        <p class="font-bold text-amber-900">üí° Suggerimento:</p>
                                        <p class="text-amber-800">Se il protocollo non si apre automaticamente, l'indirizzo √® gi√† copiato negli appunti - basta incollare nel tuo client!</p>
                                    </div>
                                </div>

                                <!-- Campo Notes -->
                                <div class="bg-gray-50 rounded-lg p-3 border-l-4 border-gray-500">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="bg-gray-600 text-white px-2 py-1 rounded text-xs font-bold">üìù Notes</span>
                                        <span class="bg-slate-400 text-white px-2 py-0.5 rounded text-xs">OPZIONALE</span>
                                    </div>
                                    <p class="text-gray-800 text-sm mb-2"><strong>Cosa significa:</strong> Note libere. Qualsiasi informazione aggiuntiva utile.</p>
                                    <div class="bg-white p-2 rounded text-xs">
                                        <p class="font-semibold text-gray-900">‚úÖ Esempi: </p>
                                        <span class="text-gray-600">"Installato 15/01/2026", "Contratto manutenzione scade 12/2027", "Password console: admin/admin", "SN: ABC123456"</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Tipi di dispositivo -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-3">üè∑Ô∏è Tipi di Dispositivo Disponibili</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                    <div class="bg-slate-50 p-2 rounded">üì° Router</div>
                                    <div class="bg-slate-50 p-2 rounded">üîÄ Switch</div>
                                    <div class="bg-slate-50 p-2 rounded">üìå Patch Panel</div>
                                    <div class="bg-slate-50 p-2 rounded">üîå Wall Jack</div>
                                    <div class="bg-slate-50 p-2 rounded">üß± Firewall</div>
                                    <div class="bg-slate-50 p-2 rounded">üñ•Ô∏è Server</div>
                                    <div class="bg-slate-50 p-2 rounded">üì∂ WiFi AP</div>
                                    <div class="bg-slate-50 p-2 rounded">üåê ISP/Provider</div>
                                    <div class="bg-slate-50 p-2 rounded">üì∂ Router WiFi</div>
                                    <div class="bg-slate-50 p-2 rounded">üì† Modem</div>
                                    <div class="bg-slate-50 p-2 rounded">üîò Hub</div>
                                    <div class="bg-slate-50 p-2 rounded">üíª PC/Desktop</div>
                                    <div class="bg-slate-50 p-2 rounded">üì± Tablet</div>
                                    <div class="bg-slate-50 p-2 rounded">‚òéÔ∏è IP Phone</div>
                                    <div class="bg-slate-50 p-2 rounded">üñ®Ô∏è Printer</div>
                                    <div class="bg-slate-50 p-2 rounded">üß∞ NAS/Storage</div>
                                    <div class="bg-slate-50 p-2 rounded">üìπ IP Camera</div>
                                    <div class="bg-slate-50 p-2 rounded">üîã UPS</div>
                                    <div class="bg-slate-50 p-2 rounded">üì¶ Others</div>
                                </div>
                            </div>

                            <!-- Tipi di porta -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-3">üîå Tipi di Porta Disponibili</h3>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2 text-xs">
                                    <div class="bg-blue-50 p-2 rounded"><strong>Eth</strong> - Ethernet 10/100</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>GbE</strong> - Gigabit Ethernet</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>10GbE</strong> - 10 Gigabit</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>SFP</strong> - Small Form-factor</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>SFP+</strong> - Enhanced SFP</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>QSFP</strong> - Quad SFP</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>RJ45</strong> - Standard Ethernet</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>Console</strong> - Management</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>USB</strong> - USB port</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>Serial</strong> - RS-232</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>Fiber SC</strong> - SC connector</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>Fiber LC</strong> - LC connector</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>PoE</strong> - Power over Ethernet</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>PoE+</strong> - Enhanced PoE</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>WAN</strong> - WAN port</div>
                                    <div class="bg-blue-50 p-2 rounded"><strong>LAN</strong> - LAN port</div>
                                </div>
                            </div>

                            <!-- Visualizzazione lista -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-2">üëÅÔ∏è Modalit√† di Visualizzazione</h3>
                                <div class="grid md:grid-cols-2 gap-3">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">üí≥ Cards View</span>
                                        <p class="text-slate-600 text-xs mt-1">Visualizzazione a schede, raggruppate per Location e Group. Ideale per panoramiche.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">üìâ Table View</span>
                                        <p class="text-slate-600 text-xs mt-1">Visualizzazione tabellare con tutti i dettagli. Ideale per ricerche e confronti.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Filtri -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-2">üîç Filtri Disponibili</h3>
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">üìç Location</span>
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">üóÇÔ∏è Group</span>
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">üè∑Ô∏è Type</span>
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">‚ö° Status</span>
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">üîç Search (Nome/IP)</span>
                                </div>
                            </div>

                            <!-- Azioni sui dispositivi -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-2">‚ö° Azioni sui Dispositivi</h3>
                                <div class="flex flex-wrap gap-2 text-xs mb-3">
                                    <span class="bg-green-500 text-white px-2 py-1 rounded">+ Add</span>
                                    <span class="bg-purple-500 text-white px-2 py-1 rounded">üìã Copy</span>
                                    <span class="bg-blue-500 text-white px-2 py-1 rounded">‚úèÔ∏è Edit</span>
                                    <span class="bg-red-500 text-white px-2 py-1 rounded">üóëÔ∏è Del</span>
                                </div>
                                <div class="bg-purple-50 p-2 rounded text-xs mb-2">
                                    <p class="font-bold text-purple-900">üìã Copy (Duplica):</p>
                                    <p class="text-purple-800">Crea una copia del dispositivo con tutte le impostazioni (nome, tipo, porte, IP, links). La copia si apre automaticamente in modalit√† modifica per personalizzare.</p>
                                </div>
                                <p class="text-red-600 text-xs">‚ö†Ô∏è Eliminando un dispositivo, TUTTE le sue connessioni verranno eliminate!</p>
                            </div>

                            <!-- Indicatore Online Users -->
                            <div class="bg-white rounded-lg p-4 border border-purple-200">
                                <h3 class="font-bold text-purple-900 mb-2">üë• Utenti Online</h3>
                                <p class="text-purple-800 text-sm mb-2">L'indicatore in alto a destra mostra quanti utenti stanno visualizzando il sistema:</p>
                                <div class="flex gap-3 text-xs">
                                    <div class="bg-emerald-100 text-emerald-700 px-3 py-2 rounded-lg">
                                        <span class="font-bold">Verde</span> = Solo visualizzatori
                                    </div>
                                    <div class="bg-amber-100 text-amber-700 px-3 py-2 rounded-lg">
                                        <span class="font-bold">Ambra</span> = Qualcuno sta modificando
                                    </div>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-purple-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 4. SCHEDA CONNECTIONS ========== -->
                    <div class="bg-orange-50 border-l-4 border-orange-500 rounded-r-xl p-5 mb-6" id="help-connections">
                        <h2 class="text-xl font-bold text-orange-800 mb-3 flex items-center gap-2">
                            <span class="bg-orange-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">4</span>
                            ‚ö° Scheda Connections
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-2">üìã Descrizione</h3>
                                <p class="text-orange-800 text-sm">Qui crei e gestisci le <strong>connessioni fisiche</strong> (cavi) tra i dispositivi. Ogni connessione rappresenta un cavo che collega una porta di un dispositivo a una porta di un altro.</p>
                            </div>

                            <!-- Form Connection - Tutti i campi -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üìù Formulario "Add Connection" - Tutti i Campi</h3>
                                
                                <div class="overflow-x-auto">
                                    <table class="w-full text-xs">
                                        <thead class="bg-orange-100">
                                            <tr>
                                                <th class="px-2 py-1 text-left font-bold text-orange-900">Campo</th>
                                                <th class="px-2 py-1 text-left font-bold text-orange-900">Obbl.</th>
                                                <th class="px-2 py-1 text-left font-bold text-orange-900">Descrizione</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-orange-100">
                                            <tr class="bg-orange-50">
                                                <td class="px-2 py-2 font-semibold text-orange-800" colspan="3">üì§ SORGENTE (Da dove parte il cavo)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-orange-700">üìç From Location</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-orange-700">Filtra dispositivi per sede (opzionale)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-orange-700">üóÇÔ∏è From Group</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-orange-700">Filtra dispositivi per gruppo (opzionale)</td>
                                            </tr>
                                            <tr class="bg-orange-50">
                                                <td class="px-2 py-2 font-semibold text-orange-800">üìü From Device</td>
                                                <td class="px-2 py-2 text-red-600 font-bold">*</td>
                                                <td class="px-2 py-2 text-orange-700">Dispositivo da cui parte il cavo</td>
                                            </tr>
                                            <tr class="bg-orange-50">
                                                <td class="px-2 py-2 font-semibold text-orange-800">üîå From Port</td>
                                                <td class="px-2 py-2 text-red-600 font-bold">*</td>
                                                <td class="px-2 py-2 text-orange-700">Porta sorgente (solo disponibili)</td>
                                            </tr>
                                            <tr class="bg-amber-50">
                                                <td class="px-2 py-2 font-semibold text-amber-800" colspan="3">üì• DESTINAZIONE (Dove arriva il cavo)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-amber-700">üìç To Location</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-amber-700">Filtra dispositivi per sede (opzionale)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-amber-700">üóÇÔ∏è To Group</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-amber-700">Filtra dispositivi per gruppo (opzionale)</td>
                                            </tr>
                                            <tr class="bg-amber-50">
                                                <td class="px-2 py-2 font-semibold text-amber-800">üìü To Device</td>
                                                <td class="px-2 py-2 text-red-600 font-bold">*</td>
                                                <td class="px-2 py-2 text-amber-700">Dispositivo destinazione (o "External/ISP")</td>
                                            </tr>
                                            <tr class="bg-amber-50">
                                                <td class="px-2 py-2 font-semibold text-amber-800">üîå To Port</td>
                                                <td class="px-2 py-2 text-red-600 font-bold">*</td>
                                                <td class="px-2 py-2 text-amber-700">Porta destinazione (solo disponibili)</td>
                                            </tr>
                                            <tr class="bg-slate-50">
                                                <td class="px-2 py-2 font-semibold text-slate-800" colspan="3">üìã DETTAGLI CONNESSIONE</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-slate-700">üè∑Ô∏è Type</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-slate-700">Tipo connessione (LAN, WAN, Trunk, ecc.)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-slate-700">‚ö° Status</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-slate-700">Active / Disabled</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-slate-700">üîñ Cable ID</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-slate-700">Etichetta/numero del cavo fisico</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-slate-700">üé® Color</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-slate-700">Colore del cavo (per identificazione)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 text-slate-700">üìù Notes</td>
                                                <td class="px-2 py-2 text-slate-400">-</td>
                                                <td class="px-2 py-2 text-slate-700">Note libere</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Tipi di connessione -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üè∑Ô∏è Tipi di Connessione e Colori</h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-xs">
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#3b82f6"></span>
                                        <span><strong>LAN</strong> - Rete locale</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#ef4444"></span>
                                        <span><strong>WAN</strong> - Internet/WAN</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#f97316"></span>
                                        <span><strong>DMZ</strong> - Zona demilitarizzata</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#22c55e"></span>
                                        <span><strong>Trunk</strong> - Uplink/Aggregazione</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#8b5cf6"></span>
                                        <span><strong>Management</strong> - Gestione</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#eab308"></span>
                                        <span><strong>Backup</strong> - Collegamento backup</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#06b6d4"></span>
                                        <span><strong>Fiber</strong> - Fibra ottica</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#a78bfa"></span>
                                        <span><strong>Wall Jack</strong> - Presa a muro</span>
                                    </div>
                                    <div class="flex items-center gap-2 p-2 rounded bg-slate-50">
                                        <span class="w-4 h-4 rounded" style="background:#ec4899"></span>
                                        <span><strong>External</strong> - Connessione esterna</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Patch Panel speciale -->
                            <div class="bg-purple-100 rounded-lg p-4 border border-purple-300">
                                <h3 class="font-bold text-purple-900 mb-2">üìå Funzionalit√† Speciale: Patch Panel</h3>
                                <p class="text-purple-800 text-sm mb-2">I <strong>Patch Panel</strong> hanno una logica speciale: ogni porta pu√≤ avere <strong>2 connessioni</strong> (fronte e retro).</p>
                                <div class="bg-white p-3 rounded-lg text-xs">
                                    <p class="font-semibold text-purple-900 mb-1">Esempio:</p>
                                    <ol class="text-purple-700 list-decimal ml-4 space-y-1">
                                        <li>Wall Jack (parete) ‚Üí Patch Panel porta 19 (RETRO)</li>
                                        <li>Patch Panel porta 19 ‚Üí Switch porta 33 (FRONTE)</li>
                                    </ol>
                                    <p class="text-purple-600 mt-2">Indicatori: <code class="bg-purple-200 px-1 rounded">(Libera)</code>, <code class="bg-purple-200 px-1 rounded">(1/2)</code>, <code class="bg-purple-200 px-1 rounded">(2/2 - completa)</code></p>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-orange-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 5. SCHEDA TOPOLOGY ========== -->
                    <div class="bg-cyan-50 border-l-4 border-cyan-500 rounded-r-xl p-5 mb-6" id="help-topology">
                        <h2 class="text-xl font-bold text-cyan-800 mb-3 flex items-center gap-2">
                            <span class="bg-cyan-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">5</span>
                            üó∫Ô∏è Scheda Topology (Mappa di Rete)
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-cyan-200">
                                <h3 class="font-bold text-cyan-900 mb-2">üìã Descrizione</h3>
                                <p class="text-cyan-800 text-sm">Visualizzazione grafica interattiva della rete con <strong>icone stile Cisco</strong>. Mostra dispositivi come nodi e connessioni come linee colorate.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-cyan-200">
                                <h3 class="font-bold text-cyan-900 mb-2">üéõÔ∏è Controlli Disponibili</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üìç Filtro Location:</strong> Mostra solo una sede
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üóÇÔ∏è Filtro Group:</strong> Mostra solo un gruppo
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üîÑ Layout:</strong> Auto, Circle, Grid, Hierarchical
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üó∫Ô∏è Fit View:</strong> Centra e adatta la vista
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üìã Legend:</strong> Mostra legenda dispositivi
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üì∑ Export PNG:</strong> Scarica immagine
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded">
                                        <strong>üì• Export .drawio:</strong> Esporta per Draw.io
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-cyan-200">
                                <h3 class="font-bold text-cyan-900 mb-2">üñ±Ô∏è Interazioni Mouse</h3>
                                <div class="grid md:grid-cols-2 gap-2 text-xs">
                                    <div class="bg-cyan-100 p-2 rounded">üñ±Ô∏è <strong>Drag dispositivo:</strong> Riposiziona</div>
                                    <div class="bg-cyan-100 p-2 rounded">üñ±Ô∏è <strong>Drag sfondo:</strong> Pan (sposta vista)</div>
                                    <div class="bg-cyan-100 p-2 rounded">‚öôÔ∏è <strong>Scroll:</strong> Zoom in/out</div>
                                    <div class="bg-cyan-100 p-2 rounded">üëÜ <strong>Hover:</strong> Mostra dettagli</div>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-cyan-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 6. SCHEDA MATRIX ========== -->
                    <div class="bg-pink-50 border-l-4 border-pink-500 rounded-r-xl p-5 mb-6" id="help-matrix">
                        <h2 class="text-xl font-bold text-pink-800 mb-3 flex items-center gap-2">
                            <span class="bg-pink-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">6</span>
                            üìä Scheda Matrix (Matrice Connessioni)
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-pink-200">
                                <h3 class="font-bold text-pink-900 mb-2">üìã Descrizione</h3>
                                <p class="text-pink-800 text-sm">Una <strong>griglia visuale</strong> che mostra tutte le connessioni in formato tabellare. Righe = dispositivi sorgente, Colonne = dispositivi destinazione.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-pink-200">
                                <h3 class="font-bold text-pink-900 mb-2">üìñ Come Leggere la Matrice</h3>
                                <div class="bg-slate-50 p-3 rounded-lg text-xs font-mono">
<pre>          ‚îÇ Device-A ‚îÇ Device-B ‚îÇ Device-C ‚îÇ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
Device-A  ‚îÇ    -     ‚îÇ   üîµ     ‚îÇ          ‚îÇ
Device-B  ‚îÇ   üîµ     ‚îÇ    -     ‚îÇ   üü¢     ‚îÇ
Device-C  ‚îÇ          ‚îÇ   üü¢     ‚îÇ    -     ‚îÇ</pre>
                                </div>
                                <ul class="text-pink-700 text-xs mt-2 space-y-1">
                                    <li>üîµ = Connessione LAN tra Device-A e Device-B</li>
                                    <li>üü¢ = Connessione Trunk tra Device-B e Device-C</li>
                                    <li>Vuoto = Nessuna connessione</li>
                                </ul>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-pink-200">
                                <h3 class="font-bold text-pink-900 mb-2">üéõÔ∏è Controlli</h3>
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">üìç Filtro Location</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">üóÇÔ∏è Filtro Group</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">‚òëÔ∏è Solo connessi</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">‚ûï/‚ûñ Zoom</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">üìä Fit View</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">üì∑ Export PNG</span>
                                    <span class="bg-pink-100 text-pink-800 px-2 py-1 rounded">üñ®Ô∏è Print</span>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-pink-200">
                                <h3 class="font-bold text-pink-900 mb-2">üëÜ Interazioni</h3>
                                <ul class="text-pink-700 text-xs space-y-1">
                                    <li><strong>Click su cella:</strong> Modifica quella connessione</li>
                                    <li><strong>Hover su cella:</strong> Mostra dettagli (porte, tipo, cavo)</li>
                                    <li><strong>Scroll:</strong> Zoom in/out</li>
                                    <li><strong>Drag:</strong> Pan (sposta vista)</li>
                                </ul>
                            </div>
                        </div>
                        <a href="#help-index" class="text-pink-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 7. SCHEDA FLOOR PLAN ========== -->
                    <div class="bg-emerald-50 border-l-4 border-emerald-500 rounded-r-xl p-5 mb-6" id="help-floorplan">
                        <h2 class="text-xl font-bold text-emerald-800 mb-3 flex items-center gap-2">
                            <span class="bg-emerald-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">7</span>
                            üè¢ Scheda Floor Plan (Planimetria)
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üìã Descrizione</h3>
                                <p class="text-emerald-800 text-sm">Visualizzazione delle <strong>stanze fisiche</strong> della sede con i dispositivi associati. Permette di vedere dove sono posizionati fisicamente i dispositivi.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-3">üìù Struttura delle Stanze</h3>
                                <div class="overflow-x-auto">
                                    <table class="w-full text-xs">
                                        <thead class="bg-emerald-100">
                                            <tr>
                                                <th class="px-2 py-1 text-left font-bold text-emerald-900">Campo</th>
                                                <th class="px-2 py-1 text-left font-bold text-emerald-900">Descrizione</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-emerald-100">
                                            <tr>
                                                <td class="px-2 py-2 font-semibold text-emerald-800">üÜî ID</td>
                                                <td class="px-2 py-2 text-emerald-700">Identificativo numerico automatico (1, 2, 3...)</td>
                                            </tr>
                                            <tr class="bg-emerald-50">
                                                <td class="px-2 py-2 font-semibold text-emerald-800">üè∑Ô∏è Nickname</td>
                                                <td class="px-2 py-2 text-emerald-700">Nome descrittivo (es. "Sala Server", "Ufficio 12"). <strong class="text-red-600">Usato per associare dispositivi!</strong></td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 font-semibold text-emerald-800">üî∑ Polygon</td>
                                                <td class="px-2 py-2 text-emerald-700">Forma della stanza (poligono con coordinate X/Y)</td>
                                            </tr>
                                            <tr class="bg-emerald-50">
                                                <td class="px-2 py-2 font-semibold text-emerald-800">üé® Color</td>
                                                <td class="px-2 py-2 text-emerald-700">Colore di riempimento (RGBA per trasparenza)</td>
                                            </tr>
                                            <tr>
                                                <td class="px-2 py-2 font-semibold text-emerald-800">üìê Area</td>
                                                <td class="px-2 py-2 text-emerald-700">Area calcolata automaticamente dal poligono</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <div class="bg-amber-100 rounded-lg p-4 border border-amber-300">
                                <h3 class="font-bold text-amber-900 mb-2">üîó Come Associare Dispositivi a una Stanza</h3>
                                <p class="text-amber-800 text-sm mb-2">L'associazione <strong>NON</strong> √® diretta dalla stanza. Invece:</p>
                                <ol class="text-amber-700 text-xs list-decimal ml-4 space-y-1">
                                    <li>Vai nella stanza e imposta un <strong>Nickname</strong> (es. "Sala Server")</li>
                                    <li>Vai alla scheda <strong>Devices</strong></li>
                                    <li>Modifica il dispositivo e imposta <strong>Location</strong> = "Sala Server" (stesso nickname)</li>
                                    <li>Il dispositivo apparir√† automaticamente nella stanza!</li>
                                </ol>
                                <p class="text-amber-600 text-xs mt-2">üí° La Location del dispositivo deve corrispondere esattamente al Nickname della stanza.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üéõÔ∏è Controlli</h3>
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded">‚ûï/‚ûñ Zoom</span>
                                    <span class="bg-emerald-100 text-emerald-800 px-2 py-1 rounded">üîÑ Reset</span>
                                </div>
                                <p class="text-emerald-600 text-xs mt-2">üí° Le stanze sono mappate tramite uno strumento separato (draw-rooms-v2.html)</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üñ±Ô∏è Interazioni</h3>
                                <ul class="text-emerald-700 text-xs space-y-1">
                                    <li><strong>Click su stanza:</strong> Mostra dettagli e dispositivi associati</li>
                                    <li><strong>Hover su stanza:</strong> Evidenzia la stanza</li>
                                    <li><strong>Scroll:</strong> Zoom in/out</li>
                                    <li><strong>Drag sfondo:</strong> Pan (sposta vista)</li>
                                </ul>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üìç Legenda Stanze</h3>
                                <p class="text-emerald-700 text-xs">In alto a destra appare la legenda con ID e Nickname di ogni stanza. Stanze con dispositivi mostrano un badge numerico.</p>
                            </div>

                            <!-- Sezione Immagine di Sfondo -->
                            <div class="bg-gradient-to-r from-sky-50 to-cyan-50 rounded-lg p-4 border border-sky-300">
                                <h3 class="font-bold text-sky-900 mb-2">üñºÔ∏è Immagine di Sfondo (Planimetria)</h3>
                                <p class="text-sky-800 text-sm mb-3">Il Floor Plan utilizza un'immagine PNG come sfondo per posizionare le stanze sopra la planimetria reale dell'edificio.</p>
                                
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-white p-3 rounded-lg border border-sky-200">
                                        <span class="font-bold text-sky-900">üìÅ Posizione del file:</span>
                                        <p class="text-sky-700 mt-1 font-mono bg-sky-100 p-2 rounded">assets/planta.png</p>
                                    </div>
                                    <div class="bg-white p-3 rounded-lg border border-sky-200">
                                        <span class="font-bold text-sky-900">üìê Dimensioni consigliate:</span>
                                        <p class="text-sky-700 mt-1">2782 √ó 1292 pixel (o proporzioni simili)</p>
                                    </div>
                                </div>

                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-3 mt-3">
                                    <p class="font-semibold text-amber-900 text-xs mb-2">‚ö†Ô∏è Come sostituire l'immagine:</p>
                                    <ol class="text-amber-700 text-xs ml-4 list-decimal space-y-1">
                                        <li>Prepara la tua planimetria in formato PNG</li>
                                        <li>Rinomina il file come <code class="bg-amber-200 px-1 rounded">planta.png</code></li>
                                        <li>Sostituisci il file in <code class="bg-amber-200 px-1 rounded">/var/www/html/matrix/assets/planta.png</code></li>
                                        <li>Se le dimensioni sono diverse, aggiorna i valori in <code class="bg-amber-200 px-1 rounded">js/floorplan.js</code></li>
                                        <li>Ridisegna le stanze usando <code class="bg-amber-200 px-1 rounded">draw-rooms-v2.html</code></li>
                                    </ol>
                                </div>

                                <div class="bg-white p-3 rounded-lg border border-sky-200 mt-3">
                                    <span class="font-bold text-sky-900 text-xs">üí° Suggerimenti per l'immagine:</span>
                                    <ul class="text-sky-700 text-xs mt-1 ml-3 list-disc space-y-1">
                                        <li>Usa immagini ad alta risoluzione per migliore qualit√†</li>
                                        <li>Formati supportati: PNG (trasparenza), JPG</li>
                                        <li>Evita file troppo pesanti (&gt;5MB) per performance</li>
                                        <li>Mantieni proporzioni coerenti con il disegno delle stanze</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-emerald-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 8. SCHEDA LOGS ========== -->
                    <div class="bg-amber-50 border-l-4 border-amber-500 rounded-r-xl p-5 mb-6" id="help-logs">
                        <h2 class="text-xl font-bold text-amber-800 mb-3 flex items-center gap-2">
                            <span class="bg-amber-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">8</span>
                            üìã Scheda Activity Logs
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üìã Descrizione</h3>
                                <p class="text-amber-800 text-sm">Registro delle <strong>ultime 200 modifiche</strong> effettuate al sistema. Utile per tracciare chi ha fatto cosa e quando.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üìä Informazioni per ogni Log</h3>
                                <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-xs">
                                    <div class="bg-amber-100 p-2 rounded text-center">üìÖ Timestamp</div>
                                    <div class="bg-amber-100 p-2 rounded text-center">üè∑Ô∏è Action</div>
                                    <div class="bg-amber-100 p-2 rounded text-center">üì¶ Type</div>
                                    <div class="bg-amber-100 p-2 rounded text-center">üìù Details</div>
                                    <div class="bg-amber-100 p-2 rounded text-center">üë§ User</div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üîç Filtri Disponibili</h3>
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <span class="bg-slate-200 text-slate-800 px-2 py-1 rounded">All Activities</span>
                                    <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">Devices</span>
                                    <span class="bg-green-100 text-green-800 px-2 py-1 rounded">Connections</span>
                                    <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">Import/Export</span>
                                    <span class="bg-amber-100 text-amber-800 px-2 py-1 rounded">Authentication</span>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">‚ö° Azioni</h3>
                                <div class="flex flex-wrap gap-2 text-xs">
                                    <span class="bg-red-500 text-white px-2 py-1 rounded">üóëÔ∏è Clear Logs</span>
                                    <span class="bg-slate-500 text-white px-2 py-1 rounded">üì• Export Logs</span>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-amber-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 9. IMPORT/EXPORT ========== -->
                    <div class="bg-red-50 border-l-4 border-red-500 rounded-r-xl p-5 mb-6" id="help-export">
                        <h2 class="text-xl font-bold text-red-800 mb-3 flex items-center gap-2">
                            <span class="bg-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">9</span>
                            üíæ Import/Export e Backup
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-3">üì§ Funzioni di Esportazione</h3>
                                <div class="space-y-3">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-indigo-500 text-white px-2 py-0.5 rounded text-xs">üìä Export Excel</span>
                                            <span class="text-slate-500 text-xs">Pubblico</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Crea file .xlsx con 4 fogli: Devices, Connections, Matrix, Rooms</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-slate-500 text-white px-2 py-0.5 rounded text-xs">üíæ Export JSON</span>
                                            <span class="text-slate-500 text-xs">Pubblico</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Backup completo: devices, connections, rooms, version. Usalo per ripristini!</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-indigo-500 text-white px-2 py-0.5 rounded text-xs">üì∑ Export PNG</span>
                                            <span class="text-slate-500 text-xs">Topology/Matrix</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Immagine della topologia o matrice con titolo e data</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-orange-500 text-white px-2 py-0.5 rounded text-xs">üì• Export .drawio</span>
                                            <span class="text-slate-500 text-xs">Topology</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">File modificabile in Draw.io/diagrams.net</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-3">üì• Funzioni di Importazione</h3>
                                <div class="bg-slate-50 p-3 rounded-lg">
                                    <div class="flex items-center gap-2 mb-1">
                                        <span class="bg-slate-500 text-white px-2 py-0.5 rounded text-xs">üì• Import JSON</span>
                                        <span class="text-red-500 text-xs font-bold">üîí Richiede Login</span>
                                    </div>
                                    <p class="text-slate-700 text-xs">Importa un file JSON precedentemente esportato. <strong class="text-red-600">ATTENZIONE:</strong> Sovrascrive TUTTI i dati esistenti!</p>
                                </div>
                            </div>

                            <!-- NEW v3.5.029: Data Integrity Section -->
                            <div class="bg-green-100 rounded-lg p-4 border border-green-300">
                                <h3 class="font-bold text-green-900 mb-3">üîê Integrit√† Dati (v3.5.029)</h3>
                                <p class="text-green-800 text-sm mb-3">A partire dalla versione 3.5.028, il sistema include protezioni avanzate per garantire l'integrit√† dei dati:</p>
                                
                                <div class="space-y-2">
                                    <div class="bg-white p-2 rounded-lg">
                                        <span class="font-bold text-green-900 text-xs">üîè SHA-256 Checksum</span>
                                        <p class="text-green-700 text-xs">Ogni export JSON include un hash crittografico SHA-256. All'import, il checksum viene verificato per garantire che il file non sia stato corrotto o modificato.</p>
                                    </div>
                                    <div class="bg-white p-2 rounded-lg">
                                        <span class="font-bold text-green-900 text-xs">üìã Validazione Versione</span>
                                        <p class="text-green-700 text-xs">Solo file JSON con versioni compatibili (3.1.3+) possono essere importati. Versioni non supportate vengono rifiutate.</p>
                                    </div>
                                    <div class="bg-white p-2 rounded-lg">
                                        <span class="font-bold text-green-900 text-xs">üîÑ Rollback Automatico</span>
                                        <p class="text-green-700 text-xs">Se l'import fallisce (checksum invalido, schema errato, etc.), i dati originali vengono automaticamente ripristinati.</p>
                                    </div>
                                    <div class="bg-white p-2 rounded-lg">
                                        <span class="font-bold text-green-900 text-xs">‚úÖ Validazione Schema</span>
                                        <p class="text-green-700 text-xs">Ogni dispositivo, connessione e stanza viene validato contro lo schema atteso. Campi obbligatori, tipi di dati e riferimenti vengono verificati.</p>
                                    </div>
                                </div>
                                
                                <div class="bg-green-200 p-2 rounded-lg mt-3">
                                    <p class="text-green-900 text-xs">üí° <strong>Versioni Supportate:</strong> 4.1.007, 3.6.030, 3.6.024, 3.6.022, 3.5.028, 3.5.005, 3.5.002, 3.5.001, 3.4.5, 3.4.2, 3.4.1, 3.4.0, 3.3.x, 3.2.x, 3.1.3</p>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">‚ö†Ô∏è Clear All (Svuota Tutto)</h3>
                                <p class="text-red-700 text-xs">Elimina TUTTI i dati (devices, connections, rooms). Prima dell'eliminazione viene creato automaticamente un backup JSON scaricabile.</p>
                                <p class="text-red-600 text-xs mt-1 font-bold">üîí Richiede Login</p>
                            </div>

                            <div class="bg-amber-100 rounded-lg p-4 border border-amber-300">
                                <h3 class="font-bold text-amber-900 mb-2">üí° Best Practice per i Backup</h3>
                                <ol class="text-amber-800 text-xs list-decimal ml-4 space-y-1">
                                    <li>Esporta JSON <strong>regolarmente</strong> (almeno settimanalmente)</li>
                                    <li>Conserva i backup in una <strong>cartella sicura</strong></li>
                                    <li>Usa nomi descrittivi: <code class="bg-amber-200 px-1 rounded">network_2026-02-01.json</code></li>
                                    <li>Prima di modifiche importanti, fai <strong>sempre</strong> un backup</li>
                                </ol>
                            </div>
                        </div>
                        <a href="#help-index" class="text-red-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 10. LOCATION MANAGER ========== -->
                    <div class="bg-violet-50 border-l-4 border-violet-500 rounded-r-xl p-5 mb-6" id="help-locations">
                        <h2 class="text-xl font-bold text-violet-800 mb-3 flex items-center gap-2">
                            <span class="bg-violet-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">10</span>
                            üìç Location Manager (Gestione Sedi)
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-violet-200">
                                <h3 class="font-bold text-violet-900 mb-2">üìã Descrizione</h3>
                                <p class="text-violet-800 text-sm">Il <strong>Location Manager</strong> permette di gestire tutte le sedi/location del sistema. Mostra sia le location mappate automaticamente dalle stanze del Floor Plan, sia le location custom create manualmente.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-violet-200">
                                <h3 class="font-bold text-violet-900 mb-2">üöÄ Come Accedere</h3>
                                <p class="text-violet-700 text-sm mb-2">Clicca il pulsante <span class="bg-violet-500 text-white px-2 py-0.5 rounded text-xs">üìç Locations</span> nella barra delle azioni in alto.</p>
                                <p class="text-violet-600 text-xs">üí° Il pulsante si trova vicino ai contatori di Devices/Connections.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-violet-200">
                                <h3 class="font-bold text-violet-900 mb-3">üìä Tipi di Location</h3>
                                <div class="grid md:grid-cols-2 gap-3">
                                    <div class="bg-emerald-50 p-3 rounded-lg border-l-4 border-emerald-500">
                                        <span class="font-bold text-emerald-800">üó∫Ô∏è Mapped Rooms</span>
                                        <p class="text-emerald-700 text-xs mt-1">Location derivate automaticamente dalle stanze del Floor Plan. Corrispondono ai nickname delle stanze.</p>
                                        <ul class="text-emerald-600 text-xs mt-2 ml-3 list-disc">
                                            <li>Sincronizzate con il Floor Plan</li>
                                            <li>Il nickname pu√≤ essere modificato</li>
                                            <li>Non eliminabili direttamente qui</li>
                                        </ul>
                                    </div>
                                    <div class="bg-blue-50 p-3 rounded-lg border-l-4 border-blue-500">
                                        <span class="font-bold text-blue-800">üìù Custom Locations</span>
                                        <p class="text-blue-700 text-xs mt-1">Location create manualmente che non corrispondono a stanze nel Floor Plan.</p>
                                        <ul class="text-blue-600 text-xs mt-2 ml-3 list-disc">
                                            <li>Create automaticamente dai dispositivi</li>
                                            <li>Possono essere rinominate</li>
                                            <li>Possono essere eliminate</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-violet-200">
                                <h3 class="font-bold text-violet-900 mb-2">‚ö° Funzioni Disponibili</h3>
                                <div class="space-y-2 text-xs">
                                    <div class="bg-slate-50 p-2 rounded flex items-center gap-2">
                                        <span class="bg-blue-500 text-white px-2 py-0.5 rounded">‚úèÔ∏è Edit</span>
                                        <span class="text-slate-700">Modifica il nickname/nome della location</span>
                                    </div>
                                    <div class="bg-slate-50 p-2 rounded flex items-center gap-2">
                                        <span class="bg-red-500 text-white px-2 py-0.5 rounded">üóëÔ∏è Delete</span>
                                        <span class="text-slate-700">Elimina una location custom (con riassegnazione dispositivi)</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-amber-100 rounded-lg p-4 border border-amber-300">
                                <h3 class="font-bold text-amber-900 mb-2">‚ö†Ô∏è Eliminazione Location</h3>
                                <p class="text-amber-800 text-sm">Quando elimini una location custom:</p>
                                <ul class="text-amber-700 text-xs mt-2 ml-4 list-disc space-y-1">
                                    <li>Ti verr√† chiesto di scegliere una <strong>nuova location</strong> per i dispositivi esistenti</li>
                                    <li>Tutti i dispositivi verranno automaticamente riassegnati</li>
                                    <li>Le location mappate (Floor Plan) <strong>non possono essere eliminate</strong> da qui</li>
                                </ul>
                            </div>
                        </div>
                        <a href="#help-index" class="text-violet-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 11. STAMPA ========== -->
                    <div class="bg-rose-50 border-l-4 border-rose-500 rounded-r-xl p-5 mb-6" id="help-print">
                        <h2 class="text-xl font-bold text-rose-800 mb-3 flex items-center gap-2">
                            <span class="bg-rose-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">11</span>
                            üñ®Ô∏è Stampa e Esportazione PNG
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-rose-200">
                                <h3 class="font-bold text-rose-900 mb-2">üìã Descrizione</h3>
                                <p class="text-rose-800 text-sm">Il sistema offre diverse opzioni di stampa per documentare la rete. Le stampe sono ottimizzate per la leggibilit√† su carta.</p>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-rose-200">
                                <h3 class="font-bold text-rose-900 mb-3">üñ®Ô∏è Modalit√† di Stampa</h3>
                                <div class="space-y-3">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-rose-500 text-white px-2 py-0.5 rounded text-xs">üñ®Ô∏è Print (Filtered)</span>
                                            <span class="text-slate-500 text-xs">Barra Azioni</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Stampa la scheda attiva (Devices o Connections) rispettando il filtro Location attivo.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-pink-500 text-white px-2 py-0.5 rounded text-xs">üñ®Ô∏è Print Matrix</span>
                                            <span class="text-slate-500 text-xs">Scheda Matrix</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Stampa la matrice delle connessioni con tutti i colori preservati.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="bg-orange-500 text-white px-2 py-0.5 rounded text-xs">üñ®Ô∏è Print Connections</span>
                                            <span class="text-slate-500 text-xs">Scheda Connections</span>
                                        </div>
                                        <p class="text-slate-700 text-xs">Stampa l'elenco delle connessioni attive.</p>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-rose-200">
                                <h3 class="font-bold text-rose-900 mb-2">üìÑ Contenuto Stampa Devices</h3>
                                <div class="grid grid-cols-4 md:grid-cols-8 gap-1 text-xs">
                                    <span class="bg-rose-100 p-1 rounded text-center">Location</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Rack</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Pos</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Name</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Type</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Brand</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">IPs</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Status</span>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-rose-200">
                                <h3 class="font-bold text-rose-900 mb-2">üìÑ Contenuto Stampa Connections</h3>
                                <div class="grid grid-cols-3 md:grid-cols-7 gap-1 text-xs">
                                    <span class="bg-rose-100 p-1 rounded text-center">Cable ID</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">From</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Port</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">To</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Port</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Type</span>
                                    <span class="bg-rose-100 p-1 rounded text-center">Status</span>
                                </div>
                            </div>

                            <div class="bg-green-100 rounded-lg p-4 border border-green-300">
                                <h3 class="font-bold text-green-900 mb-2">üí° Suggerimenti per la Stampa</h3>
                                <ul class="text-green-800 text-xs space-y-1 list-disc ml-4">
                                    <li>Usa il <strong>filtro Location</strong> prima di stampare per documenti pi√π specifici</li>
                                    <li>La stampa apre una <strong>nuova finestra</strong> del browser</li>
                                    <li>Se la finestra non si apre, <strong>abilita i popup</strong> per questo sito</li>
                                    <li>Ogni stampa include <strong>data e ora</strong> di generazione</li>
                                    <li>I <strong>dispositivi disabilitati</strong> appaiono in grigio</li>
                                </ul>
                            </div>
                        </div>
                        <a href="#help-index" class="text-rose-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 12. FLUSSO DI LAVORO ========== -->
                    <div class="bg-yellow-50 border-l-4 border-yellow-500 rounded-r-xl p-5 mb-6" id="help-workflow">
                        <h2 class="text-xl font-bold text-yellow-800 mb-3 flex items-center gap-2">
                            <span class="bg-yellow-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">12</span>
                            üîÑ Flusso di Lavoro Consigliato
                        </h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white rounded-lg p-4 border border-yellow-200">
                                <h3 class="font-bold text-yellow-900 mb-3">üìã Workflow per Nuova Installazione</h3>
                                <div class="bg-slate-50 p-4 rounded-lg font-mono text-xs">
<pre class="text-slate-700">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  1Ô∏è‚É£  LOGIN                                                   ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ Clicca "Edit Mode" ‚Üí Inserisci credenziali         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  2Ô∏è‚É£  CREA DISPOSITIVI (Scheda Devices)                      ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Definisci Location (sede)                          ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Definisci Group (rack/stanza)                      ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Aggiungi tutti i dispositivi                       ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ ‚ö†Ô∏è Configura le PORTE per ogni dispositivo!        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  3Ô∏è‚É£  CREA CONNESSIONI (Scheda Connections)                  ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Seleziona dispositivo sorgente + porta             ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Seleziona dispositivo destinazione + porta         ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Aggiungi tipo, colore cavo, ID                     ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ Ripeti per ogni cavo fisico                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  4Ô∏è‚É£  CONFIGURA FLOOR PLAN (Scheda Floor Plan)               ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Crea le stanze                                     ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Posiziona e dimensiona                             ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ Associa dispositivi alle stanze                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  5Ô∏è‚É£  VERIFICA (Schede Topology e Matrix)                    ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Controlla la topologia visuale                     ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ Verifica la matrice delle connessioni              ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ Correggi eventuali errori                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  6Ô∏è‚É£  SALVA E BACKUP                                         ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ üíæ Clicca "Save Now"                               ‚îÇ
‚îÇ      ‚îú‚îÄ‚îÄ üìä Esporta Excel per documentazione                ‚îÇ
‚îÇ      ‚îî‚îÄ‚îÄ üíæ Esporta JSON per backup                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
</pre>
                                </div>
                            </div>

                            <div class="bg-white rounded-lg p-4 border border-yellow-200">
                                <h3 class="font-bold text-yellow-900 mb-2">‚ö° Workflow per Modifiche Rapide</h3>
                                <ol class="text-yellow-800 text-xs list-decimal ml-4 space-y-1">
                                    <li>Login (se necessario)</li>
                                    <li>Vai alla scheda appropriata (Devices o Connections)</li>
                                    <li>Trova l'elemento da modificare</li>
                                    <li>Clicca "Edit" ‚Üí Modifica ‚Üí "Update"</li>
                                    <li><strong>üíæ Save Now</strong></li>
                                </ol>
                            </div>
                        </div>
                        <a href="#help-index" class="text-yellow-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 13. GLOSSARIO ========== -->
                    <div class="bg-indigo-50 border-l-4 border-indigo-500 rounded-r-xl p-5 mb-6" id="help-glossary">
                        <h2 class="text-xl font-bold text-indigo-800 mb-3 flex items-center gap-2">
                            <span class="bg-indigo-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">13</span>
                            üìñ Glossario dei Termini
                        </h2>
                        
                        <div class="bg-white rounded-lg p-4 border border-indigo-200">
                            <div class="grid md:grid-cols-2 gap-3 text-xs">
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Location</strong>
                                    <p class="text-slate-600">Sede fisica o reparto (es. "Sede Ivrea", "Ufficio Milano")</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Group</strong>
                                    <p class="text-slate-600">Raggruppamento logico (rack, armadio, stanza, zona)</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Order</strong>
                                    <p class="text-slate-600">Posizione fisica nel rack (01-99) o 00 per sparsi</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Rear (R)</strong>
                                    <p class="text-slate-600">Indica dispositivo montato sul retro del rack</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Patch Panel</strong>
                                    <p class="text-slate-600">Pannello con porte passanti (fronte ‚Üî retro)</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Wall Jack</strong>
                                    <p class="text-slate-600">Presa di rete a muro</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Trunk/Uplink</strong>
                                    <p class="text-slate-600">Connessione principale tra switch</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">CIDR</strong>
                                    <p class="text-slate-600">Notazione IP con maschera (es. 192.168.1.1/24)</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">SFP/SFP+</strong>
                                    <p class="text-slate-600">Porta per moduli ottici intercambiabili</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">PoE</strong>
                                    <p class="text-slate-600">Power over Ethernet - alimentazione via cavo rete</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">DMZ</strong>
                                    <p class="text-slate-600">Demilitarized Zone - rete semi-pubblica</p>
                                </div>
                                <div class="bg-slate-50 p-2 rounded">
                                    <strong class="text-indigo-900">Topology</strong>
                                    <p class="text-slate-600">Rappresentazione grafica della struttura di rete</p>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-indigo-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 14. FAQ ========== -->
                    <div class="bg-teal-50 border-l-4 border-teal-500 rounded-r-xl p-5 mb-6" id="help-faq">
                        <h2 class="text-xl font-bold text-teal-800 mb-3 flex items-center gap-2">
                            <span class="bg-teal-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">14</span>
                            ‚ùì Domande Frequenti (FAQ)
                        </h2>
                        
                        <div class="space-y-3">
                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Come faccio il login?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Clicca <span class="bg-blue-500 text-white px-2 py-0.5 rounded text-xs">üîì Edit Mode</span> in alto a destra, inserisci username e password forniti dall'amministratore.</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Cosa significa Order = 00?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Order 00 indica un dispositivo "sparso" non montato in un rack (es. access point sul soffitto, router in altra stanza).</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Quando uso il checkbox "Rear"?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Quando il dispositivo √® montato nella parte posteriore del rack. Convenzione: fronte 01-50, retro 99-50.</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Cosa significa * prima del nome?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Un asterisco <strong class="text-red-600">*</strong> indica che il dispositivo √® <strong>disabilitato</strong> (Status = Disabled).</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Come funzionano le porte del Patch Panel?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Ogni porta del patch panel pu√≤ avere fino a 2 connessioni (fronte e retro), permettendo di collegare wall jack e switch alla stessa porta.</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Pi√π persone possono usarlo insieme?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">S√¨, ma attenzione: l'ultima persona a salvare sovrascriver√† le modifiche degli altri. Coordinarsi!</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Non vedo una porta che mi serve. Cosa faccio?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Vai alla scheda Devices, trova il dispositivo, clicca Edit e aggiungi pi√π porte con "+ Add Port Type".</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Come faccio backup dei dati?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Clicca "Export JSON" regolarmente e conserva il file in posto sicuro. Per ripristinare usa "Import JSON".</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">Come associo dispositivi a una stanza?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">Imposta il <strong>Nickname</strong> della stanza nel Floor Plan, poi modifica il dispositivo nella scheda Devices e imposta <strong>Location</strong> con lo stesso valore del Nickname.</p>
                            </details>

                            <details class="bg-white rounded-lg border border-teal-200">
                                <summary class="font-semibold text-teal-900 p-3 cursor-pointer hover:bg-teal-50">I dati vengono salvati automaticamente?</summary>
                                <p class="text-teal-700 text-sm p-3 pt-0">NO! Devi sempre cliccare <span class="bg-green-600 text-white px-2 py-0.5 rounded text-xs">üíæ Save Now</span> per salvare le modifiche sul server.</p>
                            </details>
                        </div>
                        <a href="#help-index" class="text-teal-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 15. INSTALLAZIONE DEL SISTEMA ========== -->
                    <div class="bg-gradient-to-r from-orange-50 to-red-50 border-l-4 border-orange-500 rounded-r-xl p-5 mb-6" id="help-install">
                        <h2 class="text-xl font-bold text-orange-800 mb-3 flex items-center gap-2">
                            <span class="bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">15</span>
                            üõ†Ô∏è Installazione del Sistema (Guida per Amministratori)
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Introduzione -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-2">üìã Panoramica</h3>
                                <p class="text-orange-800 text-sm mb-3">Questa sezione spiega come installare TIESSE Matrix Network su un server Ubuntu con Apache. Il sistema √® un'applicazione web che funziona su server interno (intranet) e non richiede connessione internet dopo l'installazione.</p>
                                
                                <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                                    <p class="font-semibold text-orange-900 text-sm mb-2">üìå Requisiti di Sistema:</p>
                                    <ul class="text-orange-700 text-sm ml-4 list-disc space-y-1">
                                        <li><strong>Sistema Operativo:</strong> Ubuntu 22.04 LTS o 24.04 LTS (consigliato)</li>
                                        <li><strong>Server Web:</strong> Apache 2.4+ con mod_rewrite</li>
                                        <li><strong>PHP:</strong> PHP 8.1+ con estensioni JSON e mbstring</li>
                                        <li><strong>Strumenti:</strong> unzip (per estrarre file)</li>
                                        <li><strong>Memoria:</strong> Minimo 512MB RAM</li>
                                        <li><strong>Disco:</strong> Minimo 100MB spazio libero</li>
                                        <li><strong>Rete:</strong> IP fisso nella rete locale</li>
                                    </ul>
                                </div>
                            </div>

                            <!-- Passo 1: Preparazione Ubuntu -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üì¶ Passo 1: Preparazione del Server Ubuntu</h3>
                                <p class="text-orange-800 text-sm mb-3">Prima di tutto, aggiornare il sistema e installare i pacchetti necessari:</p>
                                
                                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400 mb-3 overflow-x-auto">
<pre><span class="text-slate-500"># Aggiornare lista pacchetti e sistema</span>
<span class="text-cyan-400">sudo</span> apt update && <span class="text-cyan-400">sudo</span> apt upgrade -y

<span class="text-slate-500"># Installare Apache, PHP e strumenti</span>
<span class="text-cyan-400">sudo</span> apt install -y apache2 php php-json php-mbstring unzip

<span class="text-slate-500"># Verificare se Apache √® in esecuzione</span>
<span class="text-cyan-400">sudo</span> systemctl status apache2

<span class="text-slate-500"># Abilitare Apache all'avvio del sistema</span>
<span class="text-cyan-400">sudo</span> systemctl enable apache2</pre>
                                </div>

                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 text-xs">
                                    <p class="font-semibold text-blue-900 mb-1">üí° Verifica dell'installazione:</p>
                                    <p class="text-blue-700">Aprire un browser e accedere a <code class="bg-blue-200 px-1 rounded">http://IP_DEL_SERVER</code>. Dovresti vedere la pagina predefinita di Apache "It works!".</p>
                                </div>
                            </div>

                            <!-- Passo 2: Installare Matrix -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üìÇ Passo 2: Installare Matrix Network</h3>
                                <p class="text-orange-800 text-sm mb-3">Copiare la cartella <code class="bg-orange-200 px-1 rounded">Matrix</code> sul server e configurare i permessi:</p>
                                
                                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400 mb-3 overflow-x-auto">
<pre><span class="text-slate-500"># Opzione A: Se hai la cartella Matrix su pendrive/HD esterno</span>
<span class="text-slate-500"># Montare il dispositivo e copiare:</span>
<span class="text-cyan-400">sudo</span> cp -r /media/utente/PENDRIVE/Matrix /var/www/html/matrix

<span class="text-slate-500"># Opzione B: Se hai un file matrix.zip</span>
<span class="text-cyan-400">sudo</span> unzip matrix.zip -d /var/www/html/

<span class="text-slate-500"># Rinominare in minuscolo (standardizzazione)</span>
<span class="text-cyan-400">sudo</span> mv /var/www/html/Matrix /var/www/html/matrix 2>/dev/null || true</pre>
                                </div>

                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-3 text-xs">
                                    <p class="font-semibold text-amber-900 mb-1">‚ö†Ô∏è Struttura cartelle prevista:</p>
                                    <div class="bg-slate-800 rounded p-2 font-mono text-green-400 mt-2">
<pre>/var/www/html/matrix/
‚îú‚îÄ‚îÄ index.html          <span class="text-slate-500"># Pagina principale</span>
‚îú‚îÄ‚îÄ data.php            <span class="text-slate-500"># API dati</span>
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îî‚îÄ‚îÄ auth.php        <span class="text-slate-500"># API autenticazione</span>
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ config.php      <span class="text-slate-500"># Configurazione</span>
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ network_manager.json  <span class="text-slate-500"># Dati della rete</span>
‚îú‚îÄ‚îÄ js/                 <span class="text-slate-500"># Script JavaScript</span>
‚îú‚îÄ‚îÄ css/                <span class="text-slate-500"># Stili CSS</span>
‚îî‚îÄ‚îÄ assets/             <span class="text-slate-500"># Librerie e risorse</span></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- Passo 3: Permessi -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üîê Passo 3: Configurare i Permessi</h3>
                                <p class="text-orange-800 text-sm mb-3">Configurare i permessi corretti affinch√© Apache possa leggere e scrivere i dati:</p>
                                
                                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400 mb-3 overflow-x-auto">
<pre><span class="text-slate-500"># Impostare proprietario per l'utente Apache</span>
<span class="text-cyan-400">sudo</span> chown -R www-data:www-data /var/www/html/matrix

<span class="text-slate-500"># Impostare permessi: 755 per cartelle, 644 per file</span>
<span class="text-cyan-400">sudo</span> find /var/www/html/matrix -type d -exec chmod 755 {} \;
<span class="text-cyan-400">sudo</span> find /var/www/html/matrix -type f -exec chmod 644 {} \;

<span class="text-slate-500"># Permesso di scrittura per la cartella dati (importante!)</span>
<span class="text-cyan-400">sudo</span> chmod 775 /var/www/html/matrix/data
<span class="text-cyan-400">sudo</span> chmod 664 /var/www/html/matrix/data/network_manager.json</pre>
                                </div>

                                <div class="bg-red-50 border border-red-200 rounded-lg p-3 text-xs">
                                    <p class="font-semibold text-red-900 mb-1">‚ö†Ô∏è Molto Importante:</p>
                                    <p class="text-red-700">La cartella <code class="bg-red-200 px-1 rounded">/var/www/html/matrix/data</code> DEVE avere permesso di scrittura per l'utente <code class="bg-red-200 px-1 rounded">www-data</code>. Senza questo, il sistema non potr√† salvare le modifiche!</p>
                                </div>
                            </div>

                            <!-- Passo 4: Testare -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">‚úÖ Passo 4: Testare l'Installazione</h3>
                                <p class="text-orange-800 text-sm mb-3">Accedere al sistema tramite browser:</p>
                                
                                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-3">
                                    <p class="font-semibold text-green-900 text-center text-lg mb-2">üåê Indirizzo di Accesso:</p>
                                    <p class="text-center">
                                        <code class="bg-green-200 text-green-900 px-4 py-2 rounded-lg text-lg font-bold">http://IP_DEL_SERVER/matrix/</code>
                                    </p>
                                    <p class="text-green-700 text-xs text-center mt-2">Esempio: <code class="bg-green-200 px-1 rounded">http://192.168.1.100/matrix/</code></p>
                                </div>

                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">‚úÖ Se ha funzionato:</span>
                                        <p class="text-slate-600 mt-1">Vedrai l'interfaccia di Matrix Network. Clicca su "Edit Mode" e accedi per testare le modifiche.</p>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">‚ùå Se c'√® un errore:</span>
                                        <p class="text-slate-600 mt-1">Verifica i log: <code class="bg-slate-200 px-1 rounded">sudo tail -f /var/log/apache2/error.log</code></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Credenziali - SOLO nota per admin -->
                            <div class="bg-amber-50 border border-amber-300 rounded-lg p-4">
                                <h3 class="font-bold text-amber-900 mb-2">üîë Credenziali di Accesso</h3>
                                <p class="text-amber-800 text-sm">Le credenziali di accesso predefinite sono configurate nel file <code class="bg-amber-200 px-1 rounded">/var/www/html/matrix/config/config.php</code>. Contattare l'amministratore di sistema per ottenere le credenziali.</p>
                                <div class="bg-white border border-amber-200 rounded-lg p-3 mt-3 text-xs">
                                    <p class="font-semibold text-amber-900 mb-1">‚ö†Ô∏è Modifica della Password:</p>
                                    <p class="text-amber-700 mb-2">Per sicurezza, modificare la password predefinita:</p>
                                    <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs">
<pre><span class="text-slate-500"># Generare nuovo hash password nel terminale:</span>
php -r "echo password_hash('NuovaPassword', PASSWORD_DEFAULT);"
<span class="text-slate-500"># Copiare il risultato e sostituire in config.php</span></pre>
                                    </div>
                                </div>
                            </div>

                            <!-- Importare Dati -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üì• Passo 5: Importare Dati Esistenti</h3>
                                <p class="text-orange-800 text-sm mb-3">Se hai gi√† dati da un'installazione precedente, importali:</p>
                                
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">üìã Opzione A: Via Interfaccia</span>
                                        <ol class="text-slate-600 mt-2 ml-4 list-decimal space-y-1">
                                            <li>Accedi a Matrix Network dal browser</li>
                                            <li>Clicca su "Edit Mode" e fai login</li>
                                            <li>Clicca su "Import JSON"</li>
                                            <li>Seleziona il file .json esportato precedentemente</li>
                                            <li>Clicca su "Save Now" per confermare</li>
                                        </ol>
                                    </div>
                                    <div class="bg-slate-50 p-3 rounded-lg">
                                        <span class="font-bold text-slate-800">üìã Opzione B: Via Terminale</span>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs mt-2">
<pre><span class="text-slate-500"># Copiare file dati direttamente</span>
<span class="text-cyan-400">sudo</span> cp /percorso/backup.json \
  /var/www/html/matrix/data/network_manager.json
<span class="text-cyan-400">sudo</span> chown www-data:www-data \
  /var/www/html/matrix/data/network_manager.json</pre>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Configurazioni Opzionali -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">‚öôÔ∏è Configurazioni Opzionali (Avanzato)</h3>
                                
                                <details class="bg-slate-50 rounded-lg border border-slate-200 mb-2">
                                    <summary class="font-semibold text-slate-900 p-3 cursor-pointer hover:bg-slate-100">üåê Configurare DNS/Hostname personalizzato</summary>
                                    <div class="p-3 pt-0 text-xs text-slate-700">
                                        <p class="mb-2">Per accedere tramite nome invece di IP (es: <code class="bg-slate-200 px-1 rounded">http://matrix.tiesse.lan</code>):</p>
                                        <ol class="ml-4 list-decimal space-y-1">
                                            <li>Configurare il record DNS nel server DNS interno</li>
                                            <li>Oppure aggiungere nel file hosts di ogni computer client</li>
                                        </ol>
                                    </div>
                                </details>

                                <details class="bg-slate-50 rounded-lg border border-slate-200 mb-2">
                                    <summary class="font-semibold text-slate-900 p-3 cursor-pointer hover:bg-slate-100">üîí Abilitare HTTPS (Certificato SSL)</summary>
                                    <div class="p-3 pt-0 text-xs text-slate-700">
                                        <p class="mb-2">Per reti con certificato SSL interno:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs">
<pre><span class="text-cyan-400">sudo</span> a2enmod ssl
<span class="text-cyan-400">sudo</span> a2ensite default-ssl
<span class="text-cyan-400">sudo</span> systemctl restart apache2</pre>
                                        </div>
                                    </div>
                                </details>

                                <details class="bg-slate-50 rounded-lg border border-slate-200 mb-2" open>
                                    <summary class="font-semibold text-slate-900 p-3 cursor-pointer hover:bg-slate-100">üíæ Backup Automatico (Attivo)</summary>
                                    <div class="p-3 pt-0 text-xs text-slate-700">
                                        
                                        <!-- STATO ATTUALE -->
                                        <div class="bg-green-100 border-2 border-green-400 rounded-lg p-3 mb-3">
                                            <p class="font-bold text-green-900 mb-2">‚úÖ BACKUP AUTOMATICO ATTIVO</p>
                                            <div class="grid md:grid-cols-2 gap-3">
                                                <div class="bg-white p-2 rounded-lg border border-green-300">
                                                    <p class="font-semibold text-green-800">üìÖ Backup Settimanale</p>
                                                    <p class="text-green-700">Ogni <strong>Domenica alle 02:00</strong></p>
                                                </div>
                                                <div class="bg-white p-2 rounded-lg border border-green-300">
                                                    <p class="font-semibold text-green-800">üìÜ Backup Mensile</p>
                                                    <p class="text-green-700">Giorno <strong>1 del mese alle 03:00</strong></p>
                                                </div>
                                            </div>
                                            <div class="mt-2 bg-white p-2 rounded-lg border border-green-300">
                                                <p class="font-semibold text-green-800">üìÅ Cartella Backup:</p>
                                                <code class="text-green-700 font-mono">/var/www/html/matrix/backup/</code>
                                            </div>
                                        </div>

                                        <p class="mb-2">Il sistema include uno script di backup automatico con retention policy:</p>
                                        
                                        <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-3 mb-3">
                                            <p class="font-bold text-emerald-900 mb-2">üìã Politica di Retention:</p>
                                            <ul class="text-emerald-700 ml-3 list-disc space-y-1">
                                                <li><strong>Backup Settimanali:</strong> 4 file (ultime 4 settimane)</li>
                                                <li><strong>Backup Mensili:</strong> 12 file (ultimi 12 mesi)</li>
                                            </ul>
                                        </div>

                                        <p class="font-semibold text-slate-900 mb-2">üìÅ Struttura cartelle:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs mb-3">
<pre>/var/www/html/matrix/backup/
‚îú‚îÄ‚îÄ backup.sh           <span class="text-slate-500"># Script di backup</span>
‚îú‚îÄ‚îÄ backup.log          <span class="text-slate-500"># Log delle operazioni</span>
‚îú‚îÄ‚îÄ weekly/
‚îÇ   ‚îú‚îÄ‚îÄ backup_week_01.json  <span class="text-slate-500"># Settimana 1</span>
‚îÇ   ‚îú‚îÄ‚îÄ backup_week_02.json  <span class="text-slate-500"># Settimana 2</span>
‚îÇ   ‚îú‚îÄ‚îÄ backup_week_03.json  <span class="text-slate-500"># Settimana 3</span>
‚îÇ   ‚îî‚îÄ‚îÄ backup_week_04.json  <span class="text-slate-500"># Settimana 4</span>
‚îî‚îÄ‚îÄ monthly/
    ‚îú‚îÄ‚îÄ backup_2026_01.json  <span class="text-slate-500"># Gennaio</span>
    ‚îú‚îÄ‚îÄ backup_2026_02.json  <span class="text-slate-500"># Febbraio</span>
    ‚îî‚îÄ‚îÄ ... <span class="text-slate-500">(12 mesi max)</span></pre>
                                        </div>

                                        <p class="font-semibold text-slate-900 mb-2">üîß Comandi utili:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs mb-3">
<pre><span class="text-slate-500"># Vedere stato dei backup</span>
<span class="text-cyan-400">sudo</span> /var/www/html/matrix/backup/backup.sh status

<span class="text-slate-500"># Eseguire backup manuale completo</span>
<span class="text-cyan-400">sudo</span> /var/www/html/matrix/backup/backup.sh

<span class="text-slate-500"># Verificare crontab attivo</span>
<span class="text-cyan-400">sudo</span> crontab -l

<span class="text-slate-500"># Vedere log backup</span>
<span class="text-cyan-400">cat</span> /var/www/html/matrix/backup/backup.log</pre>
                                        </div>

                                        <div class="bg-amber-50 border border-amber-200 rounded-lg p-2">
                                            <p class="font-semibold text-amber-900 text-xs">‚ö†Ô∏è Ripristino da Backup:</p>
                                            <p class="text-amber-700 text-xs">Per ripristinare, copiare il file .json desiderato in <code class="bg-amber-200 px-1 rounded">data/network_manager.json</code></p>
                                        </div>
                                    </div>
                                </details>

                                <details class="bg-slate-50 rounded-lg border border-slate-200">
                                    <summary class="font-semibold text-slate-900 p-3 cursor-pointer hover:bg-slate-100">üõ°Ô∏è Limitare Accesso per IP</summary>
                                    <div class="p-3 pt-0 text-xs text-slate-700">
                                        <p class="mb-2">Per limitare l'accesso solo alla rete interna, modificare <code class="bg-slate-200 px-1 rounded">/etc/apache2/sites-available/000-default.conf</code>:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-green-400 text-xs">
<pre>&lt;Directory /var/www/html/matrix&gt;
    Require ip 192.168.1.0/24
    Require ip 10.0.0.0/8
&lt;/Directory&gt;</pre>
                                        </div>
                                    </div>
                                </details>
                            </div>

                            <!-- Troubleshooting -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üîß Risoluzione Problemi Comuni</h3>
                                
                                <div class="space-y-3 text-xs">
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå Errore 403 Forbidden</p>
                                        <p class="text-red-700">Permessi errati. Eseguire: <code class="bg-red-200 px-1 rounded">sudo chown -R www-data:www-data /var/www/html/matrix</code></p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå Errore 500 Internal Server Error</p>
                                        <p class="text-red-700">Verificare log: <code class="bg-red-200 px-1 rounded">sudo tail -50 /var/log/apache2/error.log</code></p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå Non salva le modifiche</p>
                                        <p class="text-red-700">Cartella data senza permesso di scrittura: <code class="bg-red-200 px-1 rounded">sudo chmod 775 /var/www/html/matrix/data</code></p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå Pagina bianca</p>
                                        <p class="text-red-700">PHP non installato correttamente. Verificare: <code class="bg-red-200 px-1 rounded">php -v</code> e <code class="bg-red-200 px-1 rounded">sudo a2enmod php8.3</code></p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå Login non funziona</p>
                                        <p class="text-red-700">Verificare che il file config.php esista e sia leggibile. Contattare l'amministratore per le credenziali.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Comandi Utili -->
                            <div class="bg-white rounded-lg p-4 border border-orange-200">
                                <h3 class="font-bold text-orange-900 mb-3">üìã Comandi Utili per Amministratori</h3>
                                
                                <div class="bg-slate-900 rounded-lg p-4 font-mono text-sm text-green-400 overflow-x-auto">
<pre><span class="text-slate-500"># Verificare stato Apache</span>
<span class="text-cyan-400">sudo</span> systemctl status apache2

<span class="text-slate-500"># Riavviare Apache (dopo modifiche)</span>
<span class="text-cyan-400">sudo</span> systemctl restart apache2

<span class="text-slate-500"># Vedere log errori Apache</span>
<span class="text-cyan-400">sudo</span> tail -f /var/log/apache2/error.log

<span class="text-slate-500"># Vedere log accessi</span>
<span class="text-cyan-400">sudo</span> tail -f /var/log/apache2/access.log

<span class="text-slate-500"># Verificare permessi cartella matrix</span>
ls -la /var/www/html/matrix/

<span class="text-slate-500"># Verificare spazio disco</span>
df -h /var/www/html/

<span class="text-slate-500"># Verificare versione PHP</span>
php -v

<span class="text-slate-500"># Fare backup manuale dei dati</span>
<span class="text-cyan-400">sudo</span> cp /var/www/html/matrix/data/network_manager.json \
   ~/backup_matrix_$(date +%Y%m%d_%H%M%S).json

<span class="text-slate-500"># Verificare IP del server</span>
ip addr show | grep "inet "</pre>
                                </div>
                            </div>

                            <!-- Supporto -->
                            <div class="bg-gradient-to-r from-blue-100 to-indigo-100 rounded-lg p-4 border border-blue-300">
                                <h3 class="font-bold text-blue-900 mb-2">üìû Supporto</h3>
                                <p class="text-blue-800 text-sm">Per supporto tecnico o domande sull'installazione, contattare il dipartimento IT interno.</p>
                                <div class="mt-3 flex gap-4 text-xs">
                                    <span class="bg-white px-3 py-1 rounded-lg text-blue-700">üìö Versione: 4.1.007</span>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-orange-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 16. CONFIGURAZIONE SISTEMA ========== -->
                    <div class="bg-slate-50 border-l-4 border-slate-500 rounded-r-xl p-5 mb-6" id="help-config">
                        <h2 class="text-xl font-bold text-slate-800 mb-3 flex items-center gap-2">
                            <span class="bg-slate-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">16</span>
                            ‚öôÔ∏è Configurazione del Sistema
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- File di Configurazione -->
                            <div class="bg-white rounded-lg p-4 border border-slate-200">
                                <h3 class="font-bold text-slate-900 mb-2">üìÅ File di Configurazione</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-slate-600 text-white p-2 text-left">File</th><th class="bg-slate-600 text-white p-2 text-left">Posizione</th><th class="bg-slate-600 text-white p-2 text-left">Descrizione</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">.env</code></td><td class="p-2"><code class="text-slate-600">/Matrix/.env</code></td><td class="p-2">Variabili d'ambiente (opzionale)</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">config/config.php</code></td><td class="p-2"><code class="text-slate-600">/Matrix/config/</code></td><td class="p-2">Configurazione server e credenziali admin</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">config/guacamole.json</code></td><td class="p-2"><code class="text-slate-600">/Matrix/config/</code></td><td class="p-2">Configurazione proxy Guacamole (opzionale)</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">server.js</code></td><td class="p-2"><code class="text-slate-600">/Matrix/</code></td><td class="p-2">Server Node.js (backend sviluppo)</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">data/network_manager.json</code></td><td class="p-2"><code class="text-slate-600">/Matrix/data/</code></td><td class="p-2">Database principale (JSON)</td></tr>
                                        <tr><td class="p-2"><code class="bg-slate-200 px-1 rounded">data/online_users.json</code></td><td class="p-2"><code class="text-slate-600">/Matrix/data/</code></td><td class="p-2">Tracking utenti attivi</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Variabili Ambiente -->
                            <div class="bg-white rounded-lg p-4 border border-slate-200">
                                <h3 class="font-bold text-slate-900 mb-2">üîê Variabili d'Ambiente (.env)</h3>
                                <p class="text-slate-700 text-sm mb-3">Il file <code class="bg-slate-200 px-1 rounded">.env</code> contiene configurazioni opzionali per il server Node.js. <strong>Non condividerlo pubblicamente.</strong></p>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-sm text-green-400 mb-3">
<pre>PORT=3000
DATA_FILE=data/network_manager.json
DEBUG_MODE=false
CORS_ORIGINS=http://localhost:3000</pre>
                                </div>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-slate-600 text-white p-2 text-left">Variabile</th><th class="bg-slate-600 text-white p-2 text-left">Default</th><th class="bg-slate-600 text-white p-2 text-left">Descrizione</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">PORT</code></td><td class="p-2">3000</td><td class="p-2">Porta di ascolto del server</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">DATA_FILE</code></td><td class="p-2">data/network_manager.json</td><td class="p-2">Percorso del file dati JSON</td></tr>
                                        <tr class="border-b border-slate-200"><td class="p-2"><code class="bg-slate-200 px-1 rounded">DEBUG_MODE</code></td><td class="p-2">false</td><td class="p-2">Abilita log di debug</td></tr>
                                        <tr><td class="p-2"><code class="bg-slate-200 px-1 rounded">CORS_ORIGINS</code></td><td class="p-2">http://localhost:3000</td><td class="p-2">Origini consentite per CORS</td></tr>
                                    </tbody>
                                </table>
                                <div class="bg-red-50 border border-red-200 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-red-800"><strong>üîí Sicurezza:</strong> Proteggi <code class="bg-red-200 px-1 rounded">.env</code> con <code class="bg-red-200 px-1 rounded">chmod 600 .env</code> e non committarlo in repository pubblici.</p>
                                </div>
                            </div>

                            <!-- Struttura Directory -->
                            <div class="bg-white rounded-lg p-4 border border-slate-200">
                                <h3 class="font-bold text-slate-900 mb-2">üìÇ Struttura delle Cartelle</h3>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre>Matrix/
‚îú‚îÄ‚îÄ index.html              <span class="text-slate-500"># Pagina principale</span>
‚îú‚îÄ‚îÄ server.js               <span class="text-slate-500"># Server Node.js (sviluppo)</span>
‚îú‚îÄ‚îÄ data.php                <span class="text-slate-500"># Endpoint PHP (produzione)</span>
‚îú‚îÄ‚îÄ package.json            <span class="text-slate-500"># Dipendenze NPM</span>
‚îú‚îÄ‚îÄ .env                    <span class="text-slate-500"># Variabili ambiente</span>
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ auth.php            <span class="text-slate-500"># Autenticazione</span>
‚îÇ   ‚îú‚îÄ‚îÄ editlock.php        <span class="text-slate-500"># Edit lock multi-utente</span>
‚îÇ   ‚îî‚îÄ‚îÄ guacamole.php       <span class="text-slate-500"># Proxy Guacamole</span>
‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îú‚îÄ‚îÄ app.js              <span class="text-slate-500"># Core application</span>
‚îÇ   ‚îú‚îÄ‚îÄ auth.js             <span class="text-slate-500"># Auth frontend</span>
‚îÇ   ‚îú‚îÄ‚îÄ ui-updates.js       <span class="text-slate-500"># Rendering UI</span>
‚îÇ   ‚îú‚îÄ‚îÄ device-detail.js    <span class="text-slate-500"># Modal dispositivo</span>
‚îÇ   ‚îú‚îÄ‚îÄ dashboard.js        <span class="text-slate-500"># Dashboard</span>
‚îÇ   ‚îú‚îÄ‚îÄ floorplan.js        <span class="text-slate-500"># Floor plan</span>
‚îÇ   ‚îú‚îÄ‚îÄ features.js         <span class="text-slate-500"># Topologia/export</span>
‚îÇ   ‚îú‚îÄ‚îÄ json-validator.js   <span class="text-slate-500"># Validazione JSON</span>
‚îÇ   ‚îú‚îÄ‚îÄ editlock.js         <span class="text-slate-500"># Edit lock client</span>
‚îÇ   ‚îî‚îÄ‚îÄ icons.js            <span class="text-slate-500"># Icone SVG</span>
‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îî‚îÄ‚îÄ styles.css          <span class="text-slate-500"># Stili principali</span>
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ config.php          <span class="text-slate-500"># Config server + auth</span>
‚îÇ   ‚îî‚îÄ‚îÄ guacamole.json      <span class="text-slate-500"># Config Guacamole</span>
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ network_manager.json <span class="text-slate-500"># DATABASE PRINCIPALE</span>
‚îÇ   ‚îî‚îÄ‚îÄ online_users.json   <span class="text-slate-500"># Utenti attivi</span>
‚îú‚îÄ‚îÄ backup/                 <span class="text-slate-500"># Backup automatici</span>
‚îú‚îÄ‚îÄ assets/                 <span class="text-slate-500"># Icone e immagini</span>
‚îú‚îÄ‚îÄ doc/                    <span class="text-slate-500"># Documentazione tecnica</span>
‚îú‚îÄ‚îÄ tests/                  <span class="text-slate-500"># Test (opzionale)</span>
‚îî‚îÄ‚îÄ scripts/                <span class="text-slate-500"># Script ausiliari</span></pre>
                                </div>
                                <div class="grid md:grid-cols-2 gap-3 text-xs mt-3">
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <span class="font-bold text-red-800">‚ö†Ô∏è Cartelle critiche (NON eliminare):</span>
                                        <ul class="text-red-700 mt-1 ml-3 list-disc">
                                            <li><code class="bg-red-200 px-1 rounded">data/</code> ‚Äî Tutti i dati del sistema</li>
                                            <li><code class="bg-red-200 px-1 rounded">api/</code> ‚Äî API essenziali</li>
                                            <li><code class="bg-red-200 px-1 rounded">js/</code> ‚Äî Script principali</li>
                                            <li><code class="bg-red-200 px-1 rounded">config/</code> ‚Äî Configurazione e credenziali</li>
                                        </ul>
                                    </div>
                                    <div class="bg-green-50 p-3 rounded-lg border border-green-200">
                                        <span class="font-bold text-green-800">‚úÖ Cartelle opzionali:</span>
                                        <ul class="text-green-700 mt-1 ml-3 list-disc">
                                            <li><code class="bg-green-200 px-1 rounded">tests/</code> ‚Äî Rimovibile in produzione</li>
                                            <li><code class="bg-green-200 px-1 rounded">doc/</code> ‚Äî Documentazione dev</li>
                                            <li><code class="bg-green-200 px-1 rounded">scripts/</code> ‚Äî Utilit√†</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Configurazione Server -->
                            <div class="bg-white rounded-lg p-4 border border-slate-200">
                                <h3 class="font-bold text-slate-900 mb-2">üñ•Ô∏è Configurazione del Server</h3>
                                <p class="text-slate-700 text-sm mb-2">Il server Node.js pu√≤ essere personalizzato modificando <code class="bg-slate-200 px-1 rounded">server.js</code>:</p>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 mb-3">
<pre><span class="text-slate-500">// Porta (pu√≤ essere definita via .env)</span>
const PORT = process.env.PORT || 3000;

<span class="text-slate-500">// Timeout richieste (in ms)</span>
const REQUEST_TIMEOUT = 30000; <span class="text-slate-500">// 30 secondi</span>

<span class="text-slate-500">// Dimensione massima payload JSON</span>
const MAX_JSON_SIZE = '50mb';</pre>
                                </div>
                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-2 text-xs">
                                    <p class="text-amber-800">‚ö†Ô∏è Le modifiche a <code class="bg-amber-200 px-1 rounded">server.js</code> richiedono conoscenze di Node.js. Fai sempre backup prima di modificare!</p>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-slate-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 17. SICUREZZA ========== -->
                    <div class="bg-red-50 border-l-4 border-red-600 rounded-r-xl p-5 mb-6" id="help-security">
                        <h2 class="text-xl font-bold text-red-800 mb-3 flex items-center gap-2">
                            <span class="bg-red-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">17</span>
                            üîí Sicurezza
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Autenticazione -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">üîë Autenticazione</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div>
                                        <p class="font-semibold text-red-900 mb-2">Meccanismo corrente:</p>
                                        <ul class="text-red-700 ml-3 list-disc space-y-1">
                                            <li><strong>Storage:</strong> Credenziali in <code class="bg-red-200 px-1 rounded">config/config.php</code></li>
                                            <li><strong>Hash:</strong> bcrypt consigliato per password</li>
                                            <li><strong>Sessione:</strong> Session storage browser</li>
                                            <li><strong>Timeout:</strong> Nessun timeout automatico</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-red-900 mb-2">Hardening raccomandato:</p>
                                        <ol class="text-red-700 ml-3 list-decimal space-y-1">
                                            <li>Password forte: min 12 caratteri</li>
                                            <li>Rotazione ogni 90 giorni</li>
                                            <li><code class="bg-red-200 px-1 rounded">chmod 600 config/config.php</code></li>
                                            <li>1 account = 1 persona</li>
                                        </ol>
                                    </div>
                                </div>
                                <div class="bg-amber-50 border border-amber-200 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-amber-800">‚ö†Ô∏è <strong>Limitazione:</strong> Non c'√® protezione brute-force. Se esposto a internet, usa firewall/VPN/reverse proxy con rate limiting.</p>
                                </div>
                            </div>

                            <!-- Edit Lock -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">üîê Sistema Edit Lock</h3>
                                <p class="text-red-800 text-sm mb-3">Previene conflitti quando pi√π admin modificano contemporaneamente.</p>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-red-600 text-white p-2 text-left">Scenario</th><th class="bg-red-600 text-white p-2 text-left">Risultato</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-red-200"><td class="p-2">Admin A logga, poi Admin B logga</td><td class="p-2">Admin B riceve avviso: "Dati bloccati da Admin A"</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Admin A chiude browser senza logout</td><td class="p-2">Lock scade dopo 5 minuti</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Admin A perde connessione</td><td class="p-2">Lock scade dopo 5 minuti (nessun heartbeat)</td></tr>
                                        <tr><td class="p-2">Admin A fa logout correttamente</td><td class="p-2">Lock rilasciato immediatamente</td></tr>
                                    </tbody>
                                </table>
                                <div class="bg-slate-800 rounded-lg p-3 font-mono text-xs text-green-400 mt-3">
<pre><span class="text-slate-500"># API Edit Lock: /api/editlock.php</span>
GET  ‚Üí { locked: bool, editor: string, remaining: int }
POST { action: 'acquire', editor: 'Admin' } ‚Üí { success: bool }
POST { action: 'release', editor: 'Admin' } ‚Üí { success: bool }
POST { action: 'heartbeat', editor: 'Admin' } ‚Üí { success: bool }</pre>
                                </div>
                            </div>

                            <!-- RBAC -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">üõ°Ô∏è Autorizzazione (RBAC)</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div class="bg-slate-50 p-3 rounded-lg border-l-4 border-slate-400">
                                        <span class="font-bold text-slate-800">üëÅÔ∏è Guest (pubblico)</span>
                                        <ul class="text-slate-600 mt-1 ml-3 list-disc">
                                            <li>Visualizzare tutte le schede</li>
                                            <li>Filtri e ricerca</li>
                                            <li>Export Excel/JSON/PNG</li>
                                            <li>Device Detail (sola lettura)</li>
                                        </ul>
                                    </div>
                                    <div class="bg-green-50 p-3 rounded-lg border-l-4 border-green-500">
                                        <span class="font-bold text-green-800">‚úèÔ∏è Admin (autenticato)</span>
                                        <ul class="text-green-600 mt-1 ml-3 list-disc">
                                            <li>CRUD devices/connections/rooms</li>
                                            <li>Save/Import/Clear All</li>
                                            <li>Links SSH/Telnet visibili</li>
                                            <li>Guacamole access</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Protezione Dati -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">üìú Protezione Dati</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div>
                                        <p class="font-semibold text-red-900 mb-1">Dati sensibili nel sistema:</p>
                                        <ul class="text-red-700 ml-3 list-disc space-y-1">
                                            <li>Indirizzi IP (topologia di rete)</li>
                                            <li>Links SSH/Telnet (accesso dispositivi)</li>
                                            <li>Floor Plan (layout fisico datacenter)</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-red-900 mb-1">Encryption raccomandata:</p>
                                        <ul class="text-red-700 ml-3 list-disc space-y-1">
                                            <li><strong>At rest:</strong> LUKS/dm-crypt filesystem</li>
                                            <li><strong>In transit:</strong> HTTPS con reverse proxy</li>
                                            <li><strong>Backup:</strong> GPG o 7zip con password</li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="bg-red-100 border border-red-300 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-red-800">‚ö†Ô∏è <strong>MAI</strong> inserire password nel campo Notes! Usa un password manager separato (KeePass, Bitwarden).</p>
                                </div>
                            </div>

                            <!-- Best Practices -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">‚úÖ Best Practices di Sicurezza</h3>
                                <div class="grid md:grid-cols-2 gap-3 text-xs">
                                    <div>
                                        <p class="font-semibold text-red-900 mb-1">üåê Rete:</p>
                                        <ul class="text-red-700 ml-3 list-disc space-y-1">
                                            <li>Firewall: limita porta 3000 alla rete interna</li>
                                            <li>VPN per accesso remoto</li>
                                            <li>Reverse proxy con rate limiting</li>
                                            <li>IP whitelist</li>
                                        </ul>
                                    </div>
                                    <div>
                                        <p class="font-semibold text-red-900 mb-1">üñ•Ô∏è Applicazione:</p>
                                        <ul class="text-red-700 ml-3 list-disc space-y-1">
                                            <li>HTTPS obbligatorio in produzione</li>
                                            <li>Security headers attivi</li>
                                            <li>Processo Node.js NON root</li>
                                            <li>Aggiornamenti regolari</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <!-- Compliance Checklist -->
                            <div class="bg-white rounded-lg p-4 border border-red-200">
                                <h3 class="font-bold text-red-900 mb-2">üìä Compliance Checklist</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-red-600 text-white p-2 text-left">Requisito</th><th class="bg-red-600 text-white p-2 text-left">Stato</th><th class="bg-red-600 text-white p-2 text-left">Azione</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-red-200"><td class="p-2">Access Control</td><td class="p-2">‚ö†Ô∏è Parziale</td><td class="p-2">Implementare MFA</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Audit Trail</td><td class="p-2">‚úÖ Completo</td><td class="p-2">Gi√† OK</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Encryption (rest)</td><td class="p-2">‚ùå Mancante</td><td class="p-2">Filesystem encryption</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Encryption (transit)</td><td class="p-2">‚ùå HTTP only</td><td class="p-2">Implementare HTTPS</td></tr>
                                        <tr class="border-b border-red-200"><td class="p-2">Backup/Recovery</td><td class="p-2">‚úÖ Automatico</td><td class="p-2">Testare restore</td></tr>
                                        <tr><td class="p-2">Incident Response</td><td class="p-2">‚ùå Nessuno</td><td class="p-2">Creare piano IR</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <a href="#help-index" class="text-red-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 18. MANUTENZIONE ========== -->
                    <div class="bg-amber-50 border-l-4 border-amber-500 rounded-r-xl p-5 mb-6" id="help-maintenance">
                        <h2 class="text-xl font-bold text-amber-800 mb-3 flex items-center gap-2">
                            <span class="bg-amber-500 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">18</span>
                            üî® Manutenzione e Amministrazione
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Backup e Restore -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üíæ Strategia di Backup</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-amber-600 text-white p-2 text-left">Tipo</th><th class="bg-amber-600 text-white p-2 text-left">Frequenza</th><th class="bg-amber-600 text-white p-2 text-left">Metodo</th><th class="bg-amber-600 text-white p-2 text-left">Retention</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-amber-200"><td class="p-2"><strong>Manuale</strong></td><td class="p-2">Prima di modifiche importanti</td><td class="p-2">Export JSON</td><td class="p-2">Permanente</td></tr>
                                        <tr class="border-b border-amber-200"><td class="p-2"><strong>Automatico</strong></td><td class="p-2">Ogni Save Now</td><td class="p-2">backup/*.json</td><td class="p-2">30 giorni</td></tr>
                                        <tr><td class="p-2"><strong>Pianificato</strong></td><td class="p-2">Settimanale/Mensile</td><td class="p-2">Script cron + API</td><td class="p-2">90 giorni</td></tr>
                                    </tbody>
                                </table>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-blue-800"><strong>3-2-1 Rule:</strong> 3 copie, 2 supporti diversi, 1 offsite. Testa il restore almeno trimestralmente!</p>
                                </div>
                            </div>

                            <!-- Script Backup -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üìã Script Backup Automatico</h3>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre><span class="text-slate-500">#!/bin/bash</span>
<span class="text-slate-500"># /etc/cron.daily/matrix-backup.sh</span>

BACKUP_DIR="/backups/matrix"
DATE=$(date +%Y%m%d_%H%M%S)
RETENTION_DAYS=90

mkdir -p "$BACKUP_DIR"

<span class="text-slate-500"># Download da API</span>
curl -s http://localhost:3000/data > "$BACKUP_DIR/matrix_$DATE.json"

<span class="text-slate-500"># Verifica file non vuoto</span>
if [ -s "$BACKUP_DIR/matrix_$DATE.json" ]; then
    echo "Backup OK: matrix_$DATE.json"
    find "$BACKUP_DIR" -name "matrix_*.json" -mtime +$RETENTION_DAYS -delete
else
    echo "ERRORE: Backup fallito!"
    rm -f "$BACKUP_DIR/matrix_$DATE.json"
    exit 1
fi</pre>
                                </div>
                            </div>

                            <!-- Restore -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üîÑ Restore da Backup</h3>
                                <ol class="text-amber-800 text-sm space-y-1 list-decimal ml-4">
                                    <li>Prima: export corrente come ulteriore sicurezza</li>
                                    <li>Entra in Edit Mode</li>
                                    <li>Clicca <strong>üì• Import JSON</strong></li>
                                    <li>Seleziona il file backup da ripristinare</li>
                                    <li>Il sistema valida e importa</li>
                                    <li>Verifica dati caricati correttamente</li>
                                    <li>Clicca <strong>üíæ Save Now</strong> per confermare</li>
                                </ol>
                            </div>

                            <!-- Monitoring -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üìä Monitoring</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-amber-600 text-white p-2 text-left">Metrica</th><th class="bg-amber-600 text-white p-2 text-left">Comando</th><th class="bg-amber-600 text-white p-2 text-left">Soglia Alert</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-amber-200"><td class="p-2">Server uptime</td><td class="p-2"><code class="bg-amber-200 px-1 rounded">pm2 status matrix</code></td><td class="p-2">Status ‚â† online</td></tr>
                                        <tr class="border-b border-amber-200"><td class="p-2">Memoria</td><td class="p-2"><code class="bg-amber-200 px-1 rounded">pm2 monit</code></td><td class="p-2">&gt; 500MB</td></tr>
                                        <tr class="border-b border-amber-200"><td class="p-2">Errori server</td><td class="p-2"><code class="bg-amber-200 px-1 rounded">pm2 logs --err</code></td><td class="p-2">&gt; 10/ora</td></tr>
                                        <tr class="border-b border-amber-200"><td class="p-2">File JSON size</td><td class="p-2"><code class="bg-amber-200 px-1 rounded">du -h data/*.json</code></td><td class="p-2">&gt; 20MB</td></tr>
                                        <tr><td class="p-2">Backup falliti</td><td class="p-2">Check log script</td><td class="p-2">1+ fallimento</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- Health Check Script -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">ü©∫ Script Health Check</h3>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre><span class="text-slate-500">#!/bin/bash</span>
<span class="text-slate-500"># matrix-healthcheck.sh</span>

ERRORS=0

<span class="text-slate-500"># Check API responsive</span>
if ! curl -s http://localhost:3000/data > /dev/null; then
    echo "ERROR: API non risponde!"; ((ERRORS++))
fi

<span class="text-slate-500"># Check file JSON readable</span>
if [ ! -r data/network_manager.json ]; then
    echo "ERROR: File JSON non leggibile!"; ((ERRORS++))
fi

<span class="text-slate-500"># Check disk space</span>
DISK=$(df -h / | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK -gt 90 ]; then
    echo "WARNING: Disco >90%"; ((ERRORS++))
fi

[ $ERRORS -eq 0 ] && echo "OK" || echo "FAIL: $ERRORS problemi"

<span class="text-slate-500"># Crontab: */5 * * * * /path/matrix-healthcheck.sh</span></pre>
                                </div>
                            </div>

                            <!-- Aggiornamenti -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">‚¨ÜÔ∏è Come Aggiornare</h3>
                                <ol class="text-amber-800 text-xs space-y-1 list-decimal ml-4">
                                    <li><strong>BACKUP:</strong> Export JSON + copia directory Matrix/</li>
                                    <li>Download nuova versione</li>
                                    <li>Stop server: <code class="bg-amber-200 px-1 rounded">pm2 stop matrix</code></li>
                                    <li>Backup vecchia: <code class="bg-amber-200 px-1 rounded">mv Matrix Matrix_old</code></li>
                                    <li>Estrai nuova versione</li>
                                    <li>Copia dati: <code class="bg-amber-200 px-1 rounded">cp Matrix_old/data/*.json Matrix/data/</code></li>
                                    <li>Copia config: <code class="bg-amber-200 px-1 rounded">cp Matrix_old/config/* Matrix/config/</code></li>
                                    <li>Installa: <code class="bg-amber-200 px-1 rounded">cd Matrix && npm install</code></li>
                                    <li>Start: <code class="bg-amber-200 px-1 rounded">pm2 start server.js --name matrix</code></li>
                                    <li>Verifica nel browser. Se problemi: rollback con Matrix_old/</li>
                                </ol>
                            </div>

                            <!-- Cleanup -->
                            <div class="bg-white rounded-lg p-4 border border-amber-200">
                                <h3 class="font-bold text-amber-900 mb-2">üßπ Pulizia e Ottimizzazione</h3>
                                <div class="bg-slate-800 rounded-lg p-3 font-mono text-xs text-green-400">
<pre><span class="text-slate-500"># Cleanup backup &gt; 30 giorni</span>
find backup/ -name "*.json" -mtime +30 -delete

<span class="text-slate-500"># Rotazione logs PM2</span>
pm2 flush matrix

<span class="text-slate-500"># Contare backup presenti</span>
ls -1 backup/*.json 2>/dev/null | wc -l</pre>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-green-800">‚úÖ <strong>Best Practice:</strong> Manutenzione mensile ‚Äî backup verification, health check, cleanup logs, review dispositivi obsoleti.</p>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-amber-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 19. RIFERIMENTO TECNICO ========== -->
                    <div class="bg-gray-50 border-l-4 border-gray-600 rounded-r-xl p-5 mb-6" id="help-techref">
                        <h2 class="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                            <span class="bg-gray-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">19</span>
                            üìö Riferimento Tecnico
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Schema JSON -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üìù Schema JSON ‚Äî network_manager.json</h3>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre>{
  "devices": [{
    "id": 1, "name": "SW-CORE-01", "type": "switch",
    "status": "active", "location": "Sala Server",
    "rackId": "RACK-01", "order": 1, "isRear": false,
    "brandModel": "Cisco C9300-48P",
    "service": "Core Switch", "notes": "...",
    "addresses": [{ "network": "192.168.1.10/24", "ip": "", "vlan": 10, "zone": "LAN" }],
    "ports": [{ "name": "eth01", "type": "eth", "status": "active" }],
    "links": [{ "type": "ssh", "url": "192.168.1.10", "label": "SSH" }]
  }],
  "connections": [{
    "id": "c-6da15bd9356d", "from": 1, "fromPort": "eth01",
    "to": 2, "toPort": "eth24", "type": "lan", "status": "active",
    "cableMarker": "CAB-A001", "cableColor": "#3b82f6",
    "notes": "", "externalDest": "", "isWallJack": false,
    "wallJackType": "", "roomId": null, "flagged": false, "flagReason": ""
  }],
  "rooms": [{
    "id": "8", "name": "8", "nickname": "Sala Server",
    "type": "server", "area": 50, "capacity": 20,
    "color": "rgba(239,68,68,0.15)",
    "polygon": [{"x":760,"y":281}, {"x":1010,"y":281}, {"x":1010,"y":521}, {"x":760,"y":521}]
  }],
  "sites": ["Sede Ivrea"],
  "locations": [{
    "id": 1, "siteId": null, "code": "DC01",
    "name": "Data Center", "type": "site",
    "roomRef": "8", "color": "#3b82f6"
  }],
  "nextDeviceId": 102, "nextLocationId": 21
}</pre>
                                </div>
                            </div>

                            <!-- Device Types -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üì± Tipi Dispositivo (17)</h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-xs">
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üñ•Ô∏è</span> <code>server</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üîÄ</span> <code>switch</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üì°</span> <code>router</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üì°</span> <code>router_wifi</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üß±</span> <code>firewall</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üì∂</span> <code>access_point</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üîå</span> <code>patch</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üîå</span> <code>walljack</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üîå</span> <code>walljack_tel</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üñ•Ô∏è</span> <code>workstation</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üíª</span> <code>laptop</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üñ®Ô∏è</span> <code>printer</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üì∑</span> <code>camera</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üì∫</span> <code>tv</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üîã</span> <code>ups</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>‚òéÔ∏è</span> <code>ip_phone</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>üåç</span> <code>isp</code></div>
                                    <div class="bg-gray-50 p-2 rounded flex items-center gap-2"><span>‚ùì</span> <code>other</code></div>
                                </div>
                            </div>

                            <!-- Connection Types -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">‚ö° Tipi Connessione (18)</h3>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2 text-xs">
                                    <div class="p-2 rounded text-white" style="background:#22c55e">lan ‚Äî Rete locale</div>
                                    <div class="p-2 rounded text-white" style="background:#f59e0b">wan ‚Äî Internet/WAN</div>
                                    <div class="p-2 rounded text-white" style="background:#ef4444">dmz ‚Äî Zona DMZ</div>
                                    <div class="p-2 rounded text-white" style="background:#3b82f6">vlan ‚Äî Virtual LAN</div>
                                    <div class="p-2 rounded text-white" style="background:#8b5cf6">trunk ‚Äî Trunk link</div>
                                    <div class="p-2 rounded text-white" style="background:#0ea5e9">vpn ‚Äî VPN tunnel</div>
                                    <div class="p-2 rounded text-white" style="background:#06b6d4">cloud ‚Äî Cloud</div>
                                    <div class="p-2 rounded text-white" style="background:#06b6d4">management ‚Äî Gestione</div>
                                    <div class="p-2 rounded text-white" style="background:#8b5cf6">servers ‚Äî Rete server</div>
                                    <div class="p-2 rounded text-white" style="background:#a855f7">iot ‚Äî IoT</div>
                                    <div class="p-2 rounded text-white" style="background:#f97316">guest ‚Äî Ospiti</div>
                                    <div class="p-2 rounded" style="background:#eab308">voice ‚Äî VoIP</div>
                                    <div class="p-2 rounded text-white" style="background:#78716c">backup ‚Äî Backup</div>
                                    <div class="p-2 rounded text-white" style="background:#06b6d4">fiber ‚Äî Fibra</div>
                                    <div class="p-2 rounded text-white" style="background:#ec4899">test ‚Äî Test/Lab</div>
                                    <div class="p-2 rounded text-white" style="background:#64748b">wallport ‚Äî Presa muro</div>
                                    <div class="p-2 rounded text-white" style="background:#94a3b8">external ‚Äî Esterno</div>
                                    <div class="p-2 rounded text-white" style="background:#64748b">other ‚Äî Altro</div>
                                </div>
                            </div>

                            <!-- Status -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üîÑ Status (Devices e Connections)</h3>
                                <div class="flex gap-3 text-sm">
                                    <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full font-bold">active</span>
                                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full font-bold">disabled</span>
                                    <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full font-bold">maintenance</span>
                                </div>
                            </div>

                            <!-- API Reference -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üîó Endpoint API</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-gray-600 text-white p-2 text-left">Endpoint</th><th class="bg-gray-600 text-white p-2 text-left">Metodo</th><th class="bg-gray-600 text-white p-2 text-left">Descrizione</th><th class="bg-gray-600 text-white p-2 text-left">Auth</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">/data</code></td><td class="p-2">GET</td><td class="p-2">Ottieni tutti i dati</td><td class="p-2">No</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">/data</code></td><td class="p-2">POST</td><td class="p-2">Salva tutti i dati</td><td class="p-2">S√¨</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">/data?action=online</code></td><td class="p-2">GET</td><td class="p-2">Utenti attivi</td><td class="p-2">No</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">/api/auth.php</code></td><td class="p-2">POST</td><td class="p-2">Login/Logout/Session</td><td class="p-2">No</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">/api/editlock.php</code></td><td class="p-2">GET/POST</td><td class="p-2">Edit lock multi-utente</td><td class="p-2">S√¨</td></tr>
                                        <tr><td class="p-2"><code class="bg-gray-200 px-1 rounded">/api/guacamole.php</code></td><td class="p-2">GET/POST</td><td class="p-2">Proxy Guacamole</td><td class="p-2">S√¨</td></tr>
                                    </tbody>
                                </table>
                            </div>

                            <!-- API Examples -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üíª Esempi API</h3>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre><span class="text-slate-500">// GET dati</span>
fetch('/data').then(r => r.json())
  .then(data => console.log(data.devices.length + ' dispositivi'));

<span class="text-slate-500">// POST salva dati</span>
fetch('/data', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    action: 'save',
    data: { devices, connections, rooms, sites, locations,
            nextDeviceId: 102, nextLocationId: 21 }
  })
});

<span class="text-slate-500">// Login</span>
fetch('/api/auth.php', {
  method: 'POST',
  body: JSON.stringify({ action: 'login', username: 'admin', password: '...' })
});

<span class="text-slate-500">// Utenti online</span>
fetch('/data?action=online').then(r => r.json());</pre>
                                </div>
                            </div>

                            <!-- File Critici -->
                            <div class="bg-white rounded-lg p-4 border border-gray-200">
                                <h3 class="font-bold text-gray-900 mb-2">üìÅ File Critici</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-gray-600 text-white p-2 text-left">File</th><th class="bg-gray-600 text-white p-2 text-left">Scopo</th><th class="bg-gray-600 text-white p-2 text-left">Backup?</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">data/network_manager.json</code></td><td class="p-2">Database dispositivi/connessioni/rooms</td><td class="p-2 font-bold text-red-600">‚úÖ CRITICO</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">data/online_users.json</code></td><td class="p-2">Tracking utenti attivi</td><td class="p-2">‚úÖ Raccomandato</td></tr>
                                        <tr class="border-b border-gray-200"><td class="p-2"><code class="bg-gray-200 px-1 rounded">config/config.php</code></td><td class="p-2">Credenziali e config server</td><td class="p-2">‚úÖ Raccomandato</td></tr>
                                        <tr><td class="p-2"><code class="bg-gray-200 px-1 rounded">backup/*.json</code></td><td class="p-2">Backup automatici</td><td class="p-2">‚úÖ Gi√† backup</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <a href="#help-index" class="text-gray-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== 20. GUACAMOLE (ACCESSO REMOTO) ========== -->
                    <div class="bg-emerald-50 border-l-4 border-emerald-600 rounded-r-xl p-5 mb-6" id="help-guacamole">
                        <h2 class="text-xl font-bold text-emerald-800 mb-3 flex items-center gap-2">
                            <span class="bg-emerald-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm">20</span>
                            üñ•Ô∏è Apache Guacamole ‚Äî Accesso Remoto
                        </h2>
                        
                        <div class="space-y-4">
                            <!-- Panoramica -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üìã Panoramica</h3>
                                <p class="text-emerald-800 text-sm mb-3">Matrix si integra con <strong>Apache Guacamole</strong> per accedere ai dispositivi via SSH, RDP, VNC e Telnet direttamente dal browser, senza bisogno di client installati.</p>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 mb-3">
<pre>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Matrix Web    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ guacamole.php   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   Guacamole     ‚îÇ
‚îÇ   (Browser)     ‚îÇ     ‚îÇ   (API Proxy)   ‚îÇ     ‚îÇ   (Docker)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                        ‚îÇ
                                                        ‚ñº
                                                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                                ‚îÇ  guacd + SSH    ‚îÇ
                                                ‚îÇ  RDP/VNC/Telnet ‚îÇ
                                                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</pre>
                                </div>
                                <div class="bg-blue-50 border border-blue-200 rounded-lg p-2 text-xs">
                                    <p class="text-blue-800">üí° <strong>Opzionale:</strong> Guacamole non √® necessario per il funzionamento base di Matrix. √à un'integrazione aggiuntiva per l'accesso remoto.</p>
                                </div>
                            </div>

                            <!-- Installazione Docker -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-3">üê≥ Installazione Guacamole (Docker)</h3>
                                
                                <div class="space-y-3">
                                    <div class="bg-slate-50 rounded-lg p-3 border-l-4 border-emerald-400">
                                        <p class="font-semibold text-emerald-900 text-sm mb-2">1. Preparare le directory:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-xs text-green-400">
<pre><span class="text-cyan-400">sudo</span> mkdir -p /opt/guacamole/{init,data}
<span class="text-cyan-400">sudo</span> chmod 777 /opt/guacamole/init</pre>
                                        </div>
                                    </div>

                                    <div class="bg-slate-50 rounded-lg p-3 border-l-4 border-emerald-400">
                                        <p class="font-semibold text-emerald-900 text-sm mb-2">2. Creare docker-compose.yml:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-xs text-green-400 overflow-x-auto">
<pre><span class="text-slate-500">version: '3.8'</span>

services:
  guacd:
    image: guacamole/guacd
    container_name: guacd
    restart: always
    networks: [guac-network]

  postgres:
    image: postgres:13
    container_name: guac-postgres
    restart: always
    environment:
      POSTGRES_USER: guacamole
      POSTGRES_PASSWORD: guacamole_password
      POSTGRES_DB: guacamole_db
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - /opt/guacamole/init:/docker-entrypoint-initdb.d
    networks: [guac-network]

  guacamole:
    image: guacamole/guacamole
    container_name: guacamole
    restart: always
    depends_on: [guacd, postgres]
    environment:
      GUACD_HOSTNAME: guacd
      POSTGRES_HOSTNAME: postgres
      POSTGRES_DATABASE: guacamole_db
      POSTGRES_USER: guacamole
      POSTGRES_PASSWORD: guacamole_password
    ports: ["8080:8080"]
    networks: [guac-network]

networks:
  guac-network:
volumes:
  postgres-data:</pre>
                                        </div>
                                    </div>

                                    <div class="bg-slate-50 rounded-lg p-3 border-l-4 border-emerald-400">
                                        <p class="font-semibold text-emerald-900 text-sm mb-2">3. Generare schema database e avviare:</p>
                                        <div class="bg-slate-800 rounded p-2 font-mono text-xs text-green-400">
<pre><span class="text-slate-500"># Generare schema PostgreSQL</span>
docker run --rm guacamole/guacamole \
  /opt/guacamole/bin/initdb.sh --postgresql \
  > /opt/guacamole/init/initdb.sql

<span class="text-slate-500"># Avviare tutti i servizi</span>
docker-compose up -d

<span class="text-slate-500"># Verificare stato</span>
docker ps</pre>
                                        </div>
                                    </div>

                                    <div class="bg-green-50 border border-green-200 rounded-lg p-3 text-xs">
                                        <p class="font-semibold text-green-900 mb-1">‚úÖ Verifica installazione:</p>
                                        <p class="text-green-700">Accedi a <code class="bg-green-200 px-1 rounded">http://IP_SERVER:8080/guacamole</code>. Login predefinito: <code class="bg-green-200 px-1 rounded">guacadmin</code> / <code class="bg-green-200 px-1 rounded">guacadmin</code></p>
                                    </div>
                                </div>
                            </div>

                            <!-- Configurazione Utenti Guacamole -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-3">üë• Configurazione Utenti Guacamole</h3>
                                <p class="text-emerald-800 text-sm mb-3">Matrix utilizza <strong>due utenti separati</strong> per motivi di sicurezza:</p>
                                
                                <div class="grid md:grid-cols-2 gap-3 mb-3">
                                    <div class="bg-orange-50 p-3 rounded-lg border border-orange-200 text-xs">
                                        <span class="font-bold text-orange-800">üîß Utente Admin ‚Äî <code class="bg-orange-200 px-1 rounded">tiesse</code></span>
                                        <p class="text-orange-700 mt-1 mb-2">Usato dall'API per <strong>creare</strong> le connessioni.</p>
                                        <ul class="text-orange-600 ml-3 list-disc space-y-1">
                                            <li>‚úÖ Tutte le permissioni admin abilitate</li>
                                            <li>‚úÖ Pu√≤ creare/modificare/eliminare connessioni</li>
                                            <li>‚úÖ Password: definita dall'admin di sistema</li>
                                        </ul>
                                    </div>
                                    <div class="bg-blue-50 p-3 rounded-lg border border-blue-200 text-xs">
                                        <span class="font-bold text-blue-800">üëÅÔ∏è Utente Viewer ‚Äî <code class="bg-blue-200 px-1 rounded">matrix-user</code></span>
                                        <p class="text-blue-700 mt-1 mb-2">Usato nel browser per <strong>aprire</strong> le connessioni.</p>
                                        <ul class="text-blue-600 ml-3 list-disc space-y-1">
                                            <li>‚ùå Nessuna permissione admin</li>
                                            <li>‚úÖ Solo READ sulle connessioni</li>
                                            <li>‚úÖ Non vede il pannello admin</li>
                                        </ul>
                                    </div>
                                </div>

                                <details class="bg-slate-50 rounded-lg border border-slate-200">
                                    <summary class="font-semibold text-slate-900 p-3 cursor-pointer hover:bg-slate-100 text-sm">üìã Passi dettagliati per creare gli utenti</summary>
                                    <div class="p-3 pt-0 text-xs text-slate-700 space-y-3">
                                        <div>
                                            <p class="font-bold text-slate-900 mb-1">Creare utente Admin (tiesse):</p>
                                            <ol class="ml-4 list-decimal space-y-1">
                                                <li>Accedi a Guacamole come <code class="bg-slate-200 px-1 rounded">guacadmin</code></li>
                                                <li><strong>Settings</strong> ‚Üí <strong>Users</strong> ‚Üí <strong>New User</strong></li>
                                                <li>Username: <code class="bg-slate-200 px-1 rounded">tiesse</code>, Password: (scegli una sicura)</li>
                                                <li>Abilita TUTTE le permissioni admin</li>
                                                <li><strong>Save</strong></li>
                                            </ol>
                                        </div>
                                        <div>
                                            <p class="font-bold text-slate-900 mb-1">Creare utente Viewer (matrix-user):</p>
                                            <ol class="ml-4 list-decimal space-y-1">
                                                <li><strong>Settings</strong> ‚Üí <strong>Users</strong> ‚Üí <strong>New User</strong></li>
                                                <li>Username: <code class="bg-slate-200 px-1 rounded">matrix-user</code>, Password: (scegli una sicura)</li>
                                                <li>‚ö†Ô∏è <strong>DISABILITA TUTTE</strong> le permissioni admin!</li>
                                                <li><strong>Save</strong></li>
                                                <li>Rientra in <strong>Users</strong> ‚Üí <code class="bg-slate-200 px-1 rounded">matrix-user</code> ‚Üí tab <strong>Connections</strong></li>
                                                <li>Abilita <strong>READ</strong> su tutte le connessioni</li>
                                                <li><strong>Save</strong></li>
                                            </ol>
                                        </div>
                                    </div>
                                </details>

                                <div class="bg-red-50 border border-red-300 rounded-lg p-2 mt-3 text-xs">
                                    <p class="text-red-800">‚ö†Ô∏è <strong>Importante:</strong> Dopo aver creato <code class="bg-red-200 px-1 rounded">tiesse</code>, elimina o disabilita l'utente <code class="bg-red-200 px-1 rounded">guacadmin</code> predefinito per sicurezza!</p>
                                </div>
                            </div>

                            <!-- Configurazione Matrix -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-3">‚öôÔ∏è Configurazione in Matrix</h3>
                                <p class="text-emerald-800 text-sm mb-2">File: <code class="bg-emerald-200 px-1 rounded">config/guacamole.json</code></p>
                                <div class="bg-slate-800 rounded-lg p-4 font-mono text-xs text-green-400 overflow-x-auto">
<pre>{
  <span class="text-yellow-300">"enabled"</span>: true,

  <span class="text-yellow-300">"server"</span>: {
    <span class="text-yellow-300">"baseUrl"</span>: <span class="text-cyan-300">"http://IP_GUACAMOLE:8080/guacamole"</span>
  },

  <span class="text-yellow-300">"credentials"</span>: {
    <span class="text-slate-500">// Admin ‚Äî usato per CREARE connessioni</span>
    <span class="text-yellow-300">"username"</span>: <span class="text-cyan-300">"tiesse"</span>,
    <span class="text-yellow-300">"password"</span>: <span class="text-cyan-300">"[password admin]"</span>
  },

  <span class="text-yellow-300">"viewerCredentials"</span>: {
    <span class="text-slate-500">// Viewer ‚Äî usato per APRIRE connessioni (senza admin)</span>
    <span class="text-yellow-300">"username"</span>: <span class="text-cyan-300">"matrix-user"</span>,
    <span class="text-yellow-300">"password"</span>: <span class="text-cyan-300">"[password viewer]"</span>
  },

  <span class="text-yellow-300">"defaults"</span>: {
    <span class="text-yellow-300">"ssh"</span>:    { "port": 22,   "colorScheme": "green-black", "fontSize": 14 },
    <span class="text-yellow-300">"rdp"</span>:    { "port": 3389, "security": "any", "ignoreCert": true },
    <span class="text-yellow-300">"telnet"</span>: { "port": 23,   "colorScheme": "green-black" },
    <span class="text-yellow-300">"vnc"</span>:    { "port": 5900, "colorDepth": 24 }
  }
}</pre>
                                </div>
                            </div>

                            <!-- API Endpoints -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üîó API Endpoints Guacamole</h3>
                                <table class="w-full text-xs border-collapse">
                                    <thead>
                                        <tr><th class="bg-emerald-600 text-white p-2 text-left">Azione</th><th class="bg-emerald-600 text-white p-2 text-left">Endpoint</th><th class="bg-emerald-600 text-white p-2 text-left">Descrizione</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr class="border-b border-emerald-200"><td class="p-2">Status</td><td class="p-2"><code class="bg-emerald-200 px-1 rounded">GET /api/guacamole.php?action=status</code></td><td class="p-2">Stato del servizio</td></tr>
                                        <tr class="border-b border-emerald-200"><td class="p-2">Connetti</td><td class="p-2"><code class="bg-emerald-200 px-1 rounded">POST /api/guacamole.php</code></td><td class="p-2">Crea/apri connessione SSH/RDP/VNC</td></tr>
                                        <tr class="border-b border-emerald-200"><td class="p-2">Health</td><td class="p-2"><code class="bg-emerald-200 px-1 rounded">GET /api/guacamole.php?action=health</code></td><td class="p-2">Health check</td></tr>
                                        <tr><td class="p-2">Versione</td><td class="p-2"><code class="bg-emerald-200 px-1 rounded">GET /api/guacamole.php?action=version</code></td><td class="p-2">Versione API proxy</td></tr>
                                    </tbody>
                                </table>
                                <div class="bg-slate-800 rounded-lg p-3 font-mono text-xs text-green-400 mt-3">
<pre><span class="text-slate-500">// Esempio: connettere via SSH</span>
fetch('/api/guacamole.php', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    action: 'connect',
    ip: '10.10.254.121',
    protocol: 'ssh',
    deviceName: 'SW-CORE-01'
  })
});</pre>
                                </div>
                            </div>

                            <!-- Porte -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üåê Porte di Rete Necessarie</h3>
                                <div class="grid grid-cols-2 md:grid-cols-5 gap-2 text-xs text-center">
                                    <div class="bg-emerald-100 p-2 rounded-lg"><span class="font-bold text-emerald-800">8080</span><br><span class="text-emerald-600">Guacamole Web</span></div>
                                    <div class="bg-blue-100 p-2 rounded-lg"><span class="font-bold text-blue-800">22</span><br><span class="text-blue-600">SSH</span></div>
                                    <div class="bg-purple-100 p-2 rounded-lg"><span class="font-bold text-purple-800">3389</span><br><span class="text-purple-600">RDP</span></div>
                                    <div class="bg-orange-100 p-2 rounded-lg"><span class="font-bold text-orange-800">5900</span><br><span class="text-orange-600">VNC</span></div>
                                    <div class="bg-slate-100 p-2 rounded-lg"><span class="font-bold text-slate-800">23</span><br><span class="text-slate-600">Telnet</span></div>
                                </div>
                            </div>

                            <!-- Troubleshooting -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üîß Risoluzione Problemi</h3>
                                <div class="space-y-2 text-xs">
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå "Authentication failed"</p>
                                        <p class="text-red-700">Verifica credenziali in <code class="bg-red-200 px-1 rounded">config/guacamole.json</code>. Testa login manualmente su <code class="bg-red-200 px-1 rounded">http://IP:8080/guacamole</code>.</p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå "Connection already exists"</p>
                                        <p class="text-red-700">La connessione esiste gi√† con altro nome. Il sistema la cerca automaticamente. Se persiste, elimina la connessione in Guacamole.</p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå "Could not connect"</p>
                                        <p class="text-red-700">Verifica: <code class="bg-red-200 px-1 rounded">docker ps</code> (guacd attivo?), <code class="bg-red-200 px-1 rounded">telnet IP PORTA</code> (connettivit√†?)</p>
                                    </div>
                                    <div class="bg-red-50 p-3 rounded-lg border border-red-200">
                                        <p class="font-bold text-red-900 mb-1">‚ùå L'utente vede il pannello admin</p>
                                        <p class="text-red-700"><code class="bg-red-200 px-1 rounded">matrix-user</code> √® mal configurato: verifica che TUTTE le permissioni admin siano disabilitate e che <code class="bg-red-200 px-1 rounded">viewerCredentials</code> sia presente nel JSON.</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Logs -->
                            <div class="bg-white rounded-lg p-4 border border-emerald-200">
                                <h3 class="font-bold text-emerald-900 mb-2">üìã Log Utili</h3>
                                <div class="bg-slate-800 rounded-lg p-3 font-mono text-xs text-green-400">
<pre><span class="text-slate-500"># Log API Proxy (Apache)</span>
tail -f /var/log/apache2/error.log | grep Guac

<span class="text-slate-500"># Log Guacamole (Docker)</span>
docker logs guacamole -f
docker logs guacd -f</pre>
                                </div>
                            </div>
                        </div>
                        <a href="#help-index" class="text-emerald-600 text-xs mt-3 inline-block hover:underline">‚Üë Torna all'indice</a>
                    </div>

                    <!-- ========== FOOTER ========== -->
                    <div class="text-center text-slate-400 text-xs py-4 border-t border-slate-200 mt-6">
                        <p class="font-semibold text-slate-600">¬© 2026 Tiesse S.P.A. ‚Äî All rights reserved</p>
                        <p class="mt-1">TIESSE Matrix Network v4.1.007</p>
                        <p class="mt-2 text-red-500 font-medium">‚ö†Ô∏è Confidential document ‚Äî Reproduction prohibited ‚Äî For internal use only</p>
                    </div>
                </div>
            </div>

            <!-- Tab: SVG Topology with Cisco Icons -->
            <div id="content-drawio" class="tab-content">
                <!-- Title -->
                <div class="mb-3">
                    <h2 class="text-lg font-bold text-slate-800">üó∫Ô∏è Network Topology</h2>
                    <p class="text-xs text-slate-500 italic">Visualizza graficamente la topologia della rete.</p>
                </div>
                <!-- Controls -->
                <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                    <!-- Left: Stats + Filters -->
                    <div class="flex items-center gap-2 flex-wrap">
                        <div id="topologyStats" class="flex items-center gap-2 text-xs">
                            <!-- Stats populated by JS -->
                        </div>
                        <!-- Filters -->
                        <select id="topologyLocationFilter" onchange="filterTopologyByLocation()" class="px-2 py-1 border-2 border-slate-400 rounded-lg text-xs bg-slate-50 font-semibold text-slate-800">
                            <option value="">üìç All Locations</option>
                        </select>
                        <select id="topologyRackFilter" onchange="filterTopologyByRack()" class="px-2 py-1 border border-slate-300 rounded-lg text-xs">
                            <option value="">üóÇÔ∏è All Groups</option>
                        </select>
                        <select id="drawioLayout" onchange="updateDrawioLayout()" class="px-2 py-1 border border-slate-300 rounded-lg text-xs">
                            <option value="auto">Auto Layout</option>
                            <option value="circle">Circle</option>
                            <option value="grid">Grid</option>
                            <option value="hierarchical">Hierarchical</option>
                        </select>
                        
                        <!-- Zoom/Fit Controls -->
                        <div class="flex items-center gap-1 border-l border-slate-300 pl-2">
                            <button onclick="fitDrawioView()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Fit to View">üó∫Ô∏è Fit</button>
                            <button onclick="showTopologyLegend()" class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Show Legend">üìã Legend</button>
                        </div>
                        
                        <!-- Export Actions -->
                        <div class="flex items-center gap-1 border-l border-slate-300 pl-2">
                            <button onclick="printTopology()" class="bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Print Topology">üñ®Ô∏è Print</button>
                            <button onclick="exportDrawioPNG()" class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Export as PNG">üì∑ PNG</button>
                            <button onclick="exportTopologyDrawio()" class="bg-orange-500 hover:bg-orange-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" title="Export as .drawio">üì• Drawio</button>
                        </div>
                    </div>
                </div>
                <div id="drawioContainer" class="border border-slate-200 rounded-xl bg-white" style="height: calc(100vh - 220px); min-height: 500px; width: 100%; overflow: hidden; position: relative;">
                    <div class="flex items-center justify-center h-full text-slate-400">
                        <p>Loading topology visualization...</p>
                    </div>
                </div>

                <!-- Tip - Compact version -->
                <p class="mt-2 text-xs text-blue-600 no-print">üí° Drag devices to reposition ‚Ä¢ Export .drawio for <span class="text-blue-700 font-semibold">diagrams.net</span> ‚Ä¢ PNG includes title & date</p>
            </div>

            <!-- Tab 6: Activity Logs -->
            <div id="content-logs" class="tab-content">
                <!-- Title -->
                <div class="mb-3">
                    <h2 class="text-lg font-bold text-slate-800">üìã Activity Logs</h2>
                    <p class="text-xs text-slate-500 italic">Last 200 changes</p>
                </div>
                <!-- Controls -->
                <div class="flex items-center justify-between gap-2 mb-3 no-print flex-wrap">
                    <div></div>
                    <div class="flex items-center gap-2">
                        <select id="logFilter" onchange="filterLogs()" class="px-2 py-1 border border-slate-300 rounded-lg text-xs">
                            <option value="">All Activities</option>
                            <option value="device">Devices</option>
                            <option value="connection">Connections</option>
                            <option value="import">Import/Export</option>
                            <option value="auth">Authentication</option>
                        </select>
                        <button onclick="clearLogs()" class="edit-mode-only bg-red-500 hover:bg-red-600 text-white font-semibold py-1 px-2 rounded-lg text-xs" style="display:none;">
                            üóëÔ∏è Clear Logs
                        </button>
                        <button onclick="exportLogs()" class="bg-slate-500 hover:bg-slate-600 text-white font-semibold py-1 px-2 rounded-lg text-xs">
                            üì• Export Logs
                        </button>
                    </div>
                </div>
                <div id="logsContainer" class="border border-slate-200 rounded-xl overflow-hidden">
                    <table class="w-full text-sm">
                        <thead class="bg-slate-100">
                            <tr>
                                <th class="px-3 py-2 text-left font-semibold text-slate-700 w-40">Timestamp</th>
                                <th class="px-3 py-2 text-left font-semibold text-slate-700 w-24">Action</th>
                                <th class="px-3 py-2 text-left font-semibold text-slate-700 w-24">Type</th>
                                <th class="px-3 py-2 text-left font-semibold text-slate-700">Details</th>
                                <th class="px-3 py-2 text-left font-semibold text-slate-700 w-24">User</th>
                            </tr>
                        </thead>
                        <tbody id="logsTableBody" class="divide-y divide-slate-100">
                            <tr><td colspan="5" class="px-3 py-8 text-center text-slate-400">No logs yet</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm mx-4">
            <div class="text-center mb-6">
                <h2 class="text-xl font-bold text-slate-800">üîê Edit Mode Access</h2>
                <p class="text-sm text-slate-500 mt-1">Enter your credentials to edit</p>
            </div>
            <form id="loginForm" onsubmit="Auth.handleLoginSubmit(event)">
                <div class="space-y-4">
                    <div>
                        <label for="loginUsername" class="block text-sm font-medium text-slate-700 mb-1">Username</label>
                        <input type="text" id="loginUsername" name="username" required autocomplete="username"
                            class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div>
                        <label for="loginPassword" class="block text-sm font-medium text-slate-700 mb-1">Password</label>
                        <input type="password" id="loginPassword" name="password" required autocomplete="current-password"
                            class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                    </div>
                    <div id="loginError" class="text-red-500 text-sm text-center hidden"></div>
                </div>
                <div class="flex gap-3 mt-6">
                    <button type="button" onclick="Auth.hideLoginModal()"
                        class="flex-1 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold py-2 px-4 rounded-lg">
                        Cancel
                    </button>
                    <button type="submit" id="loginSubmitBtn"
                        class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg">
                        Login
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Legend Modal -->
    <div id="legendModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" onclick="closeLegendModal(event)">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-[90vw] max-w-6xl max-h-[90vh] overflow-y-auto mx-4" onclick="event.stopPropagation()">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-slate-800">üìã Network Topology Overview</h2>
                <button onclick="closeLegendModal()" class="text-slate-400 hover:text-slate-600 text-3xl font-bold leading-none">&times;</button>
            </div>
            <div id="legendModalContent">
                <!-- Content will be populated by JS -->
            </div>
        </div>
    </div>

    <!-- Device Detail Modal -->
    <div id="deviceDetailModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" onclick="DeviceDetail.close(event)">
        <div class="bg-white rounded-2xl shadow-2xl w-[95vw] max-w-5xl max-h-[90vh] overflow-hidden mx-4" onclick="event.stopPropagation()">
            <!-- Header -->
            <div id="deviceDetailHeader" class="bg-gradient-to-r from-slate-800 to-slate-700 text-white p-4">
                <!-- Populated by JS -->
            </div>
            <!-- Content -->
            <div id="deviceDetailContent" class="p-4 overflow-y-auto" style="max-height: calc(90vh - 180px);">
                <!-- Populated by JS -->
            </div>
            <!-- Port Detail Bar -->
            <div id="deviceDetailPortBar" class="bg-slate-100 border-t border-slate-200 p-3 text-sm text-slate-600 hidden">
                <span id="deviceDetailPortInfo">Click on a port to see details</span>
            </div>
        </div>
    </div>

    <!-- Load external JavaScript modules with cache-buster -->
    <script src="js/default-data.js?v=4.1.007"></script>
    <script src="js/editlock.js?v=4.1.007"></script>
    <script src="js/auth.js?v=4.1.007"></script>
    <script src="js/app.js?v=4.1.007"></script>
    <script src="js/ui-updates.js?v=4.1.007"></script>
    <script src="js/recovery.js?v=4.1.007"></script>
    <script src="js/features.js?v=4.1.007"></script>
    <script src="js/floorplan.js?v=4.1.007"></script>
    <script src="js/json-validator.js?v=4.1.007"></script>
    <script src="js/dashboard.js?v=4.1.007"></script>
    <script src="js/device-detail.js?v=4.1.007"></script>
    
    <!-- Update connections count when list lists -->
    <script>
        (function() {
            var origUpdateConnList = window.updateConnectionsList;
            window.updateConnectionsList = function() {
                origUpdateConnList.apply(this, arguments);
                var countEl = document.getElementById('connectionsCount');
                if (countEl && window.appState) {
                    countEl.textContent = appState.connections.length;
                }
                // Update location filter
                if (typeof LocationFilter !== 'undefined') {
                    LocationFilter.update();
                }
            };
            
            var origUpdateDevList = window.updateDevicesList;
            window.updateDevicesList = function() {
                origUpdateDevList.apply(this, arguments);
                // Update location filter
                if (typeof LocationFilter !== 'undefined') {
                    LocationFilter.update();
                }
            };
        })();
    </script>

<!-- ============================================================ -->
<!-- ICON PICKER MODAL                                            -->
<!-- ============================================================ -->
<div id="iconPickerOverlay" class="fixed inset-0 bg-black/70 backdrop-blur-sm z-[9999] hidden flex items-center justify-center" onclick="if(event.target===this)closeIconPicker()">
    <div class="bg-slate-900 rounded-2xl shadow-2xl border border-slate-700 w-[95vw] max-w-5xl max-h-[90vh] flex flex-col overflow-hidden">
        <!-- Header -->
        <div class="flex items-center justify-between px-6 py-4 bg-slate-800 border-b border-slate-700">
            <div>
                <h2 class="text-xl font-bold text-sky-400">üé® Icon Picker</h2>
                <p class="text-xs text-slate-400 mt-1">Click any icon to copy ‚Ä¢ Use it in chat or code</p>
            </div>
            <div class="flex items-center gap-3">
                <input type="text" id="iconPickerSearch" placeholder="üîç Search icon..." oninput="filterPickerIcons()"
                    class="px-3 py-1.5 rounded-lg border border-slate-600 bg-slate-700 text-slate-200 text-sm w-56 outline-none focus:border-sky-500">
                <button onclick="closeIconPicker()" class="text-slate-400 hover:text-white text-2xl font-bold leading-none px-2" title="Close">&times;</button>
            </div>
        </div>
        <!-- Content -->
        <div class="overflow-y-auto p-6 space-y-6" id="iconPickerContent">
            <!-- Current types section -->
            <div class="bg-slate-800 rounded-xl p-4 border-2 border-blue-600">
                <h3 class="text-blue-400 font-semibold mb-3 text-sm">üìã Current Device Types (25)</h3>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2" id="pickerCurrentGrid"></div>
            </div>
            <!-- Category sections will be injected here -->
            <div id="pickerCategorySections"></div>
        </div>
        <!-- Toast -->
        <div id="pickerToast" class="fixed bottom-8 left-1/2 -translate-x-1/2 bg-emerald-500 text-white px-6 py-3 rounded-lg font-bold text-sm z-[10000] hidden shadow-lg shadow-emerald-500/30"></div>
    </div>
</div>

<script>
// ‚îÄ‚îÄ Icon Picker Data & Logic ‚îÄ‚îÄ
(function() {
    var currentTypes = [
        { emoji: 'üì°', code: 'RT', type: 'router' },
        { emoji: 'üîÄ', code: 'SW', type: 'switch' },
        { emoji: 'üìå', code: 'PP', type: 'patch' },
        { emoji: 'üîå', code: 'WJ', type: 'walljack (RJ45)' },
        { emoji: 'üîå', code: 'WJ-TEL', type: 'walljack_tel (RJ11)' },
        { emoji: 'üß±', code: 'FW', type: 'firewall' },
        { emoji: 'üñ•Ô∏è', code: 'SRV', type: 'server' },
        { emoji: 'üì∂', code: 'AP', type: 'wifi' },
        { emoji: 'üåê', code: 'ISP', type: 'isp' },
        { emoji: 'üì∂', code: 'RTW', type: 'router_wifi' },
        { emoji: 'üì†', code: 'MOD', type: 'modem' },
        { emoji: 'üîò', code: 'HUB', type: 'hub' },
        { emoji: '‚ö°', code: 'POE', type: 'poe' },
        { emoji: 'üíª', code: 'PC', type: 'pc' },
        { emoji: 'üì±', code: 'TAB', type: 'tablet' },
        { emoji: '‚òéÔ∏è', code: 'IP-PHO', type: 'ip_phone' },
        { emoji: 'üñ®Ô∏è', code: 'PRN', type: 'printer' },
        { emoji: 'üß∞', code: 'NAS', type: 'nas' },
        { emoji: 'üìπ', code: 'CAM', type: 'camera' },
        { emoji: 'üìº', code: 'DVR', type: 'dvr' },
        { emoji: 'üîã', code: 'UPS', type: 'ups' },
        { emoji: 'üå°Ô∏è', code: 'IOT', type: 'iot' },
        { emoji: 'üß™', code: 'TST', type: 'tst' },
        { emoji: 'üì∫', code: 'TV', type: 'tv' },
        { emoji: 'üì¶', code: 'GEN', type: 'others' }
    ];

    var categories = [
        // ‚îÄ‚îÄ 1. NETWORK / CONNECTORS ‚îÄ‚îÄ
        {
            name: 'üîå Network / Connectors',
            icons: [
                { emoji: 'üîå', name: 'plug' }, { emoji: 'üîó', name: 'link' }, { emoji: 'üåê', name: 'globe' },
                { emoji: 'üì°', name: 'satellite' }, { emoji: 'üì∂', name: 'signal' }, { emoji: 'üõú', name: 'wifi' },
                { emoji: 'üîÄ', name: 'shuffle' }, { emoji: 'üîÅ', name: 'repeat' }, { emoji: 'üîÉ', name: 'sync' },
                { emoji: 'üîÑ', name: 'refresh' }, { emoji: '‚ÜîÔ∏è', name: 'left-right' }, { emoji: '‚ÜïÔ∏è', name: 'up-down' },
                { emoji: 'üìå', name: 'pin' }, { emoji: 'üìç', name: 'location' }, { emoji: 'üß≤', name: 'magnet' },
                { emoji: 'üè∑Ô∏è', name: 'tag' }, { emoji: 'ü™ù', name: 'hook' }, { emoji: '‚õìÔ∏è', name: 'chain' },
                { emoji: 'üñáÔ∏è', name: 'linked clips' }, { emoji: 'üìé', name: 'paperclip' }, { emoji: 'ü™¢', name: 'knot' }
            ]
        },
        // ‚îÄ‚îÄ 2. PHONE / COMMUNICATION ‚îÄ‚îÄ
        {
            name: 'üìû Phone / Communication',
            icons: [
                { emoji: 'üìû', name: 'telephone' }, { emoji: '‚òéÔ∏è', name: 'classic phone' }, { emoji: 'üì±', name: 'mobile' },
                { emoji: 'üì≤', name: 'incoming' }, { emoji: 'ü§ô', name: 'call me' }, { emoji: 'üì≥', name: 'vibration' },
                { emoji: 'üì¥', name: 'phone off' }, { emoji: 'üìµ', name: 'no phone' }, { emoji: 'üí¨', name: 'speech' },
                { emoji: 'üí≠', name: 'thought' }, { emoji: 'üóØÔ∏è', name: 'anger bubble' }, { emoji: 'üó®Ô∏è', name: 'left speech' },
                { emoji: 'üì†', name: 'fax' }, { emoji: 'üìü', name: 'pager' }, { emoji: 'üîî', name: 'bell' },
                { emoji: 'üîï', name: 'bell off' }, { emoji: 'üéôÔ∏è', name: 'studio mic' }, { emoji: 'üé§', name: 'microphone' },
                { emoji: 'üì¢', name: 'loudspeaker' }, { emoji: 'üì£', name: 'megaphone' }, { emoji: 'üîä', name: 'volume up' },
                { emoji: 'üîâ', name: 'volume mid' }, { emoji: 'üîà', name: 'volume low' }, { emoji: 'üîá', name: 'mute' }
            ]
        },
        // ‚îÄ‚îÄ 3. COMPUTERS / HARDWARE ‚îÄ‚îÄ
        {
            name: 'üñ•Ô∏è Computers / Hardware',
            icons: [
                { emoji: 'üñ•Ô∏è', name: 'desktop' }, { emoji: 'üíª', name: 'laptop' }, { emoji: 'üñ±Ô∏è', name: 'mouse' },
                { emoji: '‚å®Ô∏è', name: 'keyboard' }, { emoji: 'üñ®Ô∏è', name: 'printer' }, { emoji: 'üñ≤Ô∏è', name: 'trackball' },
                { emoji: 'üíæ', name: 'floppy' }, { emoji: 'üíø', name: 'CD' }, { emoji: 'üìÄ', name: 'DVD' },
                { emoji: 'üóÑÔ∏è', name: 'file cabinet' }, { emoji: '‚åö', name: 'watch' }, { emoji: 'üì∫', name: 'TV' },
                { emoji: 'üìª', name: 'radio' }, { emoji: 'üéÆ', name: 'gamepad' }, { emoji: 'üïπÔ∏è', name: 'joystick' },
                { emoji: 'üé∞', name: 'slot machine' }, { emoji: 'üßÆ', name: 'abacus' }, { emoji: 'üíΩ', name: 'minidisc' },
                { emoji: 'üìº', name: 'videocassette' }, { emoji: 'üîå', name: 'power plug' }
            ]
        },
        // ‚îÄ‚îÄ 4. SECURITY / PROTECTION ‚îÄ‚îÄ
        {
            name: 'üõ°Ô∏è Security / Protection',
            icons: [
                { emoji: 'üõ°Ô∏è', name: 'shield' }, { emoji: 'üîí', name: 'locked' }, { emoji: 'üîì', name: 'unlocked' },
                { emoji: 'üîê', name: 'locked+key' }, { emoji: 'üîë', name: 'key' }, { emoji: 'üóùÔ∏è', name: 'old key' },
                { emoji: 'üëÅÔ∏è', name: 'eye' }, { emoji: 'üëÅÔ∏è‚Äçüó®Ô∏è', name: 'eye speech' }, { emoji: 'üö®', name: 'alarm' },
                { emoji: '‚ö†Ô∏è', name: 'warning' }, { emoji: 'üö´', name: 'prohibited' }, { emoji: '‚ùå', name: 'error' },
                { emoji: '‚úÖ', name: 'check' }, { emoji: 'üî•', name: 'fire' }, { emoji: 'üß±', name: 'brick wall' },
                { emoji: 'üõë', name: 'stop' }, { emoji: 'ü™£', name: 'ID card' }, { emoji: 'üîè', name: 'lock pen' },
                { emoji: '‚õî', name: 'no entry' }, { emoji: 'üö∑', name: 'no pedestrian' }, { emoji: 'üìõ', name: 'name badge' },
                { emoji: 'üÜî', name: 'ID symbol' }, { emoji: 'üî∞', name: 'beginner' }
            ]
        },
        // ‚îÄ‚îÄ 5. POWER / ENERGY ‚îÄ‚îÄ
        {
            name: 'üîã Power / Energy',
            icons: [
                { emoji: 'üîã', name: 'battery' }, { emoji: 'ü™´', name: 'battery low' }, { emoji: '‚ö°', name: 'lightning' },
                { emoji: 'üîå', name: 'plug' }, { emoji: 'üí°', name: 'light bulb' }, { emoji: 'üî¶', name: 'flashlight' },
                { emoji: 'üïØÔ∏è', name: 'candle' }, { emoji: '‚òÄÔ∏è', name: 'sun' }, { emoji: 'üå§Ô∏è', name: 'sun cloud' },
                { emoji: '‚öôÔ∏è', name: 'gear' }, { emoji: 'üîß', name: 'wrench' }, { emoji: 'üõ†Ô∏è', name: 'tools' },
                { emoji: 'üèóÔ∏è', name: 'construction' }, { emoji: 'ü™õ', name: 'screwdriver' }, { emoji: 'ü™ú', name: 'ladder' },
                { emoji: 'üßØ', name: 'fire extinguisher' }
            ]
        },
        // ‚îÄ‚îÄ 6. IoT / SENSORS / SMART ‚îÄ‚îÄ
        {
            name: 'üå°Ô∏è IoT / Sensors / Smart',
            icons: [
                { emoji: 'üå°Ô∏è', name: 'thermometer' }, { emoji: 'üíß', name: 'droplet' }, { emoji: 'üåä', name: 'wave' },
                { emoji: 'üå¨Ô∏è', name: 'wind' }, { emoji: 'üß≠', name: 'compass' }, { emoji: 'ü§ñ', name: 'robot' },
                { emoji: 'üß†', name: 'brain/AI' }, { emoji: 'üìä', name: 'bar chart' }, { emoji: 'üìà', name: 'chart up' },
                { emoji: 'üìâ', name: 'chart down' }, { emoji: 'üéõÔ∏è', name: 'control knobs' }, { emoji: 'üïê', name: 'clock 1' },
                { emoji: '‚è±Ô∏è', name: 'stopwatch' }, { emoji: '‚è≤Ô∏è', name: 'timer' }, { emoji: 'üåç', name: 'globe EU' },
                { emoji: 'üåé', name: 'globe US' }, { emoji: 'üåè', name: 'globe AS' }, { emoji: 'üõ∞Ô∏è', name: 'satellite' },
                { emoji: 'üßä', name: 'ice/cooling' }, { emoji: '‚ô®Ô∏è', name: 'hot springs' }, { emoji: 'üå™Ô∏è', name: 'tornado' },
                { emoji: 'ü´ß', name: 'bubbles' }
            ]
        },
        // ‚îÄ‚îÄ 7. VIDEO / CCTV / CAMERA ‚îÄ‚îÄ
        {
            name: 'üìº Video / CCTV / Camera',
            icons: [
                { emoji: 'üìπ', name: 'video cam' }, { emoji: 'üé•', name: 'movie cam' }, { emoji: 'üì∑', name: 'camera' },
                { emoji: 'üì∏', name: 'camera flash' }, { emoji: 'üìº', name: 'videotape' }, { emoji: 'üé¨', name: 'clapperboard' },
                { emoji: 'üì∫', name: 'television' }, { emoji: 'üñ•Ô∏è', name: 'monitor' }, { emoji: 'üîç', name: 'magnifier L' },
                { emoji: 'üîé', name: 'magnifier R' }, { emoji: 'üëÅÔ∏è', name: 'eye' }, { emoji: 'üéûÔ∏è', name: 'film frames' },
                { emoji: 'üìΩÔ∏è', name: 'projector' }, { emoji: 'üî≠', name: 'telescope' }
            ]
        },
        // ‚îÄ‚îÄ 8. LAB / TEST / MAINTENANCE ‚îÄ‚îÄ
        {
            name: 'üß™ Lab / Test / Maintenance',
            icons: [
                { emoji: 'üß™', name: 'test tube' }, { emoji: 'üî¨', name: 'microscope' }, { emoji: 'üß´', name: 'petri dish' },
                { emoji: 'üß¨', name: 'DNA' }, { emoji: '‚öóÔ∏è', name: 'alembic' }, { emoji: 'üõ†Ô∏è', name: 'tools' },
                { emoji: 'üîß', name: 'wrench' }, { emoji: 'üî©', name: 'nut bolt' }, { emoji: '‚öôÔ∏è', name: 'gear' },
                { emoji: 'üè∑Ô∏è', name: 'tag' }, { emoji: 'üìã', name: 'clipboard' }, { emoji: 'üìù', name: 'memo' },
                { emoji: '‚úèÔ∏è', name: 'pencil' }, { emoji: 'üóÇÔ∏è', name: 'dividers' }, { emoji: 'üìÅ', name: 'folder' },
                { emoji: 'üìÇ', name: 'folder open' }, { emoji: 'üóëÔ∏è', name: 'trash' }, { emoji: 'üßπ', name: 'broom' },
                { emoji: 'ü™†', name: 'plunger' }, { emoji: 'üßΩ', name: 'sponge' }, { emoji: 'ü™£', name: 'bucket' }
            ]
        },
        // ‚îÄ‚îÄ 9. BUILDINGS / PLACES ‚îÄ‚îÄ
        {
            name: 'üè¢ Buildings / Places',
            icons: [
                { emoji: 'üè†', name: 'house' }, { emoji: 'üè°', name: 'garden house' }, { emoji: 'üè¢', name: 'office' },
                { emoji: 'üè£', name: 'post office JP' }, { emoji: 'üè§', name: 'post office EU' }, { emoji: 'üè•', name: 'hospital' },
                { emoji: 'üè¶', name: 'bank' }, { emoji: 'üè®', name: 'hotel' }, { emoji: 'üè©', name: 'love hotel' },
                { emoji: 'üè™', name: 'store' }, { emoji: 'üè´', name: 'school' }, { emoji: 'üè¨', name: 'department' },
                { emoji: 'üè≠', name: 'factory' }, { emoji: 'üèóÔ∏è', name: 'construction' }, { emoji: 'üèõÔ∏è', name: 'classical' },
                { emoji: 'üèöÔ∏è', name: 'derelict' }, { emoji: 'üèòÔ∏è', name: 'houses' }, { emoji: '‚õ™', name: 'church' },
                { emoji: 'üïå', name: 'mosque' }, { emoji: 'üïç', name: 'synagogue' }, { emoji: '‚õ©Ô∏è', name: 'shrine' },
                { emoji: 'üè∞', name: 'castle' }, { emoji: 'üèØ', name: 'JP castle' }, { emoji: 'üóº', name: 'tower' },
                { emoji: 'üóΩ', name: 'statue liberty' }, { emoji: '‚õ≤', name: 'fountain' }, { emoji: '‚õ∫', name: 'tent' },
                { emoji: 'üé™', name: 'circus tent' }, { emoji: 'üèüÔ∏è', name: 'stadium' }, { emoji: 'üé°', name: 'ferris wheel' },
                { emoji: 'üé¢', name: 'roller coaster' }, { emoji: 'üé†', name: 'carousel' }, { emoji: 'üõñ', name: 'hut' },
                { emoji: 'üõï', name: 'hindu temple' }, { emoji: 'ü™®', name: 'rock' }, { emoji: 'üèïÔ∏è', name: 'camping' },
                { emoji: 'üåâ', name: 'bridge night' }, { emoji: 'üåÅ', name: 'foggy' }, { emoji: 'üåÉ', name: 'night stars' },
                { emoji: 'üåÜ', name: 'cityscape dusk' }, { emoji: 'üåá', name: 'sunset' }, { emoji: 'üåÑ', name: 'sunrise mt' },
                { emoji: 'üåÖ', name: 'sunrise' }, { emoji: 'üèôÔ∏è', name: 'cityscape' }
            ]
        },
        // ‚îÄ‚îÄ 10. OFFICE / STATIONERY ‚îÄ‚îÄ
        {
            name: 'üìö Office / Stationery',
            icons: [
                { emoji: 'üìö', name: 'books' }, { emoji: 'üìñ', name: 'open book' }, { emoji: 'üìï', name: 'red book' },
                { emoji: 'üìó', name: 'green book' }, { emoji: 'üìò', name: 'blue book' }, { emoji: 'üìô', name: 'orange book' },
                { emoji: 'üìì', name: 'notebook' }, { emoji: 'üìí', name: 'ledger' }, { emoji: 'üìÉ', name: 'page curl' },
                { emoji: 'üìÑ', name: 'page up' }, { emoji: 'üìë', name: 'bookmark tabs' }, { emoji: 'üîñ', name: 'bookmark' },
                { emoji: 'üì∞', name: 'newspaper' }, { emoji: 'üóûÔ∏è', name: 'rolled news' }, { emoji: 'üìã', name: 'clipboard' },
                { emoji: 'üìù', name: 'memo' }, { emoji: '‚úèÔ∏è', name: 'pencil' }, { emoji: 'üñäÔ∏è', name: 'pen' },
                { emoji: 'üñãÔ∏è', name: 'fountain pen' }, { emoji: '‚úíÔ∏è', name: 'nib' }, { emoji: 'üñçÔ∏è', name: 'crayon' },
                { emoji: 'üìè', name: 'ruler' }, { emoji: 'üìê', name: 'triangle ruler' }, { emoji: '‚úÇÔ∏è', name: 'scissors' },
                { emoji: 'üóÉÔ∏è', name: 'card box' }, { emoji: 'üóÑÔ∏è', name: 'cabinet' }, { emoji: 'üóÇÔ∏è', name: 'dividers' },
                { emoji: 'üìÅ', name: 'folder' }, { emoji: 'üìÇ', name: 'folder open' }, { emoji: 'üóíÔ∏è', name: 'spiral note' },
                { emoji: 'üóìÔ∏è', name: 'spiral calendar' }, { emoji: 'üìÖ', name: 'calendar' }, { emoji: 'üìÜ', name: 'tear-off cal' },
                { emoji: 'üó≥Ô∏è', name: 'ballot box' }, { emoji: 'üó∫Ô∏è', name: 'world map' }, { emoji: 'üìá', name: 'card index' },
                { emoji: 'üìà', name: 'chart up' }, { emoji: 'üìâ', name: 'chart down' }, { emoji: 'üìä', name: 'bar chart' }
            ]
        },
        // ‚îÄ‚îÄ 11. MAIL / POSTAL ‚îÄ‚îÄ
        {
            name: '‚úâÔ∏è Mail / Postal',
            icons: [
                { emoji: '‚úâÔ∏è', name: 'envelope' }, { emoji: 'üìß', name: 'e-mail' }, { emoji: 'üì®', name: 'incoming mail' },
                { emoji: 'üì©', name: 'envelope arrow' }, { emoji: 'üì§', name: 'outbox' }, { emoji: 'üì•', name: 'inbox' },
                { emoji: 'üì¶', name: 'package' }, { emoji: 'üì´', name: 'mailbox raised' }, { emoji: 'üì™', name: 'mailbox low' },
                { emoji: 'üì¨', name: 'mailbox open hi' }, { emoji: 'üì≠', name: 'mailbox open lo' }, { emoji: 'üìÆ', name: 'postbox' },
                { emoji: 'üè∑Ô∏è', name: 'label' }, { emoji: 'üè¥', name: 'black flag' }, { emoji: 'üö©', name: 'red flag' },
                { emoji: 'üèÅ', name: 'checkered flag' }, { emoji: 'üéå', name: 'crossed flags' }
            ]
        },
        // ‚îÄ‚îÄ 12. MONEY / COMMERCE ‚îÄ‚îÄ
        {
            name: 'üí∞ Money / Commerce',
            icons: [
                { emoji: 'üí∞', name: 'money bag' }, { emoji: 'üíµ', name: 'dollar' }, { emoji: 'üí∂', name: 'euro' },
                { emoji: 'üí∑', name: 'pound' }, { emoji: 'üí¥', name: 'yen' }, { emoji: 'üí∏', name: 'money wings' },
                { emoji: 'üí≥', name: 'credit card' }, { emoji: 'ü™ô', name: 'coin' }, { emoji: 'üíπ', name: 'chart yen' },
                { emoji: 'üí±', name: 'exchange' }, { emoji: 'üßæ', name: 'receipt' }, { emoji: 'üõí', name: 'cart' },
                { emoji: 'üõçÔ∏è', name: 'shopping bag' }, { emoji: 'üè™', name: 'store' }, { emoji: 'üè¶', name: 'bank' },
                { emoji: 'üíé', name: 'gem' }, { emoji: 'üé´', name: 'ticket' }, { emoji: 'üéüÔ∏è', name: 'admission' }
            ]
        },
        // ‚îÄ‚îÄ 13. TIME / CLOCKS ‚îÄ‚îÄ
        {
            name: '‚è∞ Time / Clocks',
            icons: [
                { emoji: 'üïê', name: '1:00' }, { emoji: 'üïë', name: '2:00' }, { emoji: 'üïí', name: '3:00' },
                { emoji: 'üïì', name: '4:00' }, { emoji: 'üïî', name: '5:00' }, { emoji: 'üïï', name: '6:00' },
                { emoji: 'üïñ', name: '7:00' }, { emoji: 'üïó', name: '8:00' }, { emoji: 'üïò', name: '9:00' },
                { emoji: 'üïô', name: '10:00' }, { emoji: 'üïö', name: '11:00' }, { emoji: 'üïõ', name: '12:00' },
                { emoji: 'üïú', name: '1:30' }, { emoji: 'üïù', name: '2:30' }, { emoji: 'üïû', name: '3:30' },
                { emoji: 'üïü', name: '4:30' }, { emoji: 'üï†', name: '5:30' }, { emoji: 'üï°', name: '6:30' },
                { emoji: 'üï¢', name: '7:30' }, { emoji: 'üï£', name: '8:30' }, { emoji: 'üï§', name: '9:30' },
                { emoji: 'üï•', name: '10:30' }, { emoji: 'üï¶', name: '11:30' }, { emoji: 'üïß', name: '12:30' },
                { emoji: '‚è∞', name: 'alarm clock' }, { emoji: '‚è±Ô∏è', name: 'stopwatch' }, { emoji: '‚è≤Ô∏è', name: 'timer' },
                { emoji: '‚åõ', name: 'hourglass' }, { emoji: '‚è≥', name: 'hourglass flow' }, { emoji: 'üï∞Ô∏è', name: 'mantle clock' }
            ]
        },
        // ‚îÄ‚îÄ 14. MUSIC / SOUND ‚îÄ‚îÄ
        {
            name: 'üéµ Music / Sound',
            icons: [
                { emoji: 'üéµ', name: 'music note' }, { emoji: 'üé∂', name: 'music notes' }, { emoji: 'üéº', name: 'score' },
                { emoji: 'üéπ', name: 'piano' }, { emoji: 'üé∏', name: 'guitar' }, { emoji: 'üé∫', name: 'trumpet' },
                { emoji: 'üéª', name: 'violin' }, { emoji: 'üé∑', name: 'saxophone' }, { emoji: 'ü™ï', name: 'banjo' },
                { emoji: 'ü•Å', name: 'drum' }, { emoji: 'ü™ò', name: 'long drum' }, { emoji: 'ü™ó', name: 'accordion' },
                { emoji: 'üéß', name: 'headphone' }, { emoji: 'üéôÔ∏è', name: 'studio mic' }, { emoji: 'üéöÔ∏è', name: 'level slider' },
                { emoji: 'üéõÔ∏è', name: 'control knobs' }, { emoji: 'üìØ', name: 'postal horn' }, { emoji: 'üîî', name: 'bell' },
                { emoji: 'üîï', name: 'bell off' }, { emoji: 'üìª', name: 'radio' }, { emoji: 'ü™à', name: 'flute' },
                { emoji: 'ü™á', name: 'maracas' }
            ]
        },
        // ‚îÄ‚îÄ 15. NATURE / WEATHER ‚îÄ‚îÄ
        {
            name: 'üå≥ Nature / Weather',
            icons: [
                { emoji: 'üå≥', name: 'tree' }, { emoji: 'üå≤', name: 'evergreen' }, { emoji: 'üå¥', name: 'palm' },
                { emoji: 'üåµ', name: 'cactus' }, { emoji: 'üåø', name: 'herb' }, { emoji: '‚òòÔ∏è', name: 'shamrock' },
                { emoji: 'üçÄ', name: '4-leaf clover' }, { emoji: 'üéç', name: 'bamboo' }, { emoji: 'üéã', name: 'tanabata' },
                { emoji: 'üçÉ', name: 'leaf wind' }, { emoji: 'üçÇ', name: 'fallen leaf' }, { emoji: 'üçÅ', name: 'maple leaf' },
                { emoji: 'üåæ', name: 'rice' }, { emoji: 'üå±', name: 'seedling' }, { emoji: 'ü™¥', name: 'potted plant' },
                { emoji: 'üåπ', name: 'rose' }, { emoji: 'üå∫', name: 'hibiscus' }, { emoji: 'üåª', name: 'sunflower' },
                { emoji: 'üåº', name: 'blossom' }, { emoji: 'üå∏', name: 'cherry blossom' }, { emoji: 'üíê', name: 'bouquet' },
                { emoji: 'üå∑', name: 'tulip' }, { emoji: 'ü´ã', name: 'hyacinth' }, { emoji: 'ü™∑', name: 'lotus' },
                { emoji: 'üçÑ', name: 'mushroom' }, { emoji: 'üå∞', name: 'chestnut' }, { emoji: 'ü™µ', name: 'wood' },
                { emoji: '‚òÄÔ∏è', name: 'sun' }, { emoji: 'üå§Ô∏è', name: 'sun+cloud' }, { emoji: '‚õÖ', name: 'partly cloudy' },
                { emoji: 'üå•Ô∏è', name: 'sun behind cloud' }, { emoji: '‚òÅÔ∏è', name: 'cloud' }, { emoji: 'üå¶Ô∏è', name: 'sun rain' },
                { emoji: 'üåßÔ∏è', name: 'rain' }, { emoji: '‚õàÔ∏è', name: 'thunder rain' }, { emoji: 'üå©Ô∏è', name: 'lightning cloud' },
                { emoji: 'üå®Ô∏è', name: 'snow cloud' }, { emoji: '‚ùÑÔ∏è', name: 'snowflake' }, { emoji: '‚òÉÔ∏è', name: 'snowman' },
                { emoji: '‚õÑ', name: 'snowman no snow' }, { emoji: 'üå™Ô∏è', name: 'tornado' }, { emoji: 'üå´Ô∏è', name: 'fog' },
                { emoji: 'üåà', name: 'rainbow' }, { emoji: '‚òî', name: 'umbrella rain' }, { emoji: 'üí®', name: 'dash wind' },
                { emoji: 'üåä', name: 'wave' }, { emoji: 'üíß', name: 'droplet' }, { emoji: 'üí¶', name: 'sweat drops' },
                { emoji: 'üî•', name: 'fire' }, { emoji: '‚≠ê', name: 'star' }, { emoji: 'üåü', name: 'glow star' },
                { emoji: 'üí´', name: 'dizzy star' }, { emoji: '‚ú®', name: 'sparkles' }, { emoji: '‚òÑÔ∏è', name: 'comet' },
                { emoji: 'üåô', name: 'crescent moon' }, { emoji: 'üåë', name: 'new moon' }, { emoji: 'üåì', name: 'first quarter' },
                { emoji: 'üåï', name: 'full moon' }, { emoji: 'üåó', name: 'last quarter' }, { emoji: 'üåò', name: 'waning crescent' }
            ]
        },
        // ‚îÄ‚îÄ 16. FOOD / DRINK ‚îÄ‚îÄ
        {
            name: 'üçï Food / Drink',
            icons: [
                { emoji: 'üçï', name: 'pizza' }, { emoji: 'üçî', name: 'hamburger' }, { emoji: 'üçü', name: 'fries' },
                { emoji: 'üå≠', name: 'hot dog' }, { emoji: 'üçø', name: 'popcorn' }, { emoji: 'üßÇ', name: 'salt' },
                { emoji: 'ü•´', name: 'canned food' }, { emoji: 'üç±', name: 'bento' }, { emoji: 'üç£', name: 'sushi' },
                { emoji: 'üç™', name: 'cookie' }, { emoji: 'üéÇ', name: 'birthday cake' }, { emoji: 'üç∞', name: 'cake slice' },
                { emoji: 'üßÅ', name: 'cupcake' }, { emoji: 'üç©', name: 'doughnut' }, { emoji: 'üç´', name: 'chocolate' },
                { emoji: 'üç¨', name: 'candy' }, { emoji: 'üç≠', name: 'lollipop' }, { emoji: 'üçØ', name: 'honey pot' },
                { emoji: 'ü•§', name: 'cup straw' }, { emoji: '‚òï', name: 'coffee' }, { emoji: 'üçµ', name: 'tea' },
                { emoji: 'üßÉ', name: 'juice box' }, { emoji: 'ü´ñ', name: 'teapot' }, { emoji: 'üç∂', name: 'sake' },
                { emoji: 'üç∑', name: 'wine' }, { emoji: 'üç∫', name: 'beer' }, { emoji: 'üçª', name: 'cheers' },
                { emoji: 'ü•Ç', name: 'champagne' }, { emoji: 'üßä', name: 'ice' }, { emoji: 'ü•õ', name: 'milk' },
                { emoji: 'ü´ó', name: 'pouring' }, { emoji: 'ü•£', name: 'bowl spoon' }, { emoji: 'ü•°', name: 'takeout box' },
                { emoji: 'üçΩÔ∏è', name: 'plate cutlery' }, { emoji: 'ü•¢', name: 'chopsticks' }, { emoji: 'ü•Ñ', name: 'spoon' },
                { emoji: 'üî™', name: 'knife' }, { emoji: 'ü´ô', name: 'jar' }, { emoji: 'üß¥', name: 'lotion' }
            ]
        },
        // ‚îÄ‚îÄ 17. SPORTS / EQUIPMENT ‚îÄ‚îÄ
        {
            name: '‚öΩ Sports / Equipment',
            icons: [
                { emoji: '‚öΩ', name: 'soccer' }, { emoji: 'üèÄ', name: 'basketball' }, { emoji: 'üèà', name: 'football' },
                { emoji: '‚öæ', name: 'baseball' }, { emoji: 'ü•é', name: 'softball' }, { emoji: 'üéæ', name: 'tennis' },
                { emoji: 'üèê', name: 'volleyball' }, { emoji: 'üèâ', name: 'rugby' }, { emoji: 'ü•è', name: 'frisbee' },
                { emoji: 'üé±', name: 'pool 8' }, { emoji: 'ü™Ä', name: 'yo-yo' }, { emoji: 'üèì', name: 'ping pong' },
                { emoji: 'üè∏', name: 'badminton' }, { emoji: 'üèí', name: 'hockey' }, { emoji: 'ü•Ö', name: 'goal net' },
                { emoji: '‚õ≥', name: 'golf flag' }, { emoji: 'ü™Å', name: 'kite' }, { emoji: 'üéØ', name: 'target' },
                { emoji: 'üé≥', name: 'bowling' }, { emoji: 'ü•ä', name: 'boxing glove' }, { emoji: 'ü•ã', name: 'martial arts' },
                { emoji: 'üèÜ', name: 'trophy' }, { emoji: 'üèÖ', name: 'medal' }, { emoji: 'ü•á', name: 'gold medal' },
                { emoji: 'ü•à', name: 'silver medal' }, { emoji: 'ü•â', name: 'bronze medal' }, { emoji: 'üéñÔ∏è', name: 'military medal' },
                { emoji: 'üéóÔ∏è', name: 'ribbon' }, { emoji: 'üéø', name: 'ski' }, { emoji: 'üõ∑', name: 'sled' },
                { emoji: 'ü•å', name: 'curling stone' }, { emoji: 'üé£', name: 'fishing' }, { emoji: 'üé≤', name: 'dice' },
                { emoji: '‚ôüÔ∏è', name: 'chess pawn' }, { emoji: 'üé≠', name: 'theater masks' }, { emoji: 'üé®', name: 'palette' },
                { emoji: 'üß©', name: 'puzzle piece' }, { emoji: 'ü™Ñ', name: 'magic wand' }, { emoji: 'üé™', name: 'circus' },
                { emoji: 'üé∞', name: 'slot machine' }
            ]
        },
        // ‚îÄ‚îÄ 18. CLOTHING / OBJECTS ‚îÄ‚îÄ
        {
            name: 'üëî Clothing / Objects',
            icons: [
                { emoji: 'üëî', name: 'necktie' }, { emoji: 'üëï', name: 'tshirt' }, { emoji: 'üëñ', name: 'jeans' },
                { emoji: 'üß£', name: 'scarf' }, { emoji: 'üß§', name: 'gloves' }, { emoji: 'üß•', name: 'coat' },
                { emoji: 'üß¶', name: 'socks' }, { emoji: 'üëó', name: 'dress' }, { emoji: 'üëò', name: 'kimono' },
                { emoji: 'ü•ª', name: 'sari' }, { emoji: 'üëí', name: 'hat ribbon' }, { emoji: 'üé©', name: 'top hat' },
                { emoji: 'üß¢', name: 'cap' }, { emoji: '‚õëÔ∏è', name: 'rescue helmet' }, { emoji: 'ü™ñ', name: 'military helmet' },
                { emoji: 'üëë', name: 'crown' }, { emoji: 'üíç', name: 'ring' }, { emoji: 'üëú', name: 'handbag' },
                { emoji: 'üëù', name: 'clutch bag' }, { emoji: 'üéí', name: 'backpack' }, { emoji: 'üß≥', name: 'luggage' },
                { emoji: 'üëì', name: 'glasses' }, { emoji: 'üï∂Ô∏è', name: 'sunglasses' }, { emoji: 'ü•Ω', name: 'goggles' },
                { emoji: 'üåÇ', name: 'umbrella' }, { emoji: '‚òÇÔ∏è', name: 'open umbrella' }
            ]
        },
        // ‚îÄ‚îÄ 19. MEDICAL / HEALTH ‚îÄ‚îÄ
        {
            name: 'üè• Medical / Health',
            icons: [
                { emoji: 'üè•', name: 'hospital' }, { emoji: 'üíä', name: 'pill' }, { emoji: 'üíâ', name: 'syringe' },
                { emoji: 'ü©∫', name: 'stethoscope' }, { emoji: 'ü©π', name: 'bandage' }, { emoji: 'ü©º', name: 'crutch' },
                { emoji: 'ü©ª', name: 'x-ray' }, { emoji: 'ü©∏', name: 'blood drop' }, { emoji: 'üß¨', name: 'DNA' },
                { emoji: 'üî¨', name: 'microscope' }, { emoji: 'üß´', name: 'petri dish' }, { emoji: 'üß™', name: 'test tube' },
                { emoji: 'üå°Ô∏è', name: 'thermometer' }, { emoji: 'ü´Ä', name: 'heart organ' }, { emoji: 'ü´Å', name: 'lungs' },
                { emoji: 'üß†', name: 'brain' }, { emoji: '‚ôø', name: 'wheelchair' }, { emoji: 'üöë', name: 'ambulance' },
                { emoji: '‚öïÔ∏è', name: 'medical' }, { emoji: 'üßØ', name: 'fire extinguisher' }
            ]
        },
        // ‚îÄ‚îÄ 20. SYMBOLS / ARROWS ‚îÄ‚îÄ
        {
            name: 'üî£ Symbols / Arrows',
            icons: [
                { emoji: '‚¨ÜÔ∏è', name: 'up' }, { emoji: '‚¨áÔ∏è', name: 'down' }, { emoji: '‚¨ÖÔ∏è', name: 'left' },
                { emoji: '‚û°Ô∏è', name: 'right' }, { emoji: '‚ÜóÔ∏è', name: 'up-right' }, { emoji: '‚ÜòÔ∏è', name: 'down-right' },
                { emoji: '‚ÜôÔ∏è', name: 'down-left' }, { emoji: '‚ÜñÔ∏è', name: 'up-left' }, { emoji: '‚ÜïÔ∏è', name: 'up-down' },
                { emoji: '‚ÜîÔ∏è', name: 'left-right' }, { emoji: 'üîÑ', name: 'counterclockwise' }, { emoji: 'üîÉ', name: 'clockwise' },
                { emoji: '‚Ü©Ô∏è', name: 'return left' }, { emoji: '‚Ü™Ô∏è', name: 'return right' }, { emoji: '‚§¥Ô∏è', name: 'curve up' },
                { emoji: '‚§µÔ∏è', name: 'curve down' }, { emoji: 'üîÄ', name: 'shuffle' }, { emoji: 'üîÅ', name: 'repeat' },
                { emoji: 'üîÇ', name: 'repeat one' }, { emoji: '‚ñ∂Ô∏è', name: 'play' }, { emoji: '‚è©', name: 'fast forward' },
                { emoji: '‚è≠Ô∏è', name: 'next track' }, { emoji: '‚èØÔ∏è', name: 'play/pause' }, { emoji: '‚óÄÔ∏è', name: 'reverse' },
                { emoji: '‚è™', name: 'rewind' }, { emoji: '‚èÆÔ∏è', name: 'prev track' }, { emoji: '‚èπÔ∏è', name: 'stop' },
                { emoji: '‚è∫Ô∏è', name: 'record' }, { emoji: '‚èèÔ∏è', name: 'eject' }, { emoji: 'üîº', name: 'up small' },
                { emoji: 'üîΩ', name: 'down small' }
            ]
        },
        // ‚îÄ‚îÄ 21. SHAPES / COLORS ‚îÄ‚îÄ
        {
            name: 'üî∑ Shapes / Colors',
            icons: [
                { emoji: 'üî¥', name: 'red circle' }, { emoji: 'üü†', name: 'orange circle' }, { emoji: 'üü°', name: 'yellow circle' },
                { emoji: 'üü¢', name: 'green circle' }, { emoji: 'üîµ', name: 'blue circle' }, { emoji: 'üü£', name: 'purple circle' },
                { emoji: 'üü§', name: 'brown circle' }, { emoji: '‚ö´', name: 'black circle' }, { emoji: '‚ö™', name: 'white circle' },
                { emoji: 'üîò', name: 'radio button' }, { emoji: '‚≠ï', name: 'hollow circle' }, { emoji: 'üü•', name: 'red square' },
                { emoji: 'üüß', name: 'orange square' }, { emoji: 'üü®', name: 'yellow square' }, { emoji: 'üü©', name: 'green square' },
                { emoji: 'üü¶', name: 'blue square' }, { emoji: 'üü™', name: 'purple square' }, { emoji: 'üü´', name: 'brown square' },
                { emoji: '‚¨õ', name: 'black square' }, { emoji: '‚¨ú', name: 'white square' }, { emoji: '‚óºÔ∏è', name: 'mid black sq' },
                { emoji: '‚óªÔ∏è', name: 'mid white sq' }, { emoji: '‚óæ', name: 'sm black sq' }, { emoji: '‚óΩ', name: 'sm white sq' },
                { emoji: '‚ñ™Ô∏è', name: 'tiny black sq' }, { emoji: '‚ñ´Ô∏è', name: 'tiny white sq' }, { emoji: 'üî≤', name: 'black sq btn' },
                { emoji: 'üî≥', name: 'white sq btn' }, { emoji: 'üî∂', name: 'orange diamond' }, { emoji: 'üî∑', name: 'blue diamond' },
                { emoji: 'üî∏', name: 'sm orange diamond' }, { emoji: 'üîπ', name: 'sm blue diamond' }, { emoji: 'üî∫', name: 'red tri up' },
                { emoji: 'üîª', name: 'red tri down' }, { emoji: 'üí†', name: 'diamond dot' },
                { emoji: '‚ù§Ô∏è', name: 'red heart' }, { emoji: 'üß°', name: 'orange heart' }, { emoji: 'üíõ', name: 'yellow heart' },
                { emoji: 'üíö', name: 'green heart' }, { emoji: 'üíô', name: 'blue heart' }, { emoji: 'üíú', name: 'purple heart' },
                { emoji: 'üñ§', name: 'black heart' }, { emoji: 'ü§ç', name: 'white heart' }, { emoji: 'ü§é', name: 'brown heart' },
                { emoji: 'üíî', name: 'broken heart' }, { emoji: '‚ù£Ô∏è', name: 'heart exclaim' }, { emoji: 'üíï', name: 'two hearts' },
                { emoji: 'üíñ', name: 'sparkling heart' }, { emoji: 'üíó', name: 'growing heart' }, { emoji: 'üíò', name: 'arrow heart' }
            ]
        },
        // ‚îÄ‚îÄ 22. SIGNS / WARNINGS / STATUS ‚îÄ‚îÄ
        {
            name: '‚ö†Ô∏è Signs / Warnings / Status',
            icons: [
                { emoji: '‚ö†Ô∏è', name: 'warning' }, { emoji: 'üö®', name: 'alarm' }, { emoji: 'üö´', name: 'prohibited' },
                { emoji: '‚õî', name: 'no entry' }, { emoji: 'üõë', name: 'stop sign' }, { emoji: '‚ùå', name: 'cross' },
                { emoji: '‚≠ï', name: 'hollow circle' }, { emoji: '‚ùó', name: 'exclamation' }, { emoji: '‚ùì', name: 'question' },
                { emoji: '‚ùï', name: 'white exclam' }, { emoji: '‚ùî', name: 'white quest' }, { emoji: '‚ÄºÔ∏è', name: 'double exclam' },
                { emoji: '‚ÅâÔ∏è', name: 'exclam quest' }, { emoji: '‚úÖ', name: 'check' }, { emoji: '‚òëÔ∏è', name: 'check box' },
                { emoji: '‚úîÔ∏è', name: 'check mark' }, { emoji: '‚úñÔ∏è', name: 'multiply' }, { emoji: '‚ûï', name: 'plus' },
                { emoji: '‚ûñ', name: 'minus' }, { emoji: '‚ûó', name: 'divide' }, { emoji: 'üí≤', name: 'dollar sign' },
                { emoji: '‚ôªÔ∏è', name: 'recycle' }, { emoji: '‚öúÔ∏è', name: 'fleur-de-lis' }, { emoji: 'üî±', name: 'trident' },
                { emoji: 'üìõ', name: 'name badge' }, { emoji: 'üî∞', name: 'beginner' }, { emoji: '‚öïÔ∏è', name: 'medical' },
                { emoji: '‚òÆÔ∏è', name: 'peace' }, { emoji: '‚òØÔ∏è', name: 'yin yang' }, { emoji: '‚ôæÔ∏è', name: 'infinity' },
                { emoji: 'üÜó', name: 'OK' }, { emoji: 'üÜï', name: 'NEW' }, { emoji: 'üÜô', name: 'UP!' },
                { emoji: 'üÜí', name: 'COOL' }, { emoji: 'üÜì', name: 'FREE' }, { emoji: 'üÜò', name: 'SOS' },
                { emoji: 'üÖ∞Ô∏è', name: 'A' }, { emoji: 'üÖ±Ô∏è', name: 'B' }, { emoji: 'üÜé', name: 'AB' },
                { emoji: 'üÖæÔ∏è', name: 'O' }, { emoji: 'üîü', name: 'keycap 10' }, { emoji: '#Ô∏è‚É£', name: 'keycap #' },
                { emoji: '*Ô∏è‚É£', name: 'keycap *' }, { emoji: '0Ô∏è‚É£', name: 'keycap 0' }, { emoji: '1Ô∏è‚É£', name: 'keycap 1' },
                { emoji: '2Ô∏è‚É£', name: 'keycap 2' }, { emoji: '3Ô∏è‚É£', name: 'keycap 3' }, { emoji: '4Ô∏è‚É£', name: 'keycap 4' },
                { emoji: '5Ô∏è‚É£', name: 'keycap 5' }, { emoji: '6Ô∏è‚É£', name: 'keycap 6' }, { emoji: '7Ô∏è‚É£', name: 'keycap 7' },
                { emoji: '8Ô∏è‚É£', name: 'keycap 8' }, { emoji: '9Ô∏è‚É£', name: 'keycap 9' }, { emoji: '‚ÑπÔ∏è', name: 'info' },
                { emoji: 'üî†', name: 'ABCD' }, { emoji: 'üî°', name: 'abcd' }, { emoji: 'üî¢', name: '1234' },
                { emoji: 'üî£', name: 'symbols' }, { emoji: 'üî§', name: 'abc' }, { emoji: 'üÖøÔ∏è', name: 'parking' },
                { emoji: '¬©Ô∏è', name: 'copyright' }, { emoji: '¬ÆÔ∏è', name: 'registered' }, { emoji: '‚Ñ¢Ô∏è', name: 'trademark' },
                { emoji: '„Ä∞Ô∏è', name: 'wavy dash' }, { emoji: '‚û∞', name: 'curly loop' }, { emoji: '‚ûø', name: 'double loop' },
                { emoji: '„ÄΩÔ∏è', name: 'part alternation' }, { emoji: '‚ú≥Ô∏è', name: '8-spoke' }, { emoji: '‚ú¥Ô∏è', name: '8-point star' },
                { emoji: '‚ùáÔ∏è', name: 'sparkle' }, { emoji: 'üîÜ', name: 'bright' }, { emoji: 'üîÖ', name: 'dim' }
            ]
        },
        // ‚îÄ‚îÄ 23. TRANSPORT / INFRASTRUCTURE ‚îÄ‚îÄ
        {
            name: 'üöÄ Transport / Infrastructure',
            icons: [
                { emoji: 'üöÄ', name: 'rocket' }, { emoji: 'üõ∏', name: 'UFO' }, { emoji: '‚úàÔ∏è', name: 'airplane' },
                { emoji: 'üõ©Ô∏è', name: 'small plane' }, { emoji: 'üõ´', name: 'departure' }, { emoji: 'üõ¨', name: 'arrival' },
                { emoji: 'üöÅ', name: 'helicopter' }, { emoji: 'üöÇ', name: 'locomotive' }, { emoji: 'üöÉ', name: 'railway car' },
                { emoji: 'üöÑ', name: 'bullet train' }, { emoji: 'üöÖ', name: 'train front' }, { emoji: 'üöÜ', name: 'train' },
                { emoji: 'üöá', name: 'metro' }, { emoji: 'üöà', name: 'light rail' }, { emoji: 'üöâ', name: 'station' },
                { emoji: 'üõ§Ô∏è', name: 'railway track' }, { emoji: '‚õΩ', name: 'fuel pump' }, { emoji: 'üöè', name: 'bus stop' },
                { emoji: 'üõ£Ô∏è', name: 'motorway' }, { emoji: 'üõπ', name: 'skateboard' }, { emoji: 'üõ¥', name: 'kick scooter' },
                { emoji: 'üö≤', name: 'bicycle' }, { emoji: '‚õµ', name: 'sailboat' }, { emoji: 'üö¢', name: 'ship' },
                { emoji: '‚öì', name: 'anchor' }, { emoji: 'ü™ù', name: 'hook' }, { emoji: 'üõû', name: 'wheel' },
                { emoji: 'üõü', name: 'ring buoy' }, { emoji: 'üß≠', name: 'compass' }
            ]
        },
        // ‚îÄ‚îÄ 24. PACKAGING / CONTAINERS ‚îÄ‚îÄ
        {
            name: 'üì¶ Packaging / Containers',
            icons: [
                { emoji: 'üì¶', name: 'package' }, { emoji: 'üóÉÔ∏è', name: 'card box' }, { emoji: 'üì•', name: 'inbox tray' },
                { emoji: 'üì§', name: 'outbox tray' }, { emoji: 'üóëÔ∏è', name: 'wastebasket' }, { emoji: 'üß∞', name: 'toolbox' },
                { emoji: 'üß≥', name: 'luggage' }, { emoji: 'üõí', name: 'cart' }, { emoji: 'ü™£', name: 'bucket' },
                { emoji: 'üß∫', name: 'basket' }, { emoji: 'üè∫', name: 'amphora' }, { emoji: '‚ö±Ô∏è', name: 'urn' },
                { emoji: 'ü™§', name: 'mouse trap' }, { emoji: 'üìÆ', name: 'postbox' }, { emoji: 'üó≥Ô∏è', name: 'ballot box' },
                { emoji: 'üóÑÔ∏è', name: 'file cabinet' }, { emoji: 'üóÇÔ∏è', name: 'card dividers' }, { emoji: 'üìÅ', name: 'folder' },
                { emoji: 'ü´ô', name: 'jar' }, { emoji: 'ü™∫', name: 'nest eggs' }, { emoji: 'üßä', name: 'ice cube' },
                { emoji: 'üéÅ', name: 'gift' }
            ]
        },
        // ‚îÄ‚îÄ 25. ZODIAC / MISC SYMBOLS ‚îÄ‚îÄ
        {
            name: '‚ôæÔ∏è Zodiac / Misc Symbols',
            icons: [
                { emoji: '‚ôà', name: 'Aries' }, { emoji: '‚ôâ', name: 'Taurus' }, { emoji: '‚ôä', name: 'Gemini' },
                { emoji: '‚ôã', name: 'Cancer' }, { emoji: '‚ôå', name: 'Leo' }, { emoji: '‚ôç', name: 'Virgo' },
                { emoji: '‚ôé', name: 'Libra' }, { emoji: '‚ôè', name: 'Scorpio' }, { emoji: '‚ôê', name: 'Sagittarius' },
                { emoji: '‚ôë', name: 'Capricorn' }, { emoji: '‚ôí', name: 'Aquarius' }, { emoji: '‚ôì', name: 'Pisces' },
                { emoji: '‚õé', name: 'Ophiuchus' }, { emoji: '‚ò™Ô∏è', name: 'star crescent' }, { emoji: '‚ú°Ô∏è', name: 'star David' },
                { emoji: '‚ò∏Ô∏è', name: 'dharma wheel' }, { emoji: 'üïâÔ∏è', name: 'om' }, { emoji: '‚úùÔ∏è', name: 'cross' },
                { emoji: '‚ò¶Ô∏è', name: 'orthodox cross' }, { emoji: '‚òÆÔ∏è', name: 'peace' }, { emoji: 'üïé', name: 'menorah' },
                { emoji: 'üîØ', name: 'six-point star' }, { emoji: '‚òØÔ∏è', name: 'yin yang' }, { emoji: '‚ôæÔ∏è', name: 'infinity' },
                { emoji: '‚öõÔ∏è', name: 'atom' }, { emoji: 'üè¥‚Äç‚ò†Ô∏è', name: 'pirate flag' }, { emoji: '‚ò†Ô∏è', name: 'skull bones' },
                { emoji: '‚öîÔ∏è', name: 'crossed swords' }, { emoji: 'üó°Ô∏è', name: 'dagger' }, { emoji: 'ü™¨', name: 'hamsa' },
                { emoji: 'üßø', name: 'evil eye' }, { emoji: '‚ô†Ô∏è', name: 'spade' }, { emoji: '‚ô•Ô∏è', name: 'heart suit' },
                { emoji: '‚ô¶Ô∏è', name: 'diamond suit' }, { emoji: '‚ô£Ô∏è', name: 'club suit' }, { emoji: 'üÄÑ', name: 'mahjong' },
                { emoji: 'üÉè', name: 'joker' }
            ]
        },
        // ‚îÄ‚îÄ 26. CELEBRATION / EVENTS ‚îÄ‚îÄ
        {
            name: 'üéâ Celebration / Events',
            icons: [
                { emoji: 'üéâ', name: 'party popper' }, { emoji: 'üéä', name: 'confetti' }, { emoji: 'üéã', name: 'tanabata' },
                { emoji: 'üéç', name: 'bamboo decor' }, { emoji: 'üéé', name: 'JP dolls' }, { emoji: 'üéè', name: 'carp streamer' },
                { emoji: 'üéê', name: 'wind chime' }, { emoji: 'üéë', name: 'moon ceremony' }, { emoji: 'üéÉ', name: 'jack-o-lantern' },
                { emoji: 'üéÑ', name: 'christmas tree' }, { emoji: 'üéÜ', name: 'fireworks' },
                { emoji: 'üéá', name: 'sparkler' }, { emoji: '‚ú®', name: 'sparkles' }, { emoji: 'üéà', name: 'balloon' },
                { emoji: 'üéÄ', name: 'ribbon' }, { emoji: 'üéÅ', name: 'gift' }, { emoji: 'ü™Ö', name: 'pi√±ata' },
                { emoji: 'ü™©', name: 'disco ball' }, { emoji: 'üéóÔ∏è', name: 'reminder ribbon' }, { emoji: 'üé´', name: 'ticket' },
                { emoji: 'üéüÔ∏è', name: 'admission' }, { emoji: 'üé§', name: 'microphone' }, { emoji: 'üéß', name: 'headphone' },
                { emoji: 'üìª', name: 'radio' }, { emoji: 'üé¨', name: 'clapperboard' }, { emoji: 'üé≠', name: 'masks' },
                { emoji: 'üé®', name: 'art palette' }, { emoji: 'üñºÔ∏è', name: 'framed picture' }, { emoji: 'üßß', name: 'red envelope' }
            ]
        }
    ];

    var built = false;

    window.openIconPicker = function() {
        var overlay = document.getElementById('iconPickerOverlay');
        overlay.classList.remove('hidden');
        overlay.classList.add('flex');
        if (!built) { buildIconPicker(); built = true; }
        setTimeout(function() { document.getElementById('iconPickerSearch').focus(); }, 100);
    };

    window.closeIconPicker = function() {
        var overlay = document.getElementById('iconPickerOverlay');
        overlay.classList.add('hidden');
        overlay.classList.remove('flex');
        document.getElementById('iconPickerSearch').value = '';
        filterPickerIcons();
    };

    window.filterPickerIcons = function() {
        var q = document.getElementById('iconPickerSearch').value.toLowerCase().trim();
        document.querySelectorAll('#pickerCategorySections .ip-card').forEach(function(c) {
            var name = c.getAttribute('data-name') || '';
            c.style.display = (!q || name.includes(q)) ? '' : 'none';
        });
    };

    function buildIconPicker() {
        // Current types
        var cGrid = document.getElementById('pickerCurrentGrid');
        currentTypes.forEach(function(t) {
            var div = document.createElement('div');
            div.className = 'flex items-center gap-2 px-3 py-2 bg-slate-900 rounded-lg cursor-pointer hover:bg-slate-700 transition-colors text-xs';
            div.innerHTML = '<span class="text-2xl">' + t.emoji + '</span><span class="text-violet-400 font-mono font-bold">' + t.code + '</span><span class="text-slate-400 truncate">' + t.type + '</span>';
            div.onclick = function() { copyPickerEmoji(t.emoji, div); };
            cGrid.appendChild(div);
        });

        // Categories
        var sectionsDiv = document.getElementById('pickerCategorySections');
        categories.forEach(function(cat) {
            var section = document.createElement('div');
            section.className = 'space-y-3';

            var h3 = document.createElement('h3');
            h3.className = 'text-amber-400 font-semibold text-sm border-b border-slate-700 pb-2';
            h3.textContent = cat.name;
            section.appendChild(h3);

            var grid = document.createElement('div');
            grid.className = 'grid grid-cols-4 sm:grid-cols-6 md:grid-cols-8 lg:grid-cols-10 gap-2';

            cat.icons.forEach(function(icon) {
                var card = document.createElement('div');
                card.className = 'ip-card flex flex-col items-center justify-center p-3 bg-slate-800 rounded-lg cursor-pointer border-2 border-transparent hover:border-sky-500 hover:bg-slate-700 transition-all text-center select-none relative';
                card.setAttribute('data-name', icon.name.toLowerCase());
                card.innerHTML = '<span class="text-2xl mb-1">' + icon.emoji + '</span><span class="text-[10px] text-slate-400 leading-tight">' + icon.name + '</span>';
                card.onclick = function() { copyPickerEmoji(icon.emoji, card); };
                grid.appendChild(card);
            });

            section.appendChild(grid);
            sectionsDiv.appendChild(section);
        });
    }

    function copyPickerEmoji(emoji, element) {
        navigator.clipboard.writeText(emoji).then(function() {
            element.classList.add('ring-2', 'ring-emerald-400', 'bg-emerald-900/40');
            setTimeout(function() { element.classList.remove('ring-2', 'ring-emerald-400', 'bg-emerald-900/40'); }, 1200);
            var toast = document.getElementById('pickerToast');
            toast.textContent = '‚úì Copied: ' + emoji;
            toast.classList.remove('hidden');
            setTimeout(function() { toast.classList.add('hidden'); }, 1800);
        });
    }

    // ESC to close
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && !document.getElementById('iconPickerOverlay').classList.contains('hidden')) {
            closeIconPicker();
        }
    });
})();
</script>

</body>
</html>
